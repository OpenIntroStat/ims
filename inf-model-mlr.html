<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Mine Çetinkaya-Rundel and Johanna Hardin">
<title>25&nbsp; Inference for linear regression with multiple predictors – Introduction to Modern Statistics (2e)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./inf-model-logistic.html" rel="next">
<link href="./inf-model-slr.html" rel="prev">
<link href="./images/openintro.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-8a1e4e1f50195b9aeca4c6bdbbd0ae67.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-1c2ce5d4ac9f5b6ea71624de97bf760e.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-8a1e4e1f50195b9aeca4c6bdbbd0ae67.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-41ebc7e69ef0285b0c3541b9cc726a5c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-790f3f5e7e2e01ab58e527b05f631cee.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-41ebc7e69ef0285b0c3541b9cc726a5c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="site_libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="site_libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./inferential-modeling.html">Inferential modeling</a></li><li class="breadcrumb-item"><a href="./inf-model-mlr.html"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Inference for linear regression with multiple predictors</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Modern Statistics (2e)</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/openintrostat/ims/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome to IMS2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./authors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Authors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./introduction-to-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-hello.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Hello data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Study design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Applications: Data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./exploratory-data-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory data analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./explore-categorical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Exploring categorical data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./explore-numerical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Exploring numerical data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./explore-applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Applications: Explore</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./regression-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-slr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Linear regression with a single predictor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-mlr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Linear regression with multiple predictors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Logistic regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Applications: Model</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./foundations-of-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Foundations of inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations-randomization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Hypothesis testing with randomization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations-bootstrapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Confidence intervals with bootstrapping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations-mathematical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Inference with mathematical models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations-errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Decision Errors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations-applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Applications: Foundations</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./statistical-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-one-prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Inference for a single proportion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-two-props.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Inference for comparing two proportions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Inference for two-way tables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-one-mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Inference for a single mean</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-two-means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Inference for comparing two independent means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-paired-means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Inference for comparing paired means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-many-means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Inference for comparing many means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Applications: Infer</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./inferential-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inferential modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inf-model-slr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Inference for linear regression with a single predictor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inf-model-mlr.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Inference for linear regression with multiple predictors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inf-model-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Inference for logistic regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inf-model-applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Applications: Model and infer</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Exercise solutions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#sec-inf-mult-reg-soft" id="toc-sec-inf-mult-reg-soft" class="nav-link active" data-scroll-target="#sec-inf-mult-reg-soft"><span class="header-section-number">25.1</span> Multiple regression output from software</a></li>
  <li><a href="#sec-inf-mult-reg-collin" id="toc-sec-inf-mult-reg-collin" class="nav-link" data-scroll-target="#sec-inf-mult-reg-collin"><span class="header-section-number">25.2</span> Multicollinearity</a></li>
  <li>
<a href="#sec-inf-mult-reg-cv" id="toc-sec-inf-mult-reg-cv" class="nav-link" data-scroll-target="#sec-inf-mult-reg-cv"><span class="header-section-number">25.3</span> Cross-validation for prediction error</a>
  <ul class="collapse">
<li><a href="#comparing-two-models-to-predict-body-mass-in-penguins" id="toc-comparing-two-models-to-predict-body-mass-in-penguins" class="nav-link" data-scroll-target="#comparing-two-models-to-predict-body-mass-in-penguins"><span class="header-section-number">25.3.1</span> Comparing two models to predict body mass in penguins</a></li>
  </ul>
</li>
  <li>
<a href="#sec-chp25-review" id="toc-sec-chp25-review" class="nav-link" data-scroll-target="#sec-chp25-review"><span class="header-section-number">25.4</span> Chapter review</a>
  <ul class="collapse">
<li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">25.4.1</span> Summary</a></li>
  <li><a href="#terms" id="toc-terms" class="nav-link" data-scroll-target="#terms"><span class="header-section-number">25.4.2</span> Terms</a></li>
  </ul>
</li>
  <li><a href="#sec-chp25-exercises" id="toc-sec-chp25-exercises" class="nav-link" data-scroll-target="#sec-chp25-exercises"><span class="header-section-number">25.5</span> Exercises</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/openintrostat/ims/edit/main/inf-model-mlr.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/openintrostat/ims/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./inferential-modeling.html">Inferential modeling</a></li><li class="breadcrumb-item"><a href="./inf-model-mlr.html"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Inference for linear regression with multiple predictors</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-inf-model-mlr" class="quarto-section-identifier"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Inference for linear regression with multiple predictors</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="chapterintro">
<p>In <a href="model-mlr.html" class="quarto-xref">Chapter&nbsp;<span>8</span></a>, the least squares regression method was used to estimate linear models which predicted a particular response variable given more than one explanatory variable. Here, we discuss whether each of the variables individually is a statistically discernible predictor of the outcome or whether the model might be just as strong without that variable. That is, as before, we apply inferential methods to ask whether a variable could have come from a population where the particular coefficient at hand was zero. If one of the linear model coefficients is truly zero (in the population), then the estimate of the coefficient (using least squares) will vary around zero. The inference task at hand is to decide whether the coefficient’s difference from zero is large enough to decide that the data cannot possibly have come from a model where the true population coefficient is zero. Both the derivations from the mathematical model and the randomization model are beyond the scope of this book, but we are able to calculate p-values using statistical software. We will discuss interpreting p-values in the multiple regression setting and note some scenarios where careful understanding of the context and the relationship between variables is important. We use cross-validation as a method for independent assessment of the multiple linear regression model.</p>
</div>
<section id="sec-inf-mult-reg-soft" class="level2" data-number="25.1"><h2 data-number="25.1" class="anchored" data-anchor-id="sec-inf-mult-reg-soft">
<span class="header-section-number">25.1</span> Multiple regression output from software</h2>
<p>Recall the <code>loans</code> data from <a href="model-mlr.html" class="quarto-xref">Chapter&nbsp;<span>8</span></a>.</p>
<div class="data">
<p>The <a href="http://openintrostat.github.io/openintro/reference/loans_full_schema.html"><code>loans_full_schema</code></a> data can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package. Based on the data in this dataset we have created two new variables: <code>credit_util</code> which is calculated as the total credit utilized divided by the total credit limit and <code>bankruptcy</code> which turns the number of bankruptcies to an indicator variable (0 for no bankruptcies and 1 for at least 1 bankruptcies). We will refer to this modified dataset as <code>loans</code>.</p>
</div>
<p>Now, our goal is to create a model where <code>interest_rate</code> can be predicted using the variables <code>debt_to_income</code>, <code>term</code>, and <code>credit_checks</code>. As you learned in <a href="model-mlr.html" class="quarto-xref"><span>Chapter 8</span></a>, least squares can be used to find the coefficient estimates for the linear model. The unknown population model can be written as:</p>
<p><span class="math display">\[
\begin{aligned}
E[\texttt{interest\_rate}] = \beta_0 &amp;+ \beta_1\times \texttt{debt\_to\_income} \\
&amp;+ \beta_2 \times \texttt{term}\\
&amp;+ \beta_3 \times \texttt{credit\_checks}\\
\end{aligned}
\]</span></p>
<div class="cell" data-tbl-pos="H">
<div id="tbl-loansmodel" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-pos="H">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-loansmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;25.1: Summary of a linear model for predicting interest rate based on <code>debt_to_income</code>, <code>term</code>, and <code>credit_checks</code>. Each of the variables has its own coefficient estimate as well as a p-value.
</figcaption><div aria-describedby="tbl-loansmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-condensed do-not-create-environment cell caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">4.31</td>
<td style="text-align: right; width: 5em;">0.20</td>
<td style="text-align: right; width: 5em;">22.1</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">debt_to_income</td>
<td style="text-align: right; width: 5em;">0.04</td>
<td style="text-align: right; width: 5em;">0.00</td>
<td style="text-align: right; width: 5em;">13.3</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">term</td>
<td style="text-align: right; width: 5em;">0.16</td>
<td style="text-align: right; width: 5em;">0.00</td>
<td style="text-align: right; width: 5em;">37.9</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">credit_checks</td>
<td style="text-align: right; width: 5em;">0.25</td>
<td style="text-align: right; width: 5em;">0.02</td>
<td style="text-align: right; width: 5em;">12.8</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The estimated equation for the regression model may be written as a model with three predictor variables:</p>
<p><span class="math display">\[
\widehat{\texttt{interest\_rate}} = 4.31 + 0.041 \times \texttt{debt\_to\_income} + 0.16 \times \texttt{term} + 0.25 \times \texttt{credit\_checks}
\]</span></p>
<p>Not only does <a href="#tbl-loansmodel" class="quarto-xref">Table&nbsp;<span>25.1</span></a> provide the estimates for the coefficients, it also provides information on the inference analysis (i.e., hypothesis testing) which is the focus of this chapter.</p>
<p>In <a href="inf-model-slr.html" class="quarto-xref"><span>Chapter 24</span></a>, you learned that the hypothesis test for a linear model with <strong>one predictor</strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> can be written as: </p>
<blockquote class="blockquote">
<p>if only one predictor, <span class="math inline">\(H_0: \beta_1 = 0.\)</span></p>
</blockquote>
<p>That is, if the true population slope is zero, the p-value measures how likely it would be to select data which produced the observed slope (<span class="math inline">\(b_1\)</span>) value.</p>
<p>With <strong>multiple predictors</strong>, the hypothesis is similar, however, it is now conditioned on each of the other variables remaining in the model.</p>
<blockquote class="blockquote">
<p>if multiple predictors, <span class="math inline">\(H_0: \beta_i = 0\)</span> given other variables in the model</p>
</blockquote>
<p>Using the example above and focusing on each of the variable p-values (here we won’t discuss the p-value associated with the intercept), we can write out the three different hypotheses:</p>
<ul>
<li>
<span class="math inline">\(H_0: \beta_1 = 0\)</span>, given <code>term</code> and <code>credit_checks</code> are included in the model</li>
<li>
<span class="math inline">\(H_0: \beta_2 = 0\)</span>, given <code>debt_to_income</code> and <code>credit_checks</code> are included in the model</li>
<li>
<span class="math inline">\(H_0: \beta_3 = 0\)</span>, given <code>debt_to_income</code> and <code>term</code> are included in the model</li>
</ul>
<p>The very low p-values from the software output tell us that each of the variables acts as an important predictor in the model, despite the inclusion of the other two. Consider the p-value on <span class="math inline">\(H_0: \beta_1 = 0\)</span>. The low p-value says that it would be extremely unlikely to see data that produce a coefficient on <code>debt_to_income</code> as large as 0.041 if the true relationship between <code>debt_to_income</code>and <code>interest_rate</code> was non-existent (i.e., if <span class="math inline">\(\beta_1 = 0\)</span>) and the model also included <code>term</code> and <code>credit_checks</code>. You might have thought that the value 0.041 is a small number (i.e., close to zero), but in the units of the problem, 0.041 turns out to be far away from zero, it’s all about context! The p-values on <code>term</code> and on <code>credit_checks</code> are interpreted similarly.</p>
<p>Sometimes a set of predictor variables can impact the model in unusual ways, often due to the predictor variables themselves being correlated.</p>
</section><section id="sec-inf-mult-reg-collin" class="level2" data-number="25.2"><h2 data-number="25.2" class="anchored" data-anchor-id="sec-inf-mult-reg-collin">
<span class="header-section-number">25.2</span> Multicollinearity</h2>
<p>In practice, there will almost always be some degree of correlation between the explanatory variables in a multiple regression model. For regression models, it is important to understand the entire context of the model, particularly for correlated variables. Our discussion will focus on interpreting coefficients (and their signs) in relationship to other variables as well as the discernibility (i.e., the p-value) of each coefficient.</p>
<p>Consider an example where we would like to predict how much money is in a coin dish based only on the number of coins in the dish. We ask 26 students to tell us about their individual coin dishes, collecting data on the total dollar amount, the total number of coins, and the total number of low coins.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> The number of low coins is the number of coins minus the number of quarters (a quarter is the largest commonly used US coin, at US$0.25). <a href="#fig-money" class="quarto-xref">Figure&nbsp;<span>25.1</span></a> illustrates a sample of U.S. coins, their total worth (<code>total_amount</code>), the total <code>number_of_coins</code>, and the <code>number_of_low_coins</code>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-money" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Graphic of five pennies, three nickles, two dimes, and six quarters. A summary table indicates that there are 16 total coins, 10 of which are considered  low coins. The total amount of money is one dollar and ninety cents. ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-money-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/money.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;25.1: A sample of coins with 16 total coins, 10 low coins, and a net worth of $1.90."><img src="images/money.png" class="img-fluid figure-img" style="width:65.0%" alt="Graphic of five pennies, three nickles, two dimes, and six quarters. A summary table indicates that there are 16 total coins, 10 of which are considered  low coins. The total amount of money is one dollar and ninety cents. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-money-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;25.1: A sample of coins with 16 total coins, 10 low coins, and a net worth of $1.90.
</figcaption></figure>
</div>
</div>
</div>
<p>The collected data is given in <a href="#fig-coinfig" class="quarto-xref">Figure&nbsp;<span>25.2</span></a> and shows that the <code>total_amount</code> of money is more highly correlated with the total <code>number_of_coins</code> than it is with the <code>number_of_low_coins</code>. We also note that the total <code>number_of_coins</code> and the <code>number_of_low_coins</code> are positively correlated.</p>
<div id="fig-coinfig" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-coinfig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-coinfig" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-coinfig-1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Two scatterplots, both with total amount of money on the y-axis. The left plot has total number of coins on the x-axis. The right plot has number of low coins on the x-axis. Both plots show positive correlation, but the total number of coins plot is more strongly correlated than the number of low coins plot. ">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-coinfig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="inf-model-mlr_files/figure-html/fig-coinfig-1.png" class="lightbox" data-gallery="fig-coinfig" title="Figure&nbsp;25.2&nbsp;(a): Total number of coins on the x-axis."><img src="inf-model-mlr_files/figure-html/fig-coinfig-1.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-coinfig" alt="Two scatterplots, both with total amount of money on the y-axis. The left plot has total number of coins on the x-axis. The right plot has number of low coins on the x-axis. Both plots show positive correlation, but the total number of coins plot is more strongly correlated than the number of low coins plot. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-coinfig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Total number of coins on the x-axis.
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-coinfig" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-coinfig-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Two scatterplots, both with total amount of money on the y-axis. The left plot has total number of coins on the x-axis. The right plot has number of low coins on the x-axis. Both plots show positive correlation, but the total number of coins plot is more strongly correlated than the number of low coins plot. ">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-coinfig-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="inf-model-mlr_files/figure-html/fig-coinfig-2.png" class="lightbox" data-gallery="fig-coinfig" title="Figure&nbsp;25.2&nbsp;(b): Number of low coins on the x-axis."><img src="inf-model-mlr_files/figure-html/fig-coinfig-2.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-coinfig" alt="Two scatterplots, both with total amount of money on the y-axis. The left plot has total number of coins on the x-axis. The right plot has number of low coins on the x-axis. Both plots show positive correlation, but the total number of coins plot is more strongly correlated than the number of low coins plot. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-coinfig-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Number of low coins on the x-axis.
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-coinfig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;25.2: Two plots describing the total amount of money (USD) as a function of the total number of coins or low coins. As you might expect, the total amount of money is more highly postively correlated with the total number of coins than with the number of low coins.
</figcaption></figure>
</div>
<p>Using the total <code>number_of_coins</code> as the predictor variable, <a href="#tbl-coinhigh" class="quarto-xref">Table&nbsp;<span>25.2</span></a> provides the least squares estimate of the coefficient is 0.13. For every additional coin in the dish, we would predict that the student had US$0.13 more. The <span class="math inline">\(b_1 = 0.13\)</span> coefficient has a small p-value associated with it, suggesting we would not have seen data like this if <code>number_of_coins</code> and <code>total_amount</code> of money were not linearly related.</p>
<p><span class="math display">\[\widehat{\texttt{total\_amount}} = 0.55 + 0.13 \times \texttt{number\_of\_coins}\]</span></p>
<div class="cell" data-tbl-pos="H">
<div id="tbl-coinhigh" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-pos="H">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-coinhigh-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;25.2: Linear model output predicting the total amount of money based on the total number of coins.
</figcaption><div aria-describedby="tbl-coinhigh-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-condensed do-not-create-environment cell caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">0.55</td>
<td style="text-align: right; width: 5em;">0.44</td>
<td style="text-align: right; width: 5em;">1.23</td>
<td style="text-align: left; width: 5em;">0.2301</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">number_of_coins</td>
<td style="text-align: right; width: 5em;">0.13</td>
<td style="text-align: right; width: 5em;">0.02</td>
<td style="text-align: right; width: 5em;">5.54</td>
<td style="text-align: left; width: 5em;">&lt;0.0001</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Using <code>number_of_low_coins</code> as the predictor variable, <a href="#tbl-coinlow" class="quarto-xref">Table&nbsp;<span>25.3</span></a> provides the least squares estimate of the coefficient is 0.02. For every additional low coin in the dish, we would predict that the student had US$0.02 more. The <span class="math inline">\(b_1 = 0.02\)</span> coefficient has a large p-value associated with it, suggesting we could easily have seen data like ours even if the <code>number_of_low_coins</code> and <code>total_amount</code> of money are not at all linearly related.</p>
<p><span class="math display">\[\widehat{\texttt{total\_amount}} = 2.28 + 0.02 \times \texttt{number\_of\_low\_coins}\]</span> </p>
<div class="cell" data-tbl-pos="H">
<div id="tbl-coinlow" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-pos="H">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-coinlow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;25.3: Linear model output predicting the total amount of money based on the number of low coins.
</figcaption><div aria-describedby="tbl-coinlow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-condensed do-not-create-environment cell caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">2.28</td>
<td style="text-align: right; width: 5em;">0.58</td>
<td style="text-align: right; width: 5em;">3.9</td>
<td style="text-align: right; width: 5em;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">number_of_low_coins</td>
<td style="text-align: right; width: 5em;">0.02</td>
<td style="text-align: right; width: 5em;">0.05</td>
<td style="text-align: right; width: 5em;">0.4</td>
<td style="text-align: right; width: 5em;">0.7</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="workedexample">
<p>Come up with an example of two observations that have the same number of low coins but the number of total coins differs by one. What is the difference in total amount?</p>
<hr>
<p>Two samples of coins with the same number of low coins (3), but a different number of total coins (4 vs 5) and a different total amount ($0.41 vs $0.66).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/lowsame.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="images/lowsame.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:45.0%" alt="A set of four coins is shown: one of each penny, nickle, dime, and quarter. One quarter is then added to create a set of five coins -- one penny, one nickle, one dime, and two quarters. The two sets of coins have the same number of low coins but a different number of total coins. "></a></p>
</figure>
</div>
</div>
</div>
</div>
<div class="workedexample">
<p>Come up with an example of two observations that have the same total number of coins but a different number of low coins. What is the difference in total amount?</p>
<hr>
<p>Two samples of coins with the same total number of coins (4), but a different number of low coins (3 vs 4) and a different total amount ($0.41 vs $0.17).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/totalsame.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="images/totalsame.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:45.0%" alt="A set of four coins is shown: one of each penny, nickle, dime, and quarter. The quarter is then replaced with a penny to create a new set of four coins -- two pennies, one nickle, and one dime. The two sets of coins have the same number of total coins but a different number of low coins. "></a></p>
</figure>
</div>
</div>
</div>
</div>
<p>Using both the total <code>number_of_coins</code> and the <code>number_of_low_coins</code> as predictor variables, <a href="#tbl-coinhighlow" class="quarto-xref">Table&nbsp;<span>25.4</span></a> provides the least squares estimates of both coefficients as 0.21 and -0.16. Now, with two variables in the model, the interpretation is more nuanced.</p>
<ul>
<li>A coefficient interpretation always indicates a change in one variable while keeping the other variable(s) constant.<br>
For every additional coin in the dish <strong>while</strong> the <code>number_of_low_coins</code> stays constant, we would predict that the student had US$0.21 more. Re-considering the phrase “every additional coin in the dish <strong>while</strong> the number of low coins stays constant” makes us realize that each increase is a single additional quarter (larger samples sizes would have led to a <span class="math inline">\(b_1\)</span> coefficient closer to 0.25 because of the deterministic relationship described here).<br>
</li>
<li>For every additional low coin in the dish <strong>while</strong> the total <code>number_of_coins</code> stays constant, we would predict that the student had US$0.16 less. Re-considering the phrase “every additional low coin in the dish <strong>while</strong> the number of total coins stays constant” makes us realize that a quarter is being swapped out for a penny, nickel, or dime.</li>
</ul>
<p>Considering the coefficients across <a href="#tbl-coinhigh" class="quarto-xref">Table&nbsp;<span>25.2</span></a>, <a href="#tbl-coinlow" class="quarto-xref">Table&nbsp;<span>25.3</span></a>, and <a href="#tbl-coinhighlow" class="quarto-xref">Table&nbsp;<span>25.4</span></a> within the context and knowledge we have of US coins allows us to understand the correlation between variables and why the signs of the coefficients would change depending on the model. Note also, however, that the p-value for the <code>number_of_low_coins</code> coefficient changed from <a href="#tbl-coinlow" class="quarto-xref">Table&nbsp;<span>25.3</span></a> to <a href="#tbl-coinhighlow" class="quarto-xref">Table&nbsp;<span>25.4</span></a>. It makes sense that the variable describing the <code>number_of_low_coins</code> provides more information about the <code>total_amount</code> of money when it is part of a model which also includes the total <code>number_of_coins</code> than it does when it is used as a single variable in a simple linear regression model.</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\texttt{total\_amount}} = 0.80 &amp;+ 0.21 \times \texttt{number\_of\_coins} \\
&amp;- 0.16 \times \texttt{number\_of\_low\_coins}
\end{aligned}
\]</span></p>
<div class="cell" data-tbl-pos="H">
<div id="tbl-coinhighlow" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-pos="H">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-coinhighlow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;25.4: Linear model output predicting the total amount of money based on both the total number of coins and the number of low coins.
</figcaption><div aria-describedby="tbl-coinhighlow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-condensed do-not-create-environment cell caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">0.80</td>
<td style="text-align: right; width: 5em;">0.30</td>
<td style="text-align: right; width: 5em;">2.65</td>
<td style="text-align: right; width: 5em;">0.0142</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">number_of_coins</td>
<td style="text-align: right; width: 5em;">0.21</td>
<td style="text-align: right; width: 5em;">0.02</td>
<td style="text-align: right; width: 5em;">9.89</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">number_of_low_coins</td>
<td style="text-align: right; width: 5em;">-0.16</td>
<td style="text-align: right; width: 5em;">0.03</td>
<td style="text-align: right; width: 5em;">-5.51</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>When working with multiple regression models, interpreting the model coefficients is not always as straightforward as it was with the coin example. However, we encourage you to always think carefully about the variables in the model, consider how they might be correlated among themselves, and work through different models to see how using different sets of variables might produce different relationships for predicting the response variable of interest.</p>
<div class="important">
<p><strong>Multicollinearity.</strong></p>
<p>Multicollinearity happens when the predictor variables are correlated within themselves. When the predictor variables themselves are correlated, the coefficients in a multiple regression model can be difficult to interpret.</p>
</div>
<p>Although diving into the details are beyond the scope of this text, we will provide one more reflection about multicollinearity. If the predictor variables have some degree of correlation, it can be quite difficult to interpret the value of the coefficient or evaluate whether the variable is a statistically discernible predictor of the outcome. However, even a model that suffers from high multicollinearity will likely lead to unbiased predictions of the response variable. So if the task at hand is only to do prediction (and not to interpret coefficients), multicollinearity is likely to not cause you substantial problems.</p>
<!--
Things I didn't talk about but could:

* add R^2 and R^2_adj to the coin model
* For assessing model fit, as is necessary, we will create residual plots of residual vs. fitted (instead of residual vs. X as we saw previously). 
* Give another example here with a quadratic relationship and the wonky things that can happen with the p-values.
-->
</section><section id="sec-inf-mult-reg-cv" class="level2" data-number="25.3"><h2 data-number="25.3" class="anchored" data-anchor-id="sec-inf-mult-reg-cv">
<span class="header-section-number">25.3</span> Cross-validation for prediction error</h2>
<p>In <a href="#sec-inf-mult-reg-soft" class="quarto-xref"><span>Section 25.1</span></a>, p-values were calculated on each of the model coefficients. The p-value gives a sense of which variables are important to the model; however, a more extensive treatment of variable selection is warranted in a follow-up course or textbook. Here, we use <strong>cross-validation</strong> <strong>prediction error</strong> to focus on which variable(s) are important for predicting the response variable of interest. In general, linear models are also used to make predictions of individual observations. In addition to model building, cross-validation provides a method for generating predictions that are not overfit to the particular dataset at hand. We continue to encourage you to take up further study on the topic of cross-validation, as it is among the most important ideas in modern data analysis, and we are only able to scratch the surface here.</p>
<p>Cross-validation is a computational technique which removes some observations before a model is run, then assesses the model accuracy on the held-out sample. By removing some observations, we provide ourselves with an independent evaluation of the model (that is, the removed observations do not contribute to finding the parameters which minimize the least squares equation). Cross-validation can be used in many different ways (as an independent assessment), and here we will just scratch the surface with respect to one way the technique can be used to compare models. See <a href="#fig-cv" class="quarto-xref">Figure&nbsp;<span>25.3</span></a> for a visual representation of the cross-validation process.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-cv" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A square represents the original observed data which has been partitioned into four triangular segments. From the original partition, four different settings are considered. The first setting is such that the red, green, and yellow triangular representations of the data are used to build the model;  the blue triangular representation of the data is heldout and used for independent model prediction. The second setting is such that the blue,  green, and yellow triangular representations of the data are used to build  the model; the red triangular representation of the data is heldout and used for independent model prediction. The third setting is such that the red,  blue, and yellow triangular representations of the data are used to build  the model; the green triangular representation of the data is heldout and  used for independent model prediction. The fourth setting is such that the  red, green, and blue triangular representations of the data are used to  build the model; the yellow triangular representation of the data is  held out and used for independent model prediction. ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-cv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/CV.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;25.3: The dataset is broken into k folds (here k = 4). One at a time, a model is built using k-1 of the folds, and predictions are calculated on the single held out sample which will be completely independent of the model estimation."><img src="images/CV.png" class="img-fluid figure-img" style="width:90.0%" alt="A square represents the original observed data which has been partitioned into four triangular segments. From the original partition, four different settings are considered. The first setting is such that the red, green, and yellow triangular representations of the data are used to build the model;  the blue triangular representation of the data is heldout and used for independent model prediction. The second setting is such that the blue,  green, and yellow triangular representations of the data are used to build  the model; the red triangular representation of the data is heldout and used for independent model prediction. The third setting is such that the red,  blue, and yellow triangular representations of the data are used to build  the model; the green triangular representation of the data is heldout and  used for independent model prediction. The fourth setting is such that the  red, green, and blue triangular representations of the data are used to  build the model; the yellow triangular representation of the data is  held out and used for independent model prediction. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;25.3: The dataset is broken into k folds (here k = 4). One at a time, a model is built using k-1 of the folds, and predictions are calculated on the single held out sample which will be completely independent of the model estimation.
</figcaption></figure>
</div>
</div>
</div>
<div class="data">
<p>The <a href="https://allisonhorst.github.io/palmerpenguins/articles/intro.html"><code>penguins</code></a> data can be found in the <a href="https://github.com/allisonhorst/palmerpenguins"><strong>palmerpenguings</strong></a> R package.</p>
</div>
<p>Our goal in this section is to compare two different regression models which both seek to predict the mass of an individual penguin in grams. The observations of three different penguin species include measurements on body size and sex. The data were collected by <a href="https://www.uaf.edu/cfos/people/faculty/detail/kristen-gorman.php">Dr.&nbsp;Kristen Gorman</a> and the <a href="https://pal.lternet.edu/">Palmer Station, Antarctica LTER</a> as part of the <a href="https://lternet.edu/">Long Term Ecological Research Network</a>. <span class="citation" data-cites="Gorman:2014">(<a href="references.html#ref-Gorman:2014" role="doc-biblioref">Gorman, Williams, and Fraser 2014</a>)</span> Although not exactly aligned with this research project, you might be able to imagine a setting where the dimensions of the penguin are known (through, for example, aerial photographs) but the mass is not known. The first model predicts <code>body_mass_g</code> by using only the <code>bill_length_mm</code>, a variable denoting the length of a penguin’s bill, in mm. The second model predicts <code>body_mass_g</code> by using <code>bill_length_mm</code>, <code>bill_depth_mm</code>, <code>flipper_length_mm</code>, <code>sex</code>, and <code>species</code>.</p>
<div class="important">
<p><strong>Prediction error.</strong></p>
<p>The predicted error (also previously called the <strong>residual</strong>) is the difference between the observed value and the predicted value (from the regression model).</p>
<p><span class="math display">\[\text{prediction error}_i = e_i = y_i - \hat{y}_i\]</span></p>
</div>
<p>The presentation below (see the comparison of <a href="#fig-peng-mass1" class="quarto-xref">Figure&nbsp;<span>25.5</span></a> and <a href="#fig-peng-mass2" class="quarto-xref">Figure&nbsp;<span>25.7</span></a>) shows that the model with more variables predicts <code>body_mass_g</code> with much smaller errors (predicted minus actual body mass) than the model which uses only <code>bill_length_g</code>. We have deliberately used a model that intuitively makes sense (the more body measurements, the more predictable mass is). However, in many settings, it is not obvious which variables or which models contribute most to accurate predictions. Cross-validation is one way to get accurate independent predictions with which to compare different models.</p>
<section id="comparing-two-models-to-predict-body-mass-in-penguins" class="level3" data-number="25.3.1"><h3 data-number="25.3.1" class="anchored" data-anchor-id="comparing-two-models-to-predict-body-mass-in-penguins">
<span class="header-section-number">25.3.1</span> Comparing two models to predict body mass in penguins</h3>
<p>The question we will seek to answer is whether the predictions of <code>body_mass_g</code> are substantially better when <code>bill_length_mm</code>, <code>bill_depth_mm</code>, <code>flipper_length_mm</code>, <code>sex</code>, and <code>species</code> are used in the model, as compared with a model on <code>bill_length_mm</code> only.</p>
<p>We refer to the model given with only <code>bill_lengh_mm</code> as the <strong>smaller</strong> model. It is seen in <a href="#tbl-peng-lm-bill" class="quarto-xref">Table&nbsp;<span>25.5</span></a> with coefficient estimates of the parameters as well as standard errors and p-values. We refer to the model given with <code>bill_lengh_mm</code>, <code>bill_depth_mm</code>, <code>flipper_length_mm</code>, <code>sex</code>, and <code>species</code> as the <strong>larger</strong> model. It is seen in <a href="#tbl-peng-lm-all" class="quarto-xref">Table&nbsp;<span>25.6</span></a> with coefficient estimates of the parameters as well as standard errors and p-values. Given what we know about high correlations between body measurements, it is somewhat unsurprising that all of the variables have low p-values, suggesting that each variable is a statistically discernible predictor of <code>body_mass_g</code>, given all other variables in the model. However, in this section, we will go beyond the use of p-values to consider independent predictions of <code>body_mass_g</code> as a way to compare the smaller and larger models.</p>
<p><strong>The smaller model:</strong></p>
<p><span class="math display">\[
\begin{aligned}
E[\texttt{body\_mass\_g}] &amp;= \ \beta_0 + \beta_1 \times \texttt{bill\_length\_mm}\\
\widehat{\texttt{body\_mass\_g}} &amp;= \ 362.31 + 87.42 \times \texttt{bill\_length\_mm}\\
\end{aligned}
\]</span></p>
<div class="cell" data-tbl-pos="H">
<div id="tbl-peng-lm-bill" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-pos="H">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-peng-lm-bill-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;25.5: Least squares estimates for the smaller regression model predicting <code>body_mass_g</code> from <code>bill_length_mm</code>.
</figcaption><div aria-describedby="tbl-peng-lm-bill-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-condensed do-not-create-environment cell caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">362.3</td>
<td style="text-align: right; width: 5em;">283.4</td>
<td style="text-align: right; width: 5em;">1.28</td>
<td style="text-align: right; width: 5em;">0.2019</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">bill_length_mm</td>
<td style="text-align: right; width: 5em;">87.4</td>
<td style="text-align: right; width: 5em;">6.4</td>
<td style="text-align: right; width: 5em;">13.65</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p><strong>The larger model:</strong></p>
<p><span class="math display">\[
\begin{aligned}
E[\texttt{body\_mass\_g}] = \beta_0 &amp;+ \beta_1 \times \texttt{bill\_length\_mm} \\
&amp;+ \beta_2 \times \texttt{bill\_depth\_mm} \\
&amp;+ \beta_3 \times \texttt{flipper\_length\_mm} \\
&amp;+ \beta_4 \times \texttt{sex}\_{male} \\
&amp;+ \beta_5 \times \texttt{species}\_{Chinstrap} \\
&amp;+ \beta_6 \times \texttt{species}\_{Gentoo}\\
\widehat{\texttt{body\_mass\_g}} = -1460.99 &amp;+ 18.20 \times \texttt{bill\_length\_mm} \\
&amp;+ 67.22 \times \texttt{bill\_depth\_mm} \\
&amp;+ 15.95 \times \texttt{flipper\_length\_mm} \\
&amp;+ 389.89 \times \texttt{sex}\_{male} \\
&amp;- 251.48 \times \texttt{species}\_{Chinstrap} \\
&amp;+ 1014.63 \times \texttt{species}\_{Gentoo}\\
\end{aligned}
\]</span></p>
<div class="cell" data-tbl-pos="H">
<div id="tbl-peng-lm-all" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-pos="H">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-peng-lm-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;25.6: Least squares estimates of the larger regression model predicting <code>body_mass_g</code> from <code>bill_length_mm</code>, <code>bill_depth_mm</code>, <code>flipper_length_mm</code>, <code>sex</code>, and <code>species</code>.
</figcaption><div aria-describedby="tbl-peng-lm-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-condensed do-not-create-environment cell caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">-1461.0</td>
<td style="text-align: right; width: 5em;">571.31</td>
<td style="text-align: right; width: 5em;">-2.56</td>
<td style="text-align: right; width: 5em;">0.011</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">bill_length_mm</td>
<td style="text-align: right; width: 5em;">18.2</td>
<td style="text-align: right; width: 5em;">7.11</td>
<td style="text-align: right; width: 5em;">2.56</td>
<td style="text-align: right; width: 5em;">0.0109</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">bill_depth_mm</td>
<td style="text-align: right; width: 5em;">67.2</td>
<td style="text-align: right; width: 5em;">19.74</td>
<td style="text-align: right; width: 5em;">3.40</td>
<td style="text-align: right; width: 5em;">7e-04</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">flipper_length_mm</td>
<td style="text-align: right; width: 5em;">15.9</td>
<td style="text-align: right; width: 5em;">2.91</td>
<td style="text-align: right; width: 5em;">5.48</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">sexmale</td>
<td style="text-align: right; width: 5em;">389.9</td>
<td style="text-align: right; width: 5em;">47.85</td>
<td style="text-align: right; width: 5em;">8.15</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">speciesChinstrap</td>
<td style="text-align: right; width: 5em;">-251.5</td>
<td style="text-align: right; width: 5em;">81.08</td>
<td style="text-align: right; width: 5em;">-3.10</td>
<td style="text-align: right; width: 5em;">0.0021</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">speciesGentoo</td>
<td style="text-align: right; width: 5em;">1014.6</td>
<td style="text-align: right; width: 5em;">129.56</td>
<td style="text-align: right; width: 5em;">7.83</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In order to compare the smaller and larger models in terms of their <strong>ability to predict penguin mass</strong>, we need to build models that can provide independent predictions based on the penguins in the holdout samples created by cross-validation. To reiterate, each of the predictions that (when combined together) will allow us to distinguish between the smaller and larger are independent of the data which were used to build the model. In this example, using cross-validation, we remove one quarter of the data before running the least squares calculations. Then the least squares model is used to predict the <code>body_mass_g</code> of the penguins in the holdout sample. Here we use a 4-fold cross-validation (meaning that one quarter of the data is removed each time) to produce four different versions of each model (other times it might be more appropriate to use 2-fold or 10-fold or even run the model separately after removing each individual data point one at a time).</p>
<p><a href="#fig-massCV1" class="quarto-xref">Figure&nbsp;<span>25.4</span></a> displays how a model is fit to 3/4 of the data (note the slight differences in coefficients as compared to <a href="#tbl-peng-lm-bill" class="quarto-xref">Table&nbsp;<span>25.5</span></a>), and then predictions are made on the holdout sample.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-massCV1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="The left panel shows the linear model predicting body mass in grams using bill length in mm; the model was built using the red, green, and yellow triangular sections of the observed data. The right panel shows a  scatterplot of the prediction error versus the fitted values for the set  of observations in the blue triangular section of the observed data.  The prediction errors range from roughly -1,000 grams to +1,000 grams. ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-massCV1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/massCV1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;25.4: The smaller model. The coefficients are estimated using the least squares model on 3/4 of the dataset with only a single predictor variable. Predictions are made on the remaining 1/4 of the observations. The y-axis in the scatterplot represents the residual, true observed value minus the predicted value. Note that the predictions are independent of the estimated model coefficients."><img src="images/massCV1.png" class="img-fluid figure-img" style="width:90.0%" alt="The left panel shows the linear model predicting body mass in grams using bill length in mm; the model was built using the red, green, and yellow triangular sections of the observed data. The right panel shows a  scatterplot of the prediction error versus the fitted values for the set  of observations in the blue triangular section of the observed data.  The prediction errors range from roughly -1,000 grams to +1,000 grams. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-massCV1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;25.4: The smaller model. The coefficients are estimated using the least squares model on 3/4 of the dataset with only a single predictor variable. Predictions are made on the remaining 1/4 of the observations. The y-axis in the scatterplot represents the residual, true observed value minus the predicted value. Note that the predictions are independent of the estimated model coefficients.
</figcaption></figure>
</div>
</div>
</div>
<p>By repeating the process for each holdout quarter sample, the residuals from the model can be plotted against the predicted values. We see that the predictions are scattered which shows a good model fit but that the prediction errors vary <span class="math inline">\(\pm\)</span> 1,000 g of the true body mass.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-peng-mass1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="One quarter at a time, the data were removed from the model building, and the body mass of the removed penguins was predicted. The least squares  regression model was fit independently of the removed penguins. The  predictions of body mass are based on bill length only. The x-axis  represents the predicted value, the y-axis represents the error, the  difference between predicted value and actual value). Four different  scatterplots are provided, one for each set of predictions (on a quarter  of the dataset). All four sets of error values are centered around zero  with most observations between -500 and + 500. Virtually all errors are  between -1,000 and +1,000. ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-peng-mass1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="inf-model-mlr_files/figure-html/fig-peng-mass1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;25.5: The smaller model. One quarter at a time, the data were removed from the model building, and the body mass of the removed penguins was predicted. The least squares regression model was fit independently of the removed penguins. The predictions of body mass are based on bill length only. The x-axis represents the predicted value, the y-axis represents the error, the difference between predicted value and actual value."><img src="inf-model-mlr_files/figure-html/fig-peng-mass1-1.png" class="img-fluid figure-img" style="width:100.0%" alt="One quarter at a time, the data were removed from the model building, and the body mass of the removed penguins was predicted. The least squares  regression model was fit independently of the removed penguins. The  predictions of body mass are based on bill length only. The x-axis  represents the predicted value, the y-axis represents the error, the  difference between predicted value and actual value). Four different  scatterplots are provided, one for each set of predictions (on a quarter  of the dataset). All four sets of error values are centered around zero  with most observations between -500 and + 500. Virtually all errors are  between -1,000 and +1,000. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-peng-mass1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;25.5: The smaller model. One quarter at a time, the data were removed from the model building, and the body mass of the removed penguins was predicted. The least squares regression model was fit independently of the removed penguins. The predictions of body mass are based on bill length only. The x-axis represents the predicted value, the y-axis represents the error, the difference between predicted value and actual value.
</figcaption></figure>
</div>
</div>
</div>
<p>The cross-validation SSE is the sum of squared error associated with the predictions. Let <span class="math inline">\(\hat{y}_{cv,i}\)</span> be the prediction for the <span class="math inline">\(i^{th}\)</span> observation where the <span class="math inline">\(i^{th}\)</span> observation was in the hold-out fold and the other three folds were used to create the linear model. For the model using only <code>bill_length_mm</code> to predict <code>body_mass_g</code>, the CV SSE is 141,552,822.</p>
<div class="important">
<p><strong>Cross-validation SSE.</strong></p>
<p>The prediction error from the cross-validated model can be used to calculate a single numerical summary of the model. The cross-validation SSE is the sum of squared cross-validation prediction errors.</p>
<p><span class="math display">\[\mbox{CV SSE} = \sum_{i=1}^n (\hat{y}_{cv,i} - y_i)^2\]</span></p>
</div>
<p>The same process is repeated for the larger number of explanatory variables. Note that the coefficients estimated for the first cross-validation model (in <a href="#fig-massCV2" class="quarto-xref">Figure&nbsp;<span>25.6</span></a>) are slightly different from the estimates computed on the entire dataset (seen in <a href="#tbl-peng-lm-all" class="quarto-xref">Table&nbsp;<span>25.6</span></a>). <a href="#fig-massCV2" class="quarto-xref">Figure&nbsp;<span>25.6</span></a> displays the cross-validation process for the multivariable model with a full set of residual plots given in <a href="#fig-peng-mass2" class="quarto-xref">Figure&nbsp;<span>25.7</span></a>. Note that the residuals are mostly within <span class="math inline">\(\pm\)</span> 500g, providing much more precise predictions for the independent body mass values of the individual penguins.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-massCV2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="The left panel shows the linear model predicting body mass in grams using  bill length, bill depth, flipper length, sex, and species; the model was  built using the red, green, and yellow triangular sections of the observed  data. The right panel shows a scatterplot of the prediction error versus  the fitted values for the set of observations in the blue triangular  section of the observed data. The prediction errors range from roughly  -500 grams to +500 grams. ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-massCV2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/massCV2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;25.6: The larger model. The coefficients are estimated using the least squares model on 3/4 of the dataset with the five specified predictor variables. Predictions are made on the remaining 1/4 of the observations. The y-axis in the scatterplot represents the residual, true observed value minus the predicted value. Note that the predictions are independent of the estimated model coefficients."><img src="images/massCV2.png" class="img-fluid figure-img" style="width:90.0%" alt="The left panel shows the linear model predicting body mass in grams using  bill length, bill depth, flipper length, sex, and species; the model was  built using the red, green, and yellow triangular sections of the observed  data. The right panel shows a scatterplot of the prediction error versus  the fitted values for the set of observations in the blue triangular  section of the observed data. The prediction errors range from roughly  -500 grams to +500 grams. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-massCV2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;25.6: The larger model. The coefficients are estimated using the least squares model on 3/4 of the dataset with the five specified predictor variables. Predictions are made on the remaining 1/4 of the observations. The y-axis in the scatterplot represents the residual, true observed value minus the predicted value. Note that the predictions are independent of the estimated model coefficients.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-peng-mass2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="One quarter at a time, the data were removed from the model building, and  the body mass of the removed penguins was predicted. The least squares  regression model was fit independently of the removed penguins. The  predictions of body mass are based on the set of five variables described  in the larger model. The x-axis represents the predicted value, the y-axis  represents the error, the  difference between predicted value and actual  value. Four different scatterplots are provided, one for each set of  predictions (on a quarter of the dataset). All four sets of error values  are centered around zero virtually all errors are between -500 and + 500. ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-peng-mass2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="inf-model-mlr_files/figure-html/fig-peng-mass2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;25.7: The larger model. One quarter at a time, the data were removed from the model building, and the body mass of the removed penguins was predicted. The least squares regression model was fit independently of the removed penguins. The predictions of body mass are based on the set of five variables described in Table&nbsp;tbl-peng-lm-all. The x-axis represents the predicted value, the y-axis represents the error, the difference between predicted value and actual value."><img src="inf-model-mlr_files/figure-html/fig-peng-mass2-1.png" class="img-fluid figure-img" style="width:100.0%" alt="One quarter at a time, the data were removed from the model building, and  the body mass of the removed penguins was predicted. The least squares  regression model was fit independently of the removed penguins. The  predictions of body mass are based on the set of five variables described  in the larger model. The x-axis represents the predicted value, the y-axis  represents the error, the  difference between predicted value and actual  value. Four different scatterplots are provided, one for each set of  predictions (on a quarter of the dataset). All four sets of error values  are centered around zero virtually all errors are between -500 and + 500. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-peng-mass2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;25.7: The larger model. One quarter at a time, the data were removed from the model building, and the body mass of the removed penguins was predicted. The least squares regression model was fit independently of the removed penguins. The predictions of body mass are based on the set of five variables described in <a href="#tbl-peng-lm-all" class="quarto-xref">Table&nbsp;<span>25.6</span></a>. The x-axis represents the predicted value, the y-axis represents the error, the difference between predicted value and actual value.
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-peng-mass1" class="quarto-xref">Figure&nbsp;<span>25.5</span></a> shows that the independent predictions are centered around the true values (i.e., errors are centered around zero), but that the predictions can be as much as 1,000 g off when using only <code>bill_length_mm</code> to predict <code>body_mass_g</code>. On the other hand, when using <code>bill_length_mm</code>, <code>bill_depth_mm</code>, <code>flipper_length_mm</code>, <code>sex</code>, and <code>species</code> to predict <code>body_mass_g</code>, the prediction errors seem to be about half as big, as seen in <a href="#fig-peng-mass2" class="quarto-xref">Figure&nbsp;<span>25.7</span></a>. For the model using <code>bill_length_mm</code>, <code>bill_depth_mm</code>, <code>flipper_length_mm</code>, <code>sex</code>, and <code>species</code> to predict <code>body_mass_g</code>, the CV SSE is 27,728,698 (as compared to a CV SSE of 141,552,822 for the smaller model). Consistent with visually comparing the two sets of residual plots, the sum of squared prediction errors is smaller for the model which uses more predictor variables. The model with more predictor variables seems like the better model (according to the cross-validated prediction errors criteria).</p>
<p>We have provided a very brief overview to and example of using cross-validation. Cross-validation is a computational approach to model building and model validation as an alternative to reliance on p-values. While p-values have a role to play in understanding model coefficients, throughout this text, we have continued to present computational methods that broaden statistical approaches to data analysis. Cross-validation will be used again in <a href="inf-model-logistic.html" class="quarto-xref"><span>Chapter 26</span></a> with logistic regression. We encourage you to consider both standard inferential methods (such as p-values) and computational approaches (such as cross-validation) as you build and use multivariable models of all varieties.</p>
</section></section><section id="sec-chp25-review" class="level2" data-number="25.4"><h2 data-number="25.4" class="anchored" data-anchor-id="sec-chp25-review">
<span class="header-section-number">25.4</span> Chapter review</h2>
<section id="summary" class="level3" data-number="25.4.1"><h3 data-number="25.4.1" class="anchored" data-anchor-id="summary">
<span class="header-section-number">25.4.1</span> Summary</h3>
<p>Building on the modeling ideas from <a href="model-mlr.html" class="quarto-xref"><span>Chapter 8</span></a>, we have now introduced methods for evaluating coefficients (based on p-values) and evaluating models (cross-validation). There are many important aspects to consider when working with multiple variables in a single model, and we have only glanced at a few topics. Remember, multicollinearity can make coefficient interpretation difficult. A topic not covered in this text but important for multiple regression models is interaction, and we hope that you learn more about how variables work together as you continue to build up your modeling skills.</p>
</section><section id="terms" class="level3" data-number="25.4.2"><h3 data-number="25.4.2" class="anchored" data-anchor-id="terms">
<span class="header-section-number">25.4.2</span> Terms</h3>
<p>The terms introduced in this chapter are presented in <a href="#tbl-terms-chp-25" class="quarto-xref">Table&nbsp;<span>25.7</span></a>. If you’re not sure what some of these terms mean, we recommend you go back in the text and review their definitions. You should be able to easily spot them as <strong>bolded text</strong>.</p>
<div class="cell" data-tbl-pos="H">
<div id="tbl-terms-chp-25" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-pos="H">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-terms-chp-25-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;25.7: Terms introduced in this chapter.
</figcaption><div aria-describedby="tbl-terms-chp-25-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-condensed do-not-create-environment cell caption-top table-sm small"><tbody>
<tr class="odd">
<td style="text-align: left; width: 12em;">cross-validation</td>
<td style="text-align: left; width: 12em;">multicollinearity</td>
<td style="text-align: left; width: 12em;">prediction error</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 12em;">inference on multiple linear regression</td>
<td style="text-align: left; width: 12em;">multiple predictors</td>
<td style="text-align: left; width: 12em;">predictor</td>
</tr>
</tbody></table>
</div>
</div>
</figure>
</div>
</div>
</section></section><section id="sec-chp25-exercises" class="level2" data-number="25.5"><h2 data-number="25.5" class="anchored" data-anchor-id="sec-chp25-exercises">
<span class="header-section-number">25.5</span> Exercises</h2>
<p>Answers to odd-numbered exercises can be found in <a href="exercise-solutions.html#sec-exercise-solutions-25" class="quarto-xref">Appendix&nbsp;<span>A.25</span></a>.</p>
<div class="exercises">
<ol type="1">
<li>
<p><strong>GPA, mathematical interval.</strong> A survey of 55 Duke University students asked about their GPA (<code>gpa</code>), number of hours they study weekly (<code>studyweek</code>), number of hours they sleep nightly (<code>sleepnight</code>), and whether they go out more than two nights a week (<code>out_mt2</code>). We use these data to build a model predicting GPA from the other variables. Summary of the model is shown below. Note that <code>out_mt2</code> is <code>1</code> if the student goes out more than two nights a week, and 0 otherwise.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">3.508</td>
<td style="text-align: right; width: 5em;">0.347</td>
<td style="text-align: right; width: 5em;">10.114</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">studyweek</td>
<td style="text-align: right; width: 5em;">0.002</td>
<td style="text-align: right; width: 5em;">0.004</td>
<td style="text-align: right; width: 5em;">0.400</td>
<td style="text-align: right; width: 5em;">0.6908</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">sleepnight</td>
<td style="text-align: right; width: 5em;">0.000</td>
<td style="text-align: right; width: 5em;">0.047</td>
<td style="text-align: right; width: 5em;">0.008</td>
<td style="text-align: right; width: 5em;">0.994</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">out_mt2</td>
<td style="text-align: right; width: 5em;">0.151</td>
<td style="text-align: right; width: 5em;">0.097</td>
<td style="text-align: right; width: 5em;">1.551</td>
<td style="text-align: right; width: 5em;">0.127</td>
</tr>
</tbody>
</table>
</div>
</div>
<ol type="a">
<li><p>Calculate a 95% confidence interval for the coefficient of <code>out_mt2</code> (go out more than two night a week) in the model, and interpret it in the context of the data.</p></li>
<li><p>Would you expect a 95% confidence interval for the slope of the remaining variables to include 0? Explain your reasoning.</p></li>
</ol>
</li>
</ol>
<ol start="2" type="1">
<li>
<p><strong>Tourism spending.</strong> The Association of Turkish Travel Agencies reports the number of foreign tourists visiting Turkey and tourist spending by year. Three plots are provided: scatterplot showing the relationship between these two variables along with the least squares fit, residuals plot, and histogram of residuals.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="inf-model-mlr_files/figure-html/unnamed-chunk-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="inf-model-mlr_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>Describe the relationship between number of tourists and spending.</p></li>
<li><p>What are the predictor and the outcome variables?</p></li>
<li><p>Why might we want to fit a regression line to these data?</p></li>
<li><p>Do the data meet the LINE conditions required for fitting a least squares line? Use the scatterplot, the residuals plot, and the histogram to answer this question.</p></li>
</ol>
</li>
</ol>
<ol start="3" type="1">
<li>
<p><strong>Cherry trees, collinear predictors.</strong> Timber yield is approximately equal to the volume of a tree, however, this value is difficult to measure without first cutting the tree down. Instead, other variables, such as height and diameter, may be used to predict a tree’s volume and yield. Researchers wanting to understand the relationship between these variables for black cherry trees collected data from 31 such trees in the Allegheny National Forest, Pennsylvania. Height is measured in feet, diameter in inches (at 54 inches above ground), and volume in cubic feet.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> <span class="citation" data-cites="Hand:1994">(<a href="references.html#ref-Hand:1994" role="doc-biblioref">Hand 1994</a>)</span> The plots below display the distribution of each of these variables (on the diagonal) as well as provide information on the pairwise correlations between them.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="inf-model-mlr_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="inf-model-mlr_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Also provided below are three regression model outputs: <code>volume</code> vs.&nbsp;<code>diam</code>, <code>volume</code> vs.&nbsp;<code>height</code>, and <code>volume</code> vs.&nbsp;<code>height + diam</code>.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">-36.94</td>
<td style="text-align: right; width: 5em;">3.365</td>
<td style="text-align: right; width: 5em;">-11.0</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">diam</td>
<td style="text-align: right; width: 5em;">5.07</td>
<td style="text-align: right; width: 5em;">0.247</td>
<td style="text-align: right; width: 5em;">20.5</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">-87.12</td>
<td style="text-align: right; width: 5em;">29.273</td>
<td style="text-align: right; width: 5em;">-2.98</td>
<td style="text-align: right; width: 5em;">0.006</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">height</td>
<td style="text-align: right; width: 5em;">1.54</td>
<td style="text-align: right; width: 5em;">0.384</td>
<td style="text-align: right; width: 5em;">4.02</td>
<td style="text-align: right; width: 5em;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">-57.988</td>
<td style="text-align: right; width: 5em;">8.638</td>
<td style="text-align: right; width: 5em;">-6.71</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">height</td>
<td style="text-align: right; width: 5em;">0.339</td>
<td style="text-align: right; width: 5em;">0.130</td>
<td style="text-align: right; width: 5em;">2.61</td>
<td style="text-align: right; width: 5em;">0.0145</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">diam</td>
<td style="text-align: right; width: 5em;">4.708</td>
<td style="text-align: right; width: 5em;">0.264</td>
<td style="text-align: right; width: 5em;">17.82</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
</tbody>
</table>
</div>
</div>
<ol type="a">
<li><p>There are three variables described in the figure, and each is paired with each other to create three different scatterplots. Rate the pairwise relationships from most correlated to least correlated.</p></li>
<li><p>When using only one variable to model a tree’s <code>volume</code>, is <code>diam</code>eter a discernible predictor? Is <code>height</code> a discernible predictor? Explain your reasoning.</p></li>
<li><p>When using both <code>diam</code>eter and <code>height</code> to predict a tree’s <code>volume</code>, are both predictors still discernible? Explain your reasoning.</p></li>
</ol>
</li>
</ol>
<ol start="4" type="1">
<li>
<p><strong>GPA, collinear predictors.</strong> In this exercise we work with data from a survey of 55 Duke University students who were asked about their GPA, number of hours they sleep nightly, and number of nights they go <code>out</code> each week. The plots below display the distributions of each of these variables (on the diagonal) as well as their pairwise relationships and correlation coefficients.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="inf-model-mlr_files/figure-html/unnamed-chunk-13-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="inf-model-mlr_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Also provided below are three regression model outputs: <code>gpa</code> vs.&nbsp;<code>out</code>, <code>gpa</code> vs.&nbsp;<code>sleepnight</code>, and <code>gpa</code> vs.&nbsp;<code>out + sleepnight</code>.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">3.504</td>
<td style="text-align: right; width: 5em;">0.106</td>
<td style="text-align: right; width: 5em;">33.011</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">out</td>
<td style="text-align: right; width: 5em;">0.045</td>
<td style="text-align: right; width: 5em;">0.046</td>
<td style="text-align: right; width: 5em;">0.998</td>
<td style="text-align: right; width: 5em;">0.3229</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">3.46</td>
<td style="text-align: right; width: 5em;">0.318</td>
<td style="text-align: right; width: 5em;">10.874</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">sleepnight</td>
<td style="text-align: right; width: 5em;">0.02</td>
<td style="text-align: right; width: 5em;">0.045</td>
<td style="text-align: right; width: 5em;">0.445</td>
<td style="text-align: right; width: 5em;">0.6583</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">3.483</td>
<td style="text-align: right; width: 5em;">0.320</td>
<td style="text-align: right; width: 5em;">10.888</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">out</td>
<td style="text-align: right; width: 5em;">0.044</td>
<td style="text-align: right; width: 5em;">0.050</td>
<td style="text-align: right; width: 5em;">0.886</td>
<td style="text-align: right; width: 5em;">0.3796</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">sleepnight</td>
<td style="text-align: right; width: 5em;">0.003</td>
<td style="text-align: right; width: 5em;">0.048</td>
<td style="text-align: right; width: 5em;">0.072</td>
<td style="text-align: right; width: 5em;">0.9432</td>
</tr>
</tbody>
</table>
</div>
</div>
<ol type="a">
<li><p>There are three variables described in the figure, and each is paired with each other to create three different scatterplots. Rate the pairwise relationships from most correlated to least correlated.</p></li>
<li><p>When using only one variable to model <code>gpa</code>, is <code>out</code> a discernible predictor? Is <code>sleepnight</code> a discernible predictor? Explain your reasoning.</p></li>
<li><p>When using both <code>out</code> and <code>sleepnight</code> to predict <code>gpa</code> in a multiple regression model, are either of the variables discernible? Explain your reasoning.</p></li>
</ol>
</li>
</ol>
<ol start="5" type="1">
<li>
<p><strong>Movie returns.</strong> A FiveThirtyEight.com article reports that “Horror movies get nowhere near as much draw at the box office as the big-time summer blockbusters or action/adventure movies, but there’s a huge incentive for studios to continue pushing them out. The return-on-investment potential for horror movies is absurd.” To investigate how the return-on-investment (ROI) compares between genres and how this relationship has changed over time, an introductory statistics student fit a linear regression model to predict the ratio of gross revenue of movies to the production costs from genre and release year for 1,070 movies released between 2000 and 2018. Using the plots given below, determine if this regression model is appropriate for these data. In particular, use the residual plot to check the LINE conditons. <span class="citation" data-cites="webpage:horrormovies">(<a href="references.html#ref-webpage:horrormovies" role="doc-biblioref">FiveThirtyEight 2015</a>)</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="inf-model-mlr_files/figure-html/unnamed-chunk-17-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="inf-model-mlr_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
</li>
</ol>
<ol start="6" type="1">
<li>
<p><strong>Difficult encounters.</strong> A study was conducted at a university outpatient primary care clinic in Switzerland to identify factors associated with difficult doctor-patient encounters. The data consist of 527 patient encounters, conducted by the 27 medical residents employed at the clinic. After each encounter, the attending physician completed two questionnaires: the Difficult Doctor Patient Relationship Questionnaire (DDPRQ-10) and the Patient’s Vulnerability Grid (PVG). A higher score on the DDPRQ-10 indicates a more difficult encounter. The maximum possible score is 60 and encounters with score 30 and higher are considered difficult. A model was fit to predict DDPRQ-10 score from features of the attending physician: age, sex (male or not), and years of training.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">30.594</td>
<td style="text-align: right; width: 5em;">2.886</td>
<td style="text-align: right; width: 5em;">10.601</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">age</td>
<td style="text-align: right; width: 5em;">-0.016</td>
<td style="text-align: right; width: 5em;">0.104</td>
<td style="text-align: right; width: 5em;">-0.157</td>
<td style="text-align: right; width: 5em;">0.876</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">sexMale</td>
<td style="text-align: right; width: 5em;">-0.535</td>
<td style="text-align: right; width: 5em;">0.781</td>
<td style="text-align: right; width: 5em;">-0.686</td>
<td style="text-align: right; width: 5em;">0.494</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">yrs_train</td>
<td style="text-align: right; width: 5em;">0.096</td>
<td style="text-align: right; width: 5em;">0.215</td>
<td style="text-align: right; width: 5em;">0.445</td>
<td style="text-align: right; width: 5em;">0.656</td>
</tr>
</tbody>
</table>
</div>
</div>
<ol type="a">
<li><p>The intercept of the model is 30.594. What is the age, sex, and years of training of a physician whom this model would predict to have a DDPRQ-10 score of 30.594.</p></li>
<li><p>Is there evidence of a discernible association between DDPRQ-10 score and any of the physician features?</p></li>
</ol>
</li>
</ol>
<ol start="7" type="1">
<li>
<p><strong>Baby’s weight, mathematical test.</strong> US Department of Health and Human Services, Centers for Disease Control and Prevention collect information on births recorded in the country. The data used here are a random sample of 1,000 births from 2014. Here, we study the relationship between smoking and weight of the baby. The variable <code>smoke</code> is coded 1 if the mother is a smoker, and 0 if not. The summary table below shows the results of a linear regression model for predicting the average birth weight of babies, measured in pounds, based on the smoking status of the mother.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> <span class="citation" data-cites="data:births14">(<a href="references.html#ref-data:births14" role="doc-biblioref">ICPSR 2014</a>)</span></p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">-3.82</td>
<td style="text-align: right; width: 5em;">0.57</td>
<td style="text-align: right; width: 5em;">-6.73</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">weeks</td>
<td style="text-align: right; width: 5em;">0.26</td>
<td style="text-align: right; width: 5em;">0.01</td>
<td style="text-align: right; width: 5em;">18.93</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">mage</td>
<td style="text-align: right; width: 5em;">0.02</td>
<td style="text-align: right; width: 5em;">0.01</td>
<td style="text-align: right; width: 5em;">2.53</td>
<td style="text-align: right; width: 5em;">0.0115</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">sexmale</td>
<td style="text-align: right; width: 5em;">0.37</td>
<td style="text-align: right; width: 5em;">0.07</td>
<td style="text-align: right; width: 5em;">5.30</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">visits</td>
<td style="text-align: right; width: 5em;">0.02</td>
<td style="text-align: right; width: 5em;">0.01</td>
<td style="text-align: right; width: 5em;">2.09</td>
<td style="text-align: right; width: 5em;">0.0373</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">habitsmoker</td>
<td style="text-align: right; width: 5em;">-0.43</td>
<td style="text-align: right; width: 5em;">0.13</td>
<td style="text-align: right; width: 5em;">-3.41</td>
<td style="text-align: right; width: 5em;">7e-04</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Also shown below are a series of diagnostics plots.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="inf-model-mlr_files/figure-html/unnamed-chunk-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="inf-model-mlr_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>Determine if the conditions for doing inference based on mathematical models with these data are met using the diagnostic plots above. If not, describe how to proceed with the analysis.</p></li>
<li><p>Using the regression output, evaluate whether the true slope of <code>habit</code> (i.e., whether the mother is a smoker) is different than 0, given the other variables in the model. State the null and alternative hypotheses, report the p-value (using a mathematical model), and state your conclusion.</p></li>
</ol>
</li>
</ol>
<ol start="8" type="1">
<li>
<p><strong>Baby’s weight, collinear predictors.</strong> In this exercise we study the relationship between the weight of the baby and two explanatory variables: number of <code>weeks</code> of gestation and number of pregnancy hospital <code>visits</code>. <span class="citation" data-cites="data:births14">(<a href="references.html#ref-data:births14" role="doc-biblioref">ICPSR 2014</a>)</span> The plots below display the distributions of each of these variables (on the diagonal) as well as their pairwise relationships and correlation coefficients.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="inf-model-mlr_files/figure-html/unnamed-chunk-21-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="inf-model-mlr_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Also provided below are three regression model outputs: <code>weight</code> vs.&nbsp;<code>weeks</code>, <code>weight</code> vs.&nbsp;<code>visits</code>, and <code>weight</code> vs.&nbsp;<code>weeks + visits</code>.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">-0.83</td>
<td style="text-align: right; width: 5em;">1.76</td>
<td style="text-align: right; width: 5em;">-0.47</td>
<td style="text-align: right; width: 5em;">0.6395</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">weeks</td>
<td style="text-align: right; width: 5em;">0.21</td>
<td style="text-align: right; width: 5em;">0.05</td>
<td style="text-align: right; width: 5em;">4.70</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">6.56</td>
<td style="text-align: right; width: 5em;">0.36</td>
<td style="text-align: right; width: 5em;">18.36</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">visits</td>
<td style="text-align: right; width: 5em;">0.08</td>
<td style="text-align: right; width: 5em;">0.03</td>
<td style="text-align: right; width: 5em;">2.61</td>
<td style="text-align: right; width: 5em;">0.0105</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">-0.44</td>
<td style="text-align: right; width: 5em;">1.78</td>
<td style="text-align: right; width: 5em;">-0.25</td>
<td style="text-align: right; width: 5em;">0.81</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">weeks</td>
<td style="text-align: right; width: 5em;">0.19</td>
<td style="text-align: right; width: 5em;">0.05</td>
<td style="text-align: right; width: 5em;">4.00</td>
<td style="text-align: right; width: 5em;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">visits</td>
<td style="text-align: right; width: 5em;">0.04</td>
<td style="text-align: right; width: 5em;">0.03</td>
<td style="text-align: right; width: 5em;">1.26</td>
<td style="text-align: right; width: 5em;">0.21</td>
</tr>
</tbody>
</table>
</div>
</div>
<ol type="a">
<li><p>There are three variables described in the figure, and each is paired with each other to create three different scatterplots. Rate the pairwise relationships from most correlated to least correlated.</p></li>
<li><p>When using only one variable to model the baby’s <code>weight</code>, is <code>weeks</code> a discernible predictor? Is <code>visits</code> a discernible predictor? Explain your reasoning.</p></li>
<li><p>When using both <code>visits</code> and <code>weeks</code> to predict the baby’s <code>weight</code>, are both predictors still discernible? Explain your reasoning.</p></li>
</ol>
</li>
</ol>
<ol start="9" type="1">
<li>
<p><strong>Baby’s weight, cross-validation.</strong> Using a random sample of 1,000 US births from 2014, we study the relationship between the weight of the baby and various explanatory variables. <span class="citation" data-cites="data:births14">(<a href="references.html#ref-data:births14" role="doc-biblioref">ICPSR 2014</a>)</span> The plots below display prediction errors associated with two different models designed to predict <code>weight</code> of baby at birth; one model uses 7 predictors, one model uses 2 predictors. Using 4-fold cross-validation, the data were split into 4 folds. Three of the folds estimate the <span class="math inline">\(\beta_i\)</span> parameters using <span class="math inline">\(b_i\)</span>, and the model is applied to the held out fold for prediction. The process was repeated 4 times (each time holding out one of the folds).</p>
<p><span class="math display">\[
\begin{aligned}
E[\texttt{weight}] = \beta_0 &amp;+ \beta_1\times \texttt{fage} + \beta_2\times \texttt{mage} + \beta_3 \times \texttt{mature} + \beta_4 \times \texttt{weeks} \\
&amp;+ \beta_5 \times \texttt{visits} + \beta_6 \times \texttt{gained} + \beta_7 \times \texttt{habit}\\
E[\texttt{weight}] = \beta_0 &amp;+ \beta_1\times \texttt{weeks} + \beta_2\times \texttt{mature}
\end{aligned}
\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="inf-model-mlr_files/figure-html/unnamed-chunk-25-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="inf-model-mlr_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>In the first graph, note the point at roughly (predicted = 11 and error = -4). Estimate the observed and predcited value for that observation.</p></li>
<li><p>Using the same point, describe which cross-validation fold(s) were used to build its prediction model.</p></li>
<li><p>For the plot on the top, for one of the cross-validation folds, how many coefficients were estimated in the linear model? For the plot on the bottom, for one of the cross-validation folds, how many coefficients were estimated in the linear model?</p></li>
<li><p>Do the values of the residuals (along the y-axis, not the x-axis) seem markedly different for the two models? Explain your reasoning.</p></li>
</ol>
</li>
</ol>
<ol start="10" type="1">
<li>
<p><strong>RailTrail, cross-validation.</strong> The Pioneer Valley Planning Commission (PVPC) collected data north of Chestnut Street in Florence, MA for ninety days from April 5, 2005 to November 15, 2005. Data collectors set up a laser sensor, with breaks in the laser beam recording when a rail-trail user passed the data collection station.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> The plots below display prediction errors associated with two different models designed to predict the <code>volume</code> of riders on the RailTrail; one model uses 6 predictors, one model uses 2 predictors. Using 3-fold cross-validation, the data were split into 3 folds. Three of the folds estimate the <span class="math inline">\(\beta_i\)</span> parameters using <span class="math inline">\(b_i\)</span>, and the model is applied to the held out fold for prediction. The process was repeated 4 times (each time holding out one of the folds).</p>
<p><span class="math display">\[
\begin{aligned}
E[\texttt{volume}] = \beta_0 &amp;+ \beta_1 \times \texttt{hightemp} + \beta_2 \times \texttt{lowtemp} + \beta_3 \times \texttt{spring}\\
&amp;+ \beta_4 \times \texttt{weekday} + \beta_5 \times \texttt{cloudcover}+ \beta_6 \times \texttt{precip} \\
E[\texttt{volume}] = \beta_0 &amp;+ \beta_1\times \texttt{hightemp} + \beta_2\times \texttt{precip}
\end{aligned}
\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="inf-model-mlr_files/figure-html/unnamed-chunk-26-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="inf-model-mlr_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>In the second graph, note the point at roughly (predicted = 400 and error = 100). Estimate the observed and predcited value for that observation.</p></li>
<li><p>Using the same point, describe which cross-validation fold(s) were used to build its prediction model.</p></li>
<li><p>For the plot on the top, for one of the cross-validation folds, how many coefficients were estimated in the linear model? For the plot on the bottom, for one of the cross-validation folds, how many coefficients were estimated in the linear model?</p></li>
<li><p>Do the values of the residuals (along the y-axis, not the x-axis) seem markedly different for the two models? Explain your reasoning.</p></li>
</ol>
</li>
</ol>
<ol start="11" type="1">
<li>
<p><strong>Baby’s weight, cross-validation for model selection.</strong> Using a random sample of 1,000 US births from 2014, we study the relationship between the weight of the baby and various explanatory variables. <span class="citation" data-cites="data:births14">(<a href="references.html#ref-data:births14" role="doc-biblioref">ICPSR 2014</a>)</span> The plots below display prediction errors associated with two different models designed to predict <code>weight</code> of baby at birth; one model uses 7 predictors, one model uses 2 predictors. Using 4-fold cross-validation, the data were split into 4 folds. Three of the folds estimate the <span class="math inline">\(\beta_i\)</span> parameters using <span class="math inline">\(b_i\)</span>, and the model is applied to the held out fold for prediction. The process was repeated 4 times, each time holding out one of the folds.</p>
<p><span class="math display">\[
\begin{aligned}
E[\texttt{weight}] = \beta_0 &amp;+ \beta_1\times \texttt{fage} + \beta_2\times \texttt{mage}\\
&amp;+ \beta_3 \times \texttt{mature} + \beta_4 \times \texttt{weeks}\\\
&amp;+ \beta_5 \times \texttt{visits}+ \beta_6 \times \texttt{gained}\\
&amp;+ \beta_7 \times \texttt{habit}\\
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
E[\texttt{weight}] = \beta_0 &amp;+ \beta_1\times \texttt{weeks} + \beta_2\times \texttt{mature}
\end{aligned}
\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="inf-model-mlr_files/figure-html/unnamed-chunk-27-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="inf-model-mlr_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>Using the spread of the points (in the y-direction), which model should be chosen for a final report on these data? Explain your reasoning.</p></li>
<li><p>Using the summary statistic (CV SSE), which model should be chosen for a final report on these data? Explain your reasoning.</p></li>
<li><p>Why would the model with more predictors fit the data less closely than the model with only two predictors?</p></li>
</ol>
</li>
</ol>
<ol start="12" type="1">
<li>
<p><strong>RailTrail, cross-validation for model selection.</strong> The Pioneer Valley Planning Commission (PVPC) collected data north of Chestnut Street in Florence, MA for ninety days from April 5, 2005 to November 15, 2005. Data collectors set up a laser sensor, with breaks in the laser beam recording when a rail-trail user passed the data collection station. The plots below display prediction errors associated with two different models designed to predict the <code>volume</code> of riders on the RailTrail; one model uses 6 predictors, one model uses 2 predictors. Using 3-fold cross-validation, the data were split into 3 folds. Three of the folds estimate the <span class="math inline">\(\beta_i\)</span> parameters using <span class="math inline">\(b_i\)</span>, and the model is applied to the held out fold for prediction. The process was repeated 4 times, each time holding out one of the folds.</p>
<p><span class="math display">\[
\begin{aligned}
E[\texttt{volume}] = \beta_0 &amp;+ \beta_1\times \texttt{hightemp} + \beta_2\times \texttt{lowtemp}\\
&amp;+ \beta_3 \times \texttt{spring} + \beta_4 \times \texttt{weekday}\\\
&amp;+ \beta_5 \times \texttt{cloudcover}+ \beta_6 \times \texttt{precip}\\
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
E[\texttt{volume}] = \beta_0 &amp;+ \beta_1\times \texttt{hightemp} + \beta_2\times \texttt{precip}
\end{aligned}
\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="inf-model-mlr_files/figure-html/unnamed-chunk-28-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="inf-model-mlr_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>Using the spread of the points (in the y-direction), which model should be chosen for a final report on these data? Explain your reasoning.</p></li>
<li><p>Using the summary statistic (CV SSE), which model should be chosen for a final report on these data? Explain your reasoning.</p></li>
<li><p>Why would the model with more predictors fit the data less closely than the model with only two predictors?</p></li>
</ol>
</li>
</ol>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-webpage:horrormovies" class="csl-entry" role="listitem">
FiveThirtyEight. 2015. <a href="http://www.openintro.org/redirect.php?go=textbook-fivethirtyeight-scary-movies">http://www.openintro.org/redirect.php?go=textbook-fivethirtyeight-scary-movies</a>.
</div>
<div id="ref-Gorman:2014" class="csl-entry" role="listitem">
Gorman, K. B., T. D. Williams, and W. R. Fraser. 2014. <span>“<span class="nocase">Ecological sexual dimorphism and environmental variability within a community of Antarctic penguins (genus Pygoscelis)</span>.”</span> <em>PloS One</em> 9 (3): e90081. <a href="https://doi.org/doi.org/10.1371/journal.pone.0090081">https://doi.org/doi.org/10.1371/journal.pone.0090081</a>.
</div>
<div id="ref-Hand:1994" class="csl-entry" role="listitem">
Hand, D. J. 1994. <em><span class="nocase">A handbook of small data sets</span></em>. Chapman &amp; Hall/CRC.
</div>
<div id="ref-data:births14" class="csl-entry" role="listitem">
ICPSR. 2014. <span>“United States Department of Health and Human Services. Centers for Disease Control and Prevention. National Center for Health Statistics. Natality Detail File, 2014 United States. Inter-University Consortium for Political and Social Research, 2016-10-07.”</span> <a href="https://doi.org/10.3886/ICPSR36461.v1">https://doi.org/10.3886/ICPSR36461.v1</a>.
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>In previous sections, the term <strong>explanatory variable</strong> was used instead of <strong>predictor</strong>. The words are synonymous and are used separately in the different sections to be consistent with how most analysts use them: explanatory variable for testing, predictor for modeling.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>In all honesty, this particular dataset is fabricated, and the original idea for the problem comes from Jeff Witmer at Oberlin College.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>The <a href="http://openintrostat.github.io/openintro/reference/gpa.html"><code>gpa</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>The <a href="http://openintrostat.github.io/openintro/reference/tourism.html"><code>tourism</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>The <a href="http://openintrostat.github.io/openintro/reference/cherry.html"><code>cherry</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>The <a href="http://openintrostat.github.io/openintro/reference/births14.html"><code>births14</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>The <a href="https://rdrr.io/cran/mosaicData/man/RailTrail.html"><code>RailTrail</code></a> data used in this exercise can be found in the <a href="https://cran.r-project.org/web/packages/mosaicData/index.html"><strong>mosaicData</strong></a> R package.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./inf-model-slr.html" class="pagination-link" aria-label="Inference for linear regression with a single predictor">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Inference for linear regression with a single predictor</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./inf-model-logistic.html" class="pagination-link" aria-label="Inference for logistic regression">
        <span class="nav-page-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Inference for logistic regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>This is IMS2e!</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/openintrostat/ims/edit/main/inf-model-mlr.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/openintrostat/ims/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>