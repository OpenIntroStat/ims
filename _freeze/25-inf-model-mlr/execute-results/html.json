{
  "hash": "f6f60bdd31e04b2f6c2d7f5996a4088d",
  "result": {
    "engine": "knitr",
    "markdown": "# Inference for linear regression with multiple predictors {#sec-inf-model-mlr}\n\n\\chaptermark{Inference for regression with multiple predictors}\n\n\n\n\n\n::: {.chapterintro data-latex=\"\"}\nIn [Chapter -@sec-model-mlr], the least squares regression method was used to estimate linear models which predicted a particular response variable given more than one explanatory variable.\nHere, we discuss whether each of the variables individually is a statistically discernible predictor of the outcome or whether the model might be just as strong without that variable.\nThat is, as before, we apply inferential methods to ask whether a variable could have come from a population where the particular coefficient at hand was zero.\nIf one of the linear model coefficients is truly zero (in the population), then the estimate of the coefficient (using least squares) will vary around zero.\nThe inference task at hand is to decide whether the coefficient's difference from zero is large enough to decide that the data cannot possibly have come from a model where the true population coefficient is zero.\nBoth the derivations from the mathematical model and the randomization model are beyond the scope of this book, but we are able to calculate p-values using statistical software.\nWe will discuss interpreting p-values in the multiple regression setting and note some scenarios where careful understanding of the context and the relationship between variables is important.\nWe use cross-validation as a method for independent assessment of the multiple linear regression model.\n:::\n\n\n\n\n\n## Multiple regression output from software {#sec-inf-mult-reg-soft}\n\nRecall the `loans` data from [Chapter -@sec-model-mlr].\n\n::: {.data data-latex=\"\"}\nThe [`loans_full_schema`](http://openintrostat.github.io/openintro/reference/loans_full_schema.html) data can be found in the [**openintro**](http://openintrostat.github.io/openintro) R package.\nBased on the data in this dataset we have created two new variables: `credit_util` which is calculated as the total credit utilized divided by the total credit limit and `bankruptcy` which turns the number of bankruptcies to an indicator variable (0 for no bankruptcies and 1 for at least 1 bankruptcies).\nWe will refer to this modified dataset as `loans`.\n:::\n\nNow, our goal is to create a model where `interest_rate` can be predicted using the variables `debt_to_income`, `term`, and `credit_checks`.\nAs you learned in Chapter \\@ref(model-mlr), least squares can be used to find the coefficient estimates for the linear model.\nThe unknown population model can be written as:\n\n$$\n\\begin{aligned}\nE[\\texttt{interest_rate}] = \\beta_0 &+ \\beta_1\\times \\texttt{debt_to_income} \\\\\n&+ \\beta_2 \\times \\texttt{term}\\\\\n&+ \\beta_3 \\times \\texttt{credit_checks}\\\\\n\\end{aligned}\n$$\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Summary of a linear model for predicting interest rate based on `debt_to_income`, `term`, and `credit_checks`. Each of the variables has its own coefficient estimate as well as a p-value.</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 17em; font-family: monospace;\"> (Intercept) </td>\n   <td style=\"text-align:right;width: 5em; \"> 4.31 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.20 </td>\n   <td style=\"text-align:right;width: 5em; \"> 22.1 </td>\n   <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 17em; font-family: monospace;\"> debt_to_income </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.04 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.00 </td>\n   <td style=\"text-align:right;width: 5em; \"> 13.3 </td>\n   <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 17em; font-family: monospace;\"> term </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.16 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.00 </td>\n   <td style=\"text-align:right;width: 5em; \"> 37.9 </td>\n   <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 17em; font-family: monospace;\"> credit_checks </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.25 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.02 </td>\n   <td style=\"text-align:right;width: 5em; \"> 12.8 </td>\n   <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe estimated equation for the regression model may be written as a model with three predictor variables:\n\n$$\n\\begin{aligned}\n\\widehat{\\texttt{interest_rate}} = 4.31 &+ 0.041 \\times \\texttt{debt_to_income} \\\\\n&+ 0.16 \\times \\texttt{term} \\\\\n&+ 0.25 \\times \\texttt{credit_checks}\n\\end{aligned}\n$$\n\nNot only does Table \\@ref(tab:loansmodel) provide the estimates for the coefficients, it also provides information on the inference analysis (i.e., hypothesis testing) which are the focus of this chapter.\n\nIn @sec-inf-model-slr, you learned that the hypothesis test for a linear model with **one predictor**[^25-inf-model-mlr-1] can be written as:\n\n[^25-inf-model-mlr-1]: In previous sections, the term **explanatory variable** was used instead of **predictor**.\n    The words are synonymous and are used separately in the different sections to be consistent with how most analysts use them: explanatory variable for testing, predictor for modeling.\n\n\n\n\n\n> if only one predictor, $H_0: \\beta_1 = 0.$\n\nThat is, if the true population slope is zero, the p-value measures how likely it would be to select data which produced the observed slope ($b_1$) value.\n\nWith **multiple predictors**, the hypothesis is similar, however, it is now conditioned on each of the other variables remaining in the model.\n\n\n\n\n\n> if multiple predictors, $H_0: \\beta_i = 0$ given other variables in the model\n\nUsing the example above and focusing on each of the variable p-values (here we won't discuss the p-value associated with the intercept), we can write out the three different hypotheses:\n\n-   $H_0: \\beta_1 = 0$, given `term` and `credit_checks` are included in the model\n-   $H_0: \\beta_2 = 0$, given `debt_to_income` and `credit_checks` are included in the model\n-   $H_0: \\beta_3 = 0$, given `debt_to_income` and `term` are included in the model\n\nThe very low p-values from the software output tell us that each of the variables acts as an important predictor in the model, despite the inclusion of the other two.\nConsider the p-value on $H_0: \\beta_1 = 0$.\nThe low p-value says that it would be extremely unlikely to see data that produce a coefficient on `debt_to_income` as large as 0.041 if the true relationship between `debt_to_income`and `interest_rate` was non-existent (i.e., if $\\beta_1 = 0$) and the model also included `term` and `credit_checks`.\nYou might have thought that the value 0.041 is a small number (i.e., close to zero), but in the units of the problem, 0.041 turns out to be far away from zero, it's all about context!\nThe p-values on `term` and on `credit_checks` are interpreted similarly.\n\nSometimes a set of predictor variables can impact the model in unusual ways, often due to the predictor variables themselves being correlated.\n\n## Multicollinearity {#sec-inf-mult-reg-collin}\n\nIn practice, there will almost always be some degree of correlation between the explanatory variables in a multiple regression model.\nFor regression models, it is important to understand the entire context of the model, particularly for correlated variables.\nOur discussion will focus on interpreting coefficients (and their signs) in relationship to other variables as well as the discernibility (i.e., the p-value) of each coefficient.\n\nConsider an example where we would like to predict how much money is in a coin dish based only on the number of coins in the dish.\nWe ask 26 students to tell us about their individual coin dishes, collecting data on the total dollar amount, the total number of coins, and the total number of low coins.[^25-inf-model-mlr-2]\nThe number of low coins is the number of coins minus the number of quarters (a quarter is the largest commonly used US coin, at US\\$0.25).\nFigure \\@ref(fig:money) illustrates a sample of U.S. coins, their total worth (`total_amount`), the total `number of coins`, and the `number of low coins`.\n\n[^25-inf-model-mlr-2]: In all honesty, this particular dataset is fabricated, and the original idea for the problem comes from Jeff Witmer at Oberlin College.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![(ref:money-cap)](images/money.png){fig-alt='Graphic of five pennies, three nickles, two dimes, and six quarters. A summary table indicates that there are 16 total coins, 10 of which are considered low coins.  The total amount of money is one dollar and ninety cents.' width=90%}\n:::\n:::\n\n\n(ref:money-cap) A sample of coins with 16 total coins, 10 low coins, and a net worth of \\$1.90.\n\nThe collected data is given in Figure \\@ref(fig:coinfig) and shows that the `total_amount` of money is more highly correlated with the total `number of coins` than it is with the `number of low coins`.\nWe also note that the total `number of coins` and the `number of low coins` are positively correlated.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Plot describing the total amount of money (USD) as a function of the number of coins and the number of low coins. As you might expect, the total amount of money is more highly postively correlated with the total number of coins than with the number of low coins.](25-inf-model-mlr_files/figure-html/coinfig-1.png){width=90%}\n:::\n:::\n\n\nUsing the total `number of coins` as the predictor variable, Table \\@ref(tab:coinhigh) provides the least squares estimate of the coefficient is 0.13.\nFor every additional coin in the dish, we would predict that the student had US\\$0.13 more.\nThe $b_1 = 0.13$ coefficient has a small p-value associated with it, suggesting we would not have seen data like this if `number of coins` and `total_amount` of money were not linearly related.\n\n$$\\widehat{\\texttt{total_amount}} = 0.55 + 0.13 \\times \\texttt{number_of_coins}$$\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Linear model output predicting the total amount of money based on the total number of coins.</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:left;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.55 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.44 </td>\n   <td style=\"text-align:right;width: 5em; \"> 1.23 </td>\n   <td style=\"text-align:left;width: 5em; \"> 0.2301 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 10em; font-family: monospace;\"> number_of_coins </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.13 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.02 </td>\n   <td style=\"text-align:right;width: 5em; \"> 5.54 </td>\n   <td style=\"text-align:left;width: 5em; \"> &lt;0.0001 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nUsing the `number of low coins` as the predictor variable, Table \\@ref(tab:coinlow) provides the least squares estimate of the coefficient is 0.02.\nFor every additional low coin in the dish, we would predict that the student had US\\$0.02 more.\nThe $b_1 = 0.02$ coefficient has a large p-value associated with it, suggesting we could easily have seen data like ours even if the `number of low coins` and `total_amount` of money are not at all linearly related.\n\n$$\\widehat{\\texttt{total_amount}} = 2.28 + 0.02 \\times \\texttt{number_of_low_coins}$$\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Linear model output predicting the total amount of money based on the number of low coins.</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n   <td style=\"text-align:right;width: 5em; \"> 2.28 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.58 </td>\n   <td style=\"text-align:right;width: 5em; \"> 3.9 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 10em; font-family: monospace;\"> number_of_low_coins </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.02 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.05 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.4 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.7 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.workedexample data-latex=\"\"}\nCome up with an example of two observations that have the same number of low coins but the number of total coins differs by one.\nWhat is the difference in total amount?\n\n------------------------------------------------------------------------\n\nTwo samples of coins with the same number of low coins (3), but a different number of total coins (4 vs 5) and a different total total amount (\\$0.41 vs \\$0.66).\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/lowsame.png){fig-alt='A set of four coins is shown: one of each penny, nickle, dime, and quarter.  One quarter is then added to create a set of five coins: one penny, one nickle, one dime, and two quarters.  The two sets of coins have the same number of low coins but a different number of total coins.' width=90%}\n:::\n:::\n\n:::\n\n::: {.workedexample data-latex=\"\"}\nCome up with an example of two observations that have the same total number of coins but a different number of low coins.\nWhat is the difference in total amount?\n\n------------------------------------------------------------------------\n\nTwo samples of coins with the same total number of coins (4), but a different number of low coins (3 vs 4) and a different total total amount (\\$0.41 vs \\$0.17).\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/totalsame.png){fig-alt='A set of four coins is shown: one of each penny, nickle, dime, and quarter.  The quarter is then replaced with a penny to create a new set of four coins: two pennies, one nickle, and one dime.  The two sets of coins have the same number of total coins but a different number of low coins.' width=90%}\n:::\n:::\n\n:::\n\nUsing both the total `number of coins` and the `number of low coins` as predictor variables, Table \\@ref(tab:coinhighlow) provides the least squares estimates of both coefficients as 0.21 and -0.16.\nNow, with two variables in the model, the interpretation is more nuanced.\n\n-   The coefficient indicates a change in one variable while keeping the other variable constant.\\\n    For every additional coin in the dish **while** the `number of low coins` stays constant, we would predict that the student had US\\$0.21 more. Re-considering the phrase \"every additional coin in the dish **while** the number of low coins stays constant\" makes us realize that each increase is a single additional quarter (larger samples sizes would have led to a $b_1$ coefficient closer to 0.25 because of the deterministic relationship described here).\\\n-   For every additional low coin in the dish **while** the total `number of coins` stays constant, we would predict that the student had US\\$0.16 less. Re-considering the phrase \"every additional low coin in the dish **while** the number of total coins stays constant\" makes us realize that a quarter is being swapped out for a penny, nickel, or dime.\n\n\\clearpage\n\nConsidering the coefficients across Tables \\@ref(tab:coinhigh), \\@ref(tab:coinlow), and \\@ref(tab:coinhighlow) within the context and knowledge we have of US coins allows us to understand the correlation between variables and why the signs of the coefficients would change depending on the model.\nNote also, however, that the p-value for the `number of low coins` coefficient changed from Table \\@ref(tab:coinlow) to Table \\@ref(tab:coinhighlow).\nIt makes sense that the variable describing the `number of low coins` provides more information about the `total_amount` of money when it is part of a model which also includes the total `number of coins` than it does when it is used as a single variable in a simple linear regression model.\n\n$$\\widehat{\\texttt{total_amount}} = 0.80 + 0.21 \\times \\texttt{number_of_coins} - 0.16 \\times \\texttt{number of low coins}$$\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Linear model output predicting the total amount of money based on both the total number of coins and the number of low coins.</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.80 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.30 </td>\n   <td style=\"text-align:right;width: 5em; \"> 2.65 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.0142 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 10em; font-family: monospace;\"> number_of_coins </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.21 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.02 </td>\n   <td style=\"text-align:right;width: 5em; \"> 9.89 </td>\n   <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 10em; font-family: monospace;\"> number_of_low_coins </td>\n   <td style=\"text-align:right;width: 5em; \"> -0.16 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.03 </td>\n   <td style=\"text-align:right;width: 5em; \"> -5.51 </td>\n   <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nWhen working with multiple regression models, interpreting the model coefficient is not always as straightforward as it was with the coin example.\nHowever, we encourage you to always think carefully about the variables in the model, consider how they might be correlated among themselves, and work through different models to see how using different sets of variables might produce different relationships for predicting the response variable of interest.\n\n::: {.important data-latex=\"\"}\n**Multicollinearity.**\n\nMulticollinearity happens when the predictor variables are correlated within themselves.\nWhen the predictor variables themselves are correlated, the coefficients in a multiple regression model can be difficult to interpret.\n:::\n\n\n\n\n\nAlthough diving into the details are beyond the scope of this text, we will provide one more reflection about multicollinearity.\nIf the predictor variables have some degree of correlation, it can be quite difficult to interpret the value of the coefficient or evaluate whether the variable is a statistically discernible predictor of the outcome.\nHowever, even a model that suffers from high multicollinearity will likely lead to unbiased predictions of the response variable.\nSo if the task at hand is only to do prediction, multicollinearity is likely to not cause you substantial problems.\n\n\n```{=html}\n<!--\nThings I didn't talk about but could:\n\n* add R^2 and R^2_adj to the coin model\n* For assessing model fit, as is necessary, we will create residual plots of residual vs. fitted (instead of residual vs. X as we saw previously).  \n* Give another example here with a quadratic relationship and the wonky things that can happen with the p-values.\n-->\n```\n\n## Cross-validation for prediction error {#sec-inf-mult-reg-cv}\n\nIn Section \\@ref(inf-mult-reg-soft), p-values were calculated on each of the model coefficients.\nThe p-value gives a sense of which variables are important to the model; however, a more extensive treatment of variable selection is warranted in a follow-up course or textbook.\nHere, we use cross-validation prediction error to focus on which variable(s) are important for predicting the response variable of interest.\nIn general, linear models are also used to make predictions of individual observations.\nIn addition to model building, cross-validation provides a method for generating predictions that are not overfit to the particular dataset at hand.\nWe continue to encourage you to take up further study on the topic of cross-validation, as it is among the most important ideas in modern data analysis, and we are only able to scratch the surface here.\n\nCross-validation is a computational technique which removes some observations before a model is run, then assesses the model accuracy on the held-out sample.\nBy removing some observations, we provide ourselves with an independent evaluation of the model (that is, the removed observations do not contribute to finding the parameters which minimize the least squares equation).\nCross-validation can be used in many different ways (as an independent assessment), and here we will just scratch the surface with respect to one way the technique can be used to compare models.\nSee Figure \\@ref(fig:cv) for a visual representation of the cross-validation process.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![The dataset is broken into k folds (here k = 4).  One at a time, a model is built using k-1 of the folds, and predictions are calculated on the single held out sample which will be completely independent of the model estimation.](images/CV.png){fig-alt='A square represents the original observed data which has been partitioned into four triangular segments.  From the original partition, four different settings are considered. The first setting is such that the red, green, and yellow triangular representations of the data are used to build the model; the blue triangular representation of the data is heldout and used for independent model prediction. The second setting is such that the blue, green, and yellow triangular representations of the data are used to build the model; the red triangular representation of the data is heldout and used for independent model prediction. The third setting is such that the red, blue, and yellow triangular representations of the data are used to build the model; the green triangular representation of the data is heldout and used for independent model prediction. The fourth setting is such that the red, green, and blue triangular representations of the data are used to build the model; the yellow triangular representation of the data is heldout and used for independent model prediction.' width=90%}\n:::\n:::\n\n\n\n\n::: {.data data-latex=\"\"}\nThe [`penguins`](https://allisonhorst.github.io/palmerpenguins/articles/intro.html) data can be found in the [**palmerpenguings**](https://github.com/allisonhorst/palmerpenguins) R package.\n:::\n\nOur goal in this section is to compare two different regression models which both seek to predict the mass of an individual penguin in grams.\nThe observations of three different penguin species include measurements on body size and sex.\nThe data were collected by [Dr. Kristen Gorman](https://www.uaf.edu/cfos/people/faculty/detail/kristen-gorman.php) and the [Palmer Station, Antarctica LTER](https://pal.lternet.edu/) as part of the [Long Term Ecological Research Network](https://lternet.edu/).\n[@Gorman:2014] Although not exactly aligned with this research project, you might be able to imagine a setting where the dimensions of the penguin are known (through, for example, aerial photographs) but the mass is not known.\nThe first model will predict `body_mass_g` by using only the `bill_length_mm`, a variable denoting the length of a penguin's bill, in mm.\nThe second model will predict `body_mass_g` by using `bill_length_mm`, `bill_depth_mm`, `flipper_length_mm`, `sex`, and `species`.\n\n::: {.important data-latex=\"\"}\n**Prediction error.**\n\nThe predicted error (also previously called the **residual**) is the difference between the observed value and the predicted value (from the regression model).\n\n$$\\text{prediction error}_i = e_i = y_i - \\hat{y}_i$$\n:::\n\nThe presentation below (see the comparison of Figures \\@ref(fig:peng-mass1) and \\@ref(fig:peng-mass2)) shows that the model with more variables predicts `body_mass_g` with much smaller errors (predicted minus actual body mass) than the model which uses only `bill_length_g`.\nWe have deliberately used a model that intuitively makes sense (the more body measurements, the more predictable mass is).\nHowever, in many settings, it is not obvious which variables or which models contribute most to accurate predictions.\nCross-validation is one way to get accurate independent predictions with which to compare different models.\n\n### Comparing two models to predict body mass in penguins\n\nThe question we will seek to answer is whether the predictions of `body_mass_g` are substantially better when `bill_length_mm`, `bill_depth_mm`, `flipper_length_mm`, `sex`, and `species` are used in the model, as compared with a model on `bill_length_mm` only.\n\nWe refer to the model given with only `bill_lengh_mm` as the **smaller** model.\nIt is seen in Table \\@ref(tab:peng-lm-bill) with coefficient estimates of the parameters as well as standard errors and p-values.\nWe refer to the model given with `bill_lengh_mm`, `bill_depth_mm`, `flipper_length_mm`, `sex`, and `species` as the **larger** model.\nIt is seen in Table \\@ref(tab:peng-lm-all) with coefficient estimates of the parameters as well as standard errors and p-values.\nGiven what we know about high correlations between body measurements, it is somewhat unsurprising that all of the variables have low p-values, suggesting that each variable is a statistically discernible predictor of `body_mass_g`, given all other variables in the model.\nHowever, in this section, we will go beyond the use of p-values to consider independent predictions of `body_mass_g` as a way to compare the smaller and larger models.\n\n**The smaller model:**\n\n$$\n\\begin{aligned}\nE[\\texttt{body_mass_g}] &= \\ \\beta_0 + \\beta_1 \\times \\texttt{bill_length_mm}\\\\\n\\widehat{\\texttt{body_mass_g}} &= \\ 362.31 + 87.42 \\times \\texttt{bill_length_mm}\\\\\n\\end{aligned}\n$$\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>The smalller model: least squares estimates of the regression model predicting `body_mass_g` from `bill_length_mm`.</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 15em; font-family: monospace;\"> (Intercept) </td>\n   <td style=\"text-align:right;width: 5em; \"> 362.3 </td>\n   <td style=\"text-align:right;width: 5em; \"> 283.4 </td>\n   <td style=\"text-align:right;width: 5em; \"> 1.28 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.2019 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 15em; font-family: monospace;\"> bill_length_mm </td>\n   <td style=\"text-align:right;width: 5em; \"> 87.4 </td>\n   <td style=\"text-align:right;width: 5em; \"> 6.4 </td>\n   <td style=\"text-align:right;width: 5em; \"> 13.65 </td>\n   <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n**The larger model:**\n\n$$\n\\begin{aligned}\nE[\\texttt{body_mass_g}] = \\beta_0 &+ \\beta_1 \\times \\texttt{bill_length_mm} \\\\\n&+ \\beta_2 \\times \\texttt{bill_depth_mm} \\\\\n&+ \\beta_3 \\times \\texttt{flipper_length_mm} \\\\\n&+ \\beta_4 \\times \\texttt{sex}_{male} \\\\\n&+ \\beta_5 \\times \\texttt{species}_{Chinstrap} \\\\\n&+ \\beta_6 \\times \\texttt{species}_{Gentoo}\\\\\n\\widehat{\\texttt{body_mass_g}} = -1460.99 &+ 18.20 \\times \\texttt{bill_length_mm} \\\\\n&+ 67.22 \\times \\texttt{bill_depth_mm} \\\\\n&+ 15.95 \\times \\texttt{flipper_length_mm} \\\\\n&+ 389.89 \\times \\texttt{sex}_{male} \\\\\n&- 251.48 \\times \\texttt{species}_{Chinstrap} \\\\\n&+ 1014.63 \\times \\texttt{species}_{Gentoo}\\\\\n\\end{aligned}\n$$\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>The larger model: least squares estimates of the regression model predicting `body_mass_g` from `bill_length_mm`, `bill_depth_mm`, `flipper_length_mm`, `sex`, and `species`.</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 15em; font-family: monospace;\"> (Intercept) </td>\n   <td style=\"text-align:right;width: 5em; \"> -1461.0 </td>\n   <td style=\"text-align:right;width: 5em; \"> 571.31 </td>\n   <td style=\"text-align:right;width: 5em; \"> -2.56 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.011 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 15em; font-family: monospace;\"> bill_length_mm </td>\n   <td style=\"text-align:right;width: 5em; \"> 18.2 </td>\n   <td style=\"text-align:right;width: 5em; \"> 7.11 </td>\n   <td style=\"text-align:right;width: 5em; \"> 2.56 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.0109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 15em; font-family: monospace;\"> bill_depth_mm </td>\n   <td style=\"text-align:right;width: 5em; \"> 67.2 </td>\n   <td style=\"text-align:right;width: 5em; \"> 19.74 </td>\n   <td style=\"text-align:right;width: 5em; \"> 3.40 </td>\n   <td style=\"text-align:right;width: 5em; \"> 7e-04 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 15em; font-family: monospace;\"> flipper_length_mm </td>\n   <td style=\"text-align:right;width: 5em; \"> 15.9 </td>\n   <td style=\"text-align:right;width: 5em; \"> 2.91 </td>\n   <td style=\"text-align:right;width: 5em; \"> 5.48 </td>\n   <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 15em; font-family: monospace;\"> sexmale </td>\n   <td style=\"text-align:right;width: 5em; \"> 389.9 </td>\n   <td style=\"text-align:right;width: 5em; \"> 47.85 </td>\n   <td style=\"text-align:right;width: 5em; \"> 8.15 </td>\n   <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 15em; font-family: monospace;\"> speciesChinstrap </td>\n   <td style=\"text-align:right;width: 5em; \"> -251.5 </td>\n   <td style=\"text-align:right;width: 5em; \"> 81.08 </td>\n   <td style=\"text-align:right;width: 5em; \"> -3.10 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.0021 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 15em; font-family: monospace;\"> speciesGentoo </td>\n   <td style=\"text-align:right;width: 5em; \"> 1014.6 </td>\n   <td style=\"text-align:right;width: 5em; \"> 129.56 </td>\n   <td style=\"text-align:right;width: 5em; \"> 7.83 </td>\n   <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nIn order to compare the smaller and larger models in terms of their **ability to predict penguin mass**, we need to build models that can provide independent predictions based on the penguins in the holdout samples created by cross-validation.\nTo reiterate, each of the predictions that (when combined together) will allow us to distinguish between the smaller and larger are independent of the data which were used to build the model.\nIn this example, using cross-validation, we remove one quarter of the data before running the least squares calculations.\nThen the least squares model is used to predict the `body_mass_g` of the penguins in the holdout sample.\nHere we use a 4-fold cross-validation (meaning that one quarter of the data is removed each time) to produce four different versions of each model (other times it might be more appropriate to use 2-fold or 10-fold or even run the model separately after removing each individual data point one at a time).\n\nFigure \\@ref(fig:massCV1) displays how a model is fit to 3/4 of the data (note the slight differences in coefficients as compared to Table \\@ref(tab:peng-lm-bill)), and then predictions are made on the holdout sample.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![The coefficients are estimated using the least squares model on 3/4 of the dataset with only a single predictor variable. Predictions are made on the remaining 1/4 of the observations. The y-axis in the scatterplot represents the residual: true observed value minus the predicted value. Note that the predictions are independent of the estimated model coefficients.](images/massCV1.png){fig-alt='The left panel shows the linear model predicting body mass in grams using bill length in mm; the model was built using the red, green, and yellow triangular sections of the observed data.  The right panel shows a scatterplot of the prediction error versus the fitted values for the set of observations in the blue triangular section of the observed data. The prediction errors range from roughly -1000 grams to +1000 grams.' width=100%}\n:::\n:::\n\n\nBy repeating the process for each holdout quarter sample, the residuals from the model can be plotted against the predicted values.\nWe see that the predictions are scattered which shows a good model fit but that the prediction errors vary $\\pm$ 1000g of the true body mass.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![One quarter at a time, the data were removed from the model building, and the body mass of the removed penguins was predicted. The least squares regression model was fit independently of the removed penguins.  The predictions of body mass are based on bill length only. The x-axis represents the predicted value, the y-axis represents the error (difference between predicted value and actual value).](25-inf-model-mlr_files/figure-html/peng-mass1-1.png){width=100%}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\nThe cross-validation SSE is the sum of squared error associated with the predictions.\nLet $\\hat{y}_{cv,i}$ be the prediction for the $i^{th}$ observation where the $i^{th}$ observation was in the hold-out fold and the other three folds were used to create the linear model.\nFor the model using only `bill_length_mm` to predict `body_mass_g`, the CV SSE is 141,552,822.\n\n::: {.important data-latex=\"\"}\n**Cross-validation SSE.**\n\nThe prediction error from the cross-validated model can be used to calculate a single numerical summary of the model.\nThe cross-validation SSE is the sum of squared cross-validation prediction errors.\n\n$$\\mbox{CV SSE} = \\sum_{i=1}^n (\\hat{y}_{cv,i} - y_i)^2$$\n:::\n\nThe same process is repeated for the larger number of explanatory variables.\nNote that the coefficients estimated for the first cross-validation model (in Figure \\@ref(fig:massCV2)) are slightly different from the estimates computed on the entire dataset (seen in Table \\@ref(tab:peng-lm-all)).\nFigure \\@ref(fig:massCV2) displays the cross-validation process for the multivariable model with a full set of residual plots given in Figure \\@ref(fig:peng-mass2).\nNote that the residuals are mostly within $\\pm$ 500g, providing much more precise predictions for the independent body mass values of the individual penguins.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![The coefficients are estimated using the least squares model on 3/4 of the dataset with the five specified predictor variables. Predictions are made on the remaining 1/4 of the observations.  The y-axis in the scatterplot represents the residual: true observed value minus the predicted value. Note that the predictions are independent of the estimated model coefficients.](images/massCV2.png){fig-alt='The left panel shows the linear model predicting body mass in grams using bill length, bill depth, flipper length, sex, and species; the model was built using the red, green, and yellow triangular sections of the observed data.  The right panel shows a scatterplot of the prediction error versus the fitted values for the set of observations in the blue triangular section of the observed data. The prediction errors range from roughly -500 grams to +500 grams.' width=100%}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![One quarter at a time, the data were removed from the model building, and the body mass of the removed penguins was predicted. The least squares regression model was fit independently of the removed penguins.  The predictions of body mass are based on bill length only. The x-axis represents the predicted value, the y-axis represents the error (difference between predicted value and actual value).](25-inf-model-mlr_files/figure-html/peng-mass2-1.png){width=90%}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\nFigure \\@ref(fig:peng-mass1) shows that the independent predictions are centered around the true values (i.e., errors are centered around zero), but that the predictions can be as much as 1000g off when using only `bill_length_mm` to predict `body_mass_g`.\nOn the other hand, when using `bill_length_mm`, `bill_depth_mm`, `flipper_length_mm`, `sex`, and `species` to predict `body_mass_g`, the prediction errors seem to be about half as big, as seen in Figure \\@ref(fig:peng-mass2).\nFor the model using `bill_length_mm`, `bill_depth_mm`, `flipper_length_mm`, `sex`, and `species` to predict `body_mass_g`, the CV SSE is 27,728,698.\nConsistent with visually comparing the two sets of residual plots, the sum of squared prediction errors is smaller for the model which uses more predictor variables.\nThe model with more predictor variables seems like the better model (according to the cross-validated prediction errors criteria).\n\nWe have provided a very brief overview to and example using cross-validation.\nCross-validation is a computational approach to model building and model validation as an alternative to reliance on p-values.\nWhile p-values have a role to play in understanding model coefficients, throughout this text, we have continued to present computational methods that broaden statistical approaches to data analysis.\nCross-validation will be used again in Section \\@ref(inf-model-logistic) with logistic regression.\nWe encourage you to consider both standard inferential methods (such as p-values) and computational approaches (such as cross-validation) as you build and use multivariable models of all varieties.\n\n\\clearpage\n\n## Chapter review {#sec-chp25-review}\n\n### Summary\n\nBuilding on the modeling ideas from Chapter \\@ref(model-mlr), we have now introduced methods for evaluating coefficients (based on p-values) and evaluating models (cross-validation).\nThere are many important aspects to consider when working with multiple variables in a single model, and we have only glanced at a few topics.\nRemember, multicollinearity can make coefficient interpretation difficult.\nA topic not covered in this text but important for multiple regression models is interaction, and we hope that you learn more about how variables work together as you continue to build up your modeling skills.\n\n### Terms\n\nWe introduced the following terms in the chapter.\nIf you're not sure what some of these terms mean, we recommend you go back in the text and review their definitions.\nWe are purposefully presenting them in alphabetical order, instead of in order of appearance, so they will be a little more challenging to locate.\nHowever, you should be able to easily spot them as **bolded text**.\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> cross-validation </td>\n   <td style=\"text-align:left;\"> multicollinearity </td>\n   <td style=\"text-align:left;\"> prediction error </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> inference on multiple linear regression </td>\n   <td style=\"text-align:left;\"> multiple predictors </td>\n   <td style=\"text-align:left;\"> predictor </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\\clearpage\n\n## Exercises {#sec-chp25-exercises}\n\nAnswers to odd-numbered exercises can be found in [Appendix -@sec-exercise-solutions-25].\n\n::: {.exercises data-latex=\"\"}\n1. **GPA, mathematical interval.**\nA survey of 55 Duke University students asked about their GPA (`gpa`), number of hours they study weekly (`studyweek`), number of hours they sleep nightly (`sleepnight`), and whether they go out more than two nights a week (`out_mt2`).\nWe use these data to build a model predicting GPA from the other variables. Summary of the model is shown below. Note that `out_mt2` is `1` if the student goes out more than two nights a week, and 0 otherwise.^[The [`gpa`](http://openintrostat.github.io/openintro/reference/gpa.html) data used in this exercise can be found in the [**openintro**](http://openintrostat.github.io/openintro) R package.]\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> 3.508 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.347 </td>\n       <td style=\"text-align:right;width: 5em; \"> 10.114 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> studyweek </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.002 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.004 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.400 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.6908 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> sleepnight </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.000 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.047 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.008 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.994 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> out_mt2 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.151 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.097 </td>\n       <td style=\"text-align:right;width: 5em; \"> 1.551 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.127 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n    a. Calculate a 95% confidence interval for the coefficient of `out_mt2` (go out more than two night a week) in the model, and interpret it in the context of the data.\n\n    2. Would you expect a 95% confidence interval for the slope of the remaining variables to include 0? Explain.\n\n1. **GPA, collinear predictors.**\nIn this exercise we work with data from a survey of 55 Duke University students who were asked about their GPA, number of hours they sleep nightly, and number of nights they go `out` each week.\n\n    The plots below describe the show the distribution of each of these variables (on the diagonal) as well as provide information on the pairwise correlations between them.\n    \n    Also provided below are three regression model outputs: `gpa` vs. `out`, `gpa` vs. `sleepnight`, and `gpa` vs. `out + sleepnight`.\n    \n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> 3.504 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.106 </td>\n       <td style=\"text-align:right;width: 5em; \"> 33.011 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> out </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.045 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.046 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.998 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.3229 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> 3.46 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.318 </td>\n       <td style=\"text-align:right;width: 5em; \"> 10.874 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> sleepnight </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.02 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.045 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.445 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.6583 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> 3.483 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.320 </td>\n       <td style=\"text-align:right;width: 5em; \"> 10.888 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> out </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.044 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.050 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.886 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.3796 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> sleepnight </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.003 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.048 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.072 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.9432 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n    \n    ::: {.content-hidden unless-format=\"pdf\"}\n    *See next page for the plots and parts a to c.*\n    :::\n    \n    \\clearpage\n    \n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](25-inf-model-mlr_files/figure-html/unnamed-chunk-27-1.png){width=100%}\n    :::\n    :::\n    \n    a. There are three variables described in the figure, and each is paired with each other to create three different scatterplots. Rate the pairwise relationships from most correlated to least correlated.\n    \n    b. When using only one variable to model `gpa`, is `out` a discernible predictor?  Is `sleepnight` a discernible predictor?  Explain.\n    \n    c. When using both `out` and `sleepnight` to predict `gpa` in a multiple regression model, are either of the predictors discernible? Explain.\n    \n    \\clearpage\n\n1.  **Tourism spending.** \nThe Association of Turkish Travel Agencies reports the number of foreign tourists visiting Turkey and tourist spending by year. \nThree plots are provided: scatterplot showing the relationship between these two variables along with the least squares fit, residuals plot, and histogram of residuals.^[The [`tourism`](http://openintrostat.github.io/openintro/reference/tourism.html) data used in this exercise can be found in the [**openintro**](http://openintrostat.github.io/openintro) R package.]\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](25-inf-model-mlr_files/figure-html/unnamed-chunk-28-1.png){width=100%}\n    :::\n    :::\n\n    a.  Describe the relationship between number of tourists and spending.\n\n    b.  What are the predictor and the outcome variables?\n\n    c.  Why might we want to fit a regression line to these data?\n\n    d.  Do the data meet the LINE conditions required for fitting a least squares line? In addition to the scatterplot, use the residual plot and histogram to answer this question.\n    \n    \\clearpage\n\n1. **Cherry trees with collinear predictors.**\nTimber yield is approximately equal to the volume of a tree, however, this value is difficult to measure without first cutting the tree down. Instead, other variables, such as height and diameter, may be used to predict a tree's volume and yield.\nResearchers wanting to understand the relationship between these variables for black cherry trees collected data from 31 such trees in the Allegheny National Forest, Pennsylvania. Height is measured in feet, diameter in inches (at 54 inches above ground), and volume in cubic feet.^[The [`cherry`](http://openintrostat.github.io/openintro/reference/cherry.html) data used in this exercise can be found in the [**openintro**](http://openintrostat.github.io/openintro) R package.] [@Hand:1994]\n\n    The plots below describe the show the distribution of each of these variables (on the diagonal) as well as provide information on the pairwise correlations between them.\n\n    Also provided below are three regression model outputs: `volume` vs. `diam`, `volume` vs. `height`, and `volume` vs. `height + diam`.\n    \n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> -36.94 </td>\n       <td style=\"text-align:right;width: 5em; \"> 3.365 </td>\n       <td style=\"text-align:right;width: 5em; \"> -11.0 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> diam </td>\n       <td style=\"text-align:right;width: 5em; \"> 5.07 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.247 </td>\n       <td style=\"text-align:right;width: 5em; \"> 20.5 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> -87.12 </td>\n       <td style=\"text-align:right;width: 5em; \"> 29.273 </td>\n       <td style=\"text-align:right;width: 5em; \"> -2.98 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.006 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> height </td>\n       <td style=\"text-align:right;width: 5em; \"> 1.54 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.384 </td>\n       <td style=\"text-align:right;width: 5em; \"> 4.02 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.000 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> -57.988 </td>\n       <td style=\"text-align:right;width: 5em; \"> 8.638 </td>\n       <td style=\"text-align:right;width: 5em; \"> -6.71 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> height </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.339 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.130 </td>\n       <td style=\"text-align:right;width: 5em; \"> 2.61 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.0145 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> diam </td>\n       <td style=\"text-align:right;width: 5em; \"> 4.708 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.264 </td>\n       <td style=\"text-align:right;width: 5em; \"> 17.82 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n    \n    ::: {.content-hidden unless-format=\"pdf\"}\n    *See next page for the plots and parts a to c.*\n    :::\n    \n    \\clearpage\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](25-inf-model-mlr_files/figure-html/unnamed-chunk-30-1.png){width=100%}\n    :::\n    :::\n\n    a. There are three variables described in the figure, and each is paired with each other to create three different scatterplots. Rate the pairwise relationships from most correlated to least correlated.\n    \n    b. When using only one variable to model a tree's `volume`, is `diam`eter a discernible predictor variable?  Is `height` a discernible predictor variable?  Explain.\n    \n    c. When using both `diam`eter and `height` to predict a tree's `volume`, are both predictor variables still discernible? Explain.\n    \n    \\clearpage\n\n1.  **Movie returns.** \nA FiveThirtyEight.com article reports that \"Horror movies get nowhere near as much draw at the box office as the big-time summer blockbusters or action/adventure movies, but there's a huge incentive for studios to continue pushing them out. The return-on-investment potential for horror movies is absurd.\" \nTo investigate how the return-on-investment (ROI) compares between genres and how this relationship has changed over time, an introductory statistics student fit a linear regression model to predict the ratio of gross revenue of movies to the production costs from genre and release year for 1,070 movies released between 2000 and 2018.\nUsing the plots given below, determine if this regression model is appropriate for these data. In particular, use the residual plot to check the LINE conditons. [@webpage:horrormovies]\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](25-inf-model-mlr_files/figure-html/unnamed-chunk-31-1.png){width=100%}\n    :::\n    :::\n    \n    \\clearpage\n\n1.  **Difficult encounters.**\nA study was conducted at a university outpatient primary care clinic in Switzerland to identify factors associated with difficult doctor-patient encounters. The data consist of 527 patient encounters, conducted by the 27 medical residents employed at the clinic. After each encounter, the attending physician completed two questionnaires: the Difficult Doctor Patient Relationship Questionnaire (DDPRQ-10) and the patient's vulnerability grid (PVG).\n\n    A higher score on the DDPRQ-10 indicates a more difficult encounter. The maximum possible score is 60 and encounters with score 30 and higher are considered difficult.\n    \n    A model was fit for the association of DDPRQ-10 score with features of the attending physician: age, sex (identify as male or not), and years of training.\n    \n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> 30.594 </td>\n       <td style=\"text-align:right;width: 5em; \"> 2.886 </td>\n       <td style=\"text-align:right;width: 5em; \"> 10.601 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> age </td>\n       <td style=\"text-align:right;width: 5em; \"> -0.016 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.104 </td>\n       <td style=\"text-align:right;width: 5em; \"> -0.157 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.876 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> sexMale </td>\n       <td style=\"text-align:right;width: 5em; \"> -0.535 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.781 </td>\n       <td style=\"text-align:right;width: 5em; \"> -0.686 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.494 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> yrs_train </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.096 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.215 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.445 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.656 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n    \n    a. The intercept of the model is 30.594. What is the age, sex, and years of training of a physician whom this model would predict to have a DDPRQ-10 score of 30.594.\n    \n    b. Is there evidence of a discernible association between DDPRQ-10 score and any of the physician features?\n    \n    \\clearpage\n\n1. **Baby's weight, mathematical test.**\nUS Department of Health and Human Services, Centers for Disease Control and Prevention collect information on births recorded in the country.\nThe data used here are a random sample of 1,000 births from 2014.\nHere, we study the relationship between smoking and weight of the baby. \nThe variable `smoke` is coded 1 if the mother is a smoker, and 0 if not. \nThe summary table below shows the results of a linear regression model for predicting the average birth weight of babies, measured in pounds, based on the smoking status of the mother.^[The [`births14`](http://openintrostat.github.io/openintro/reference/births14.html) data used in this exercise can be found in the [**openintro**](http://openintrostat.github.io/openintro) R package.] [@data:births14]\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> -3.82 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.57 </td>\n       <td style=\"text-align:right;width: 5em; \"> -6.73 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> weeks </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.26 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.01 </td>\n       <td style=\"text-align:right;width: 5em; \"> 18.93 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> mage </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.02 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.01 </td>\n       <td style=\"text-align:right;width: 5em; \"> 2.53 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.0115 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> sexmale </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.37 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.07 </td>\n       <td style=\"text-align:right;width: 5em; \"> 5.30 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> visits </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.02 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.01 </td>\n       <td style=\"text-align:right;width: 5em; \"> 2.09 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.0373 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> habitsmoker </td>\n       <td style=\"text-align:right;width: 5em; \"> -0.43 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.13 </td>\n       <td style=\"text-align:right;width: 5em; \"> -3.41 </td>\n       <td style=\"text-align:right;width: 5em; \"> 7e-04 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n    \n    Also shown below are a series of diagnostics plots.\n    \n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](25-inf-model-mlr_files/figure-html/unnamed-chunk-34-1.png){width=90%}\n    :::\n    :::\n    \n    a. Determine if the conditions for doing inference based on mathematical models with these data are met using the diagnostic plots above. If not, describe how to proceed with the analysis.\n    \n    b. Using the regression output, evaluate whether the true slope of `habit` (i.e. whether the mother is a smoker) is different than 0, given the other variables in the model. State the null and alternative hypotheses, report the p-value (using a mathematical model), and state your conclusion.\n    \n    \\clearpage\n\n1.  **Baby's weight with collinear predictors.** \nIn this exercise we study the relationship between the weight of the baby and two explanatory variables: number of `weeks` of gestation and number of pregnancy hospital `visits`. [@data:births14]\n\n    The plots below describe the show the distribution of each of these variables (on the diagonal) as well as provide information on the pairwise correlations between them.\n    \n    Also provided below are three regression model outputs: `weight` vs. `weeks`, `weight` vs. `visits`, and `weight` vs. `weeks + visits`.\n    \n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> -0.83 </td>\n       <td style=\"text-align:right;width: 5em; \"> 1.76 </td>\n       <td style=\"text-align:right;width: 5em; \"> -0.47 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.6395 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> weeks </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.21 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.05 </td>\n       <td style=\"text-align:right;width: 5em; \"> 4.70 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> 6.56 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.36 </td>\n       <td style=\"text-align:right;width: 5em; \"> 18.36 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> visits </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.08 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.03 </td>\n       <td style=\"text-align:right;width: 5em; \"> 2.61 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.0105 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> -0.44 </td>\n       <td style=\"text-align:right;width: 5em; \"> 1.78 </td>\n       <td style=\"text-align:right;width: 5em; \"> -0.25 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.81 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> weeks </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.19 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.05 </td>\n       <td style=\"text-align:right;width: 5em; \"> 4.00 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.00 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> visits </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.04 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.03 </td>\n       <td style=\"text-align:right;width: 5em; \"> 1.26 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.21 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n    \n    ::: {.content-hidden unless-format=\"pdf\"}\n    *See next page for the plots and parts a to c.*\n    :::\n    \n    \\clearpage\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](25-inf-model-mlr_files/figure-html/unnamed-chunk-36-1.png){width=100%}\n    :::\n    :::\n    \n    a. There are three variables described in the figure, and each is paired with each other to create three different scatterplots. Rate the pairwise relationships from most correlated to least correlated.\n    \n    b. When using only one variable to model the baby's `weight`, is `weeks` a discernible predictor variable?  Is `visits` a discernible predictor variable? Explain.\n    \n    c. When using both `visits` and `weeks` to predict the baby's `weight`, are both predictor variables still discernible? Explain.\n    \n    \\clearpage\n\n1.  **Baby's weight, cross-validation.** \nUsing a random sample of 1,000 US births from 2014, we study the relationship between the weight of the baby and various explanatory variables. [@data:births14]\n\n    The plots below describe prediction errors associated with two different models designed to predict `weight` of baby at birth; one model uses 7 predictors, one model uses 2 predictors. Using 4-fold cross-validation, the data were split into 4 folds. Three of the folds estimate the $\\beta_i$ parameters using $b_i$, and the model is applied to the held out fold for prediction. The process was repeated 4 times (each time holding out one of the folds).\n\n    $$\n    \\begin{aligned}\n    E[\\texttt{weight}] = \\beta_0 &+ \\beta_1\\times \\texttt{fage} + \\beta_2\\times \\texttt{mage}\\\\\n    &+ \\beta_3 \\times \\texttt{mature} + \\beta_4 \\times \\texttt{weeks}\\\\\\\n    &+ \\beta_5 \\times \\texttt{visits}+ \\beta_6 \\times \\texttt{gained}\\\\\n    &+ \\beta_7 \\times \\texttt{habit}\\\\\n    \\end{aligned}\n    $$\n\n    $$\n    \\begin{aligned}\n    E[\\texttt{weight}] = \\beta_0 &+ \\beta_1\\times \\texttt{weeks} + \\beta_2\\times \\texttt{mature}\n    \\end{aligned}\n    $$\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](25-inf-model-mlr_files/figure-html/unnamed-chunk-37-1.png){width=90%}\n    :::\n    :::\n    \n    a. In the first graph, note the point at roughly (predicted = 11 and error = -4).  Estimate the observed and predicted value for that observation.\n     \n    b. Using the same point, describe which cross-validation fold(s) were used to build its prediction model.\n     \n    c. For the plot on the left, for one of the cross-validation folds, how many coefficients were estimated in the linear model?  For the plot on the right, for one of the cross-validation folds, how many coefficients were estimated in the linear model? \n     \n    d. Do the values of the residuals (along the y-axis, not the x-axis) seem markedly different for the two models?  Explain.\n    \n    \\clearpage\n\n1.  **Baby's weight, cross-validation to choose model.** \nUsing a random sample of 1,000 US births from 2014, we study the relationship between the weight of the baby and various explanatory variables. [@data:births14]\n\n    The plots below describe prediction errors associated with two different models designed to predict `weight` of baby at birth; one model uses 7 predictors, one model uses 2 predictors. Using 4-fold cross-validation, the data were split into 4 folds. Three of the folds estimate the $\\beta_i$ parameters using $b_i$, and the model is applied to the held out fold for prediction. The process was repeated 4 times (each time holding out one of the folds).\n\n    $$\n    \\begin{aligned}\n    E[\\texttt{weight}] = \\beta_0 &+ \\beta_1\\times \\texttt{fage} + \\beta_2\\times \\texttt{mage}\\\\\n    &+ \\beta_3 \\times \\texttt{mature} + \\beta_4 \\times \\texttt{weeks}\\\\\\\n    &+ \\beta_5 \\times \\texttt{visits}+ \\beta_6 \\times \\texttt{gained}\\\\\n    &+ \\beta_7 \\times \\texttt{habit}\\\\\n    \\end{aligned}\n    $$\n\n    $$\n    \\begin{aligned}\n    E[\\texttt{weight}] = \\beta_0 &+ \\beta_1\\times \\texttt{weeks} + \\beta_2\\times \\texttt{mature}\n    \\end{aligned}\n    $$\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](25-inf-model-mlr_files/figure-html/unnamed-chunk-38-1.png){width=90%}\n    :::\n    :::\n    \n    a. Using the spread of the points, which model should be chosen for a final report on these data?  Explain.\n    \n    b. Using the summary statistic (CV SSE), which model should be chosen for a final report on these data?  Explain.\n    \n    c. Why would the model with more predictors fit the data less closely than the model with only two predictors?\n    \n    \\clearpage\n\n1. **RailTrail, cross-validation.**\nThe Pioneer Valley Planning Commission (PVPC) collected data north of Chestnut Street in Florence, MA for ninety days from April 5, 2005 to November 15, 2005. Data collectors set up a laser sensor, with breaks in the laser beam recording when a rail-trail user passed the data collection station.^[The [`RailTrail`](https://rdrr.io/cran/mosaicData/man/RailTrail.html) data used in this exercise can be found in the [**mosaicData**](https://cran.r-project.org/web/packages/mosaicData/index.html) R package.]\n\n    The plots below describe prediction errors associated with two different models designed to predict the `volume` of riders on the RailTrail; one model uses 6 predictors, one model uses 2 predictors. Using 3-fold cross-validation, the data were split into 3 folds. Three of the folds estimate the $\\beta_i$ parameters using $b_i$, and the model is applied to the held out fold for prediction. The process was repeated 4 times (each time holding out one of the folds).\n\n    $$\n    \\begin{aligned}\n    E[\\texttt{volume}] = \\beta_0 &+ \\beta_1\\times \\texttt{hightemp} + \\beta_2\\times \\texttt{lowtemp}\\\\\n    &+ \\beta_3 \\times \\texttt{spring} + \\beta_4 \\times \\texttt{weekday}\\\\\\\n    &+ \\beta_5 \\times \\texttt{cloudcover}+ \\beta_6 \\times \\texttt{precip}\\\\\n    \\end{aligned}\n    $$\n    \n    $$\n    \\begin{aligned}\n    E[\\texttt{volume}] = \\beta_0 &+ \\beta_1\\times \\texttt{hightemp} + \\beta_2\\times \\texttt{precip}\n    \\end{aligned}\n    $$\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](25-inf-model-mlr_files/figure-html/unnamed-chunk-39-1.png){width=90%}\n    :::\n    :::\n    \n    a. In the second graph, note the point at roughly (predicted = 400 and error = 100). Estimate the observed and predicted value for that observation.\n     \n    b. Using the same point, describe which cross-validation fold(s) were used to build its prediction model.\n     \n    c. For the plot on the left, for one of the cross-validation folds, how many coefficients were estimated in the linear model? For the plot on the right, for one of the cross-validation folds, how many coefficients were estimated in the linear model? \n     \n    d. Do the values of the residuals (along the y-axis, not the x-axis) seem markedly different for the two models? Explain.\n    \n    \\clearpage\n\n1. **RailTrail, cross-validation to choose model.**\nThe Pioneer Valley Planning Commission (PVPC) collected data north of Chestnut Street in Florence, MA for ninety days from April 5, 2005 to November 15, 2005. Data collectors set up a laser sensor, with breaks in the laser beam recording when a rail-trail user passed the data collection station.\n\n    The plots below describe prediction errors associated with two different models designed to predict the `volume` of riders on the RailTrail; one model uses 6 predictors, one model uses 2 predictors. Using 3-fold cross-validation, the data were split into 3 folds. Three of the folds estimate the $\\beta_i$ parameters using $b_i$, and the model is applied to the held out fold for prediction. The process was repeated 4 times (each time holding out one of the folds).\n\n    $$\n    \\begin{aligned}\n    E[\\texttt{volume}] = \\beta_0 &+ \\beta_1\\times \\texttt{hightemp} + \\beta_2\\times \\texttt{lowtemp}\\\\\n    &+ \\beta_3 \\times \\texttt{spring} + \\beta_4 \\times \\texttt{weekday}\\\\\\\n    &+ \\beta_5 \\times \\texttt{cloudcover}+ \\beta_6 \\times \\texttt{precip}\\\\\n    \\end{aligned}\n    $$\n    \n    $$\n    \\begin{aligned}\n    E[\\texttt{volume}] = \\beta_0 &+ \\beta_1\\times \\texttt{hightemp} + \\beta_2\\times \\texttt{precip}\n    \\end{aligned}\n    $$\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](25-inf-model-mlr_files/figure-html/unnamed-chunk-40-1.png){width=90%}\n    :::\n    :::\n    \n    a. Using the spread of the points, which model should be chosen for a final report on these data?  Explain.\n    \n    b. Using the summary statistic (CV SSE), which model should be chosen for a final report on these data?  Explain.\n    \n    c. Why would the model with more predictors fit the data less closely than the model with only two predictors?\n\n\n:::\n",
    "supporting": [
      "25-inf-model-mlr_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n<link href=\"site_libs/bsTable-3.3.7/bootstrapTable.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/bsTable-3.3.7/bootstrapTable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}