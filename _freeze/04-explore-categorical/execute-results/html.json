{
  "hash": "dc2c194cfb13cce1e4c38a9df1624dec",
  "result": {
    "engine": "knitr",
    "markdown": "# Exploring categorical data {#sec-explore-categorical}\n\n\n\n\n\n::: {.chapterintro data-latex=\"\"}\nThis chapter focuses on exploring **categorical** data using summary statistics and visualizations.\nThe summaries and graphs presented in this chapter are created using statistical software; however, since this might be your first exposure to the concepts, we take our time in this chapter to detail how to create them.\nWhere possible, we present multivariate plots; plots that visualize the relationship between multiple variables.\nMastery of the content presented in this chapter will be crucial for understanding the methods and techniques introduced in the rest of the book.\n:::\n\nIn this chapter we will work with data on loans from Lending Club that you've previously seen in @sec-data-hello.\nThe `loan50` dataset from @sec-data-hello represents a sample from a larger loan dataset called `loans`.\nThis larger dataset contains information on 10,000 loans made through Lending Club.\nWe will examine the relationship between `homeownership`, which for the `loans` data can take a value of `rent`, `mortgage` (owns but has a mortgage), or `own`, and `app_type`, which indicates whether the loan application was made with a partner or whether it was an individual application.\n\n::: {.data data-latex=\"\"}\nThe [`loans_full_schema`](http://openintrostat.github.io/openintro/reference/loans_full_schema.html) data can be found in the [**openintro**](http://openintrostat.github.io/openintro) R package.\nBased on the data in this dataset we have modified the `homeownership` and `application_type` variables.\nWe will refer to this modified dataset as `loans`.\n:::\n\n## Contingency tables and bar plots\n\n\n::: {.cell}\n\n:::\n\n\n@tbl-loan-home-app-type-totals summarizes two variables: `application_type` and `homeownership`.\nA table that summarizes data for two categorical variables in this way is called a **contingency table**.\nEach value in the table represents the number of times a particular combination of variable outcomes occurred.\n\nFor example, the value 3496 corresponds to the number of loans in the dataset where the borrower rents their home and the application type was by an individual.\nRow and column totals are also included.\nThe **row totals** provide the total counts across each row and the **column totals** down each column.\nWe can also create a table that shows only the overall percentages or proportions for each combination of categories, or we can create a table for a single variable, such as the one shown in @tbl-loan-homeownership-totals for the `homeownership` variable.\n\n\n\n\n::: {#tbl-loan-home-app-type-totals .cell tbl-cap='A contingency table for application type and homeownership.'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">homeownership</div></th>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> application_type </th>\n   <th style=\"text-align:right;\"> rent </th>\n   <th style=\"text-align:right;\"> mortgage </th>\n   <th style=\"text-align:right;\"> own </th>\n   <th style=\"text-align:right;\"> Total </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 6em; \"> joint </td>\n   <td style=\"text-align:right;width: 6em; \"> 362 </td>\n   <td style=\"text-align:right;width: 6em; \"> 950 </td>\n   <td style=\"text-align:right;width: 6em; \"> 183 </td>\n   <td style=\"text-align:right;width: 6em; \"> 1495 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 6em; \"> individual </td>\n   <td style=\"text-align:right;width: 6em; \"> 3496 </td>\n   <td style=\"text-align:right;width: 6em; \"> 3839 </td>\n   <td style=\"text-align:right;width: 6em; \"> 1170 </td>\n   <td style=\"text-align:right;width: 6em; \"> 8505 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 6em; \"> Total </td>\n   <td style=\"text-align:right;width: 6em; \"> 3858 </td>\n   <td style=\"text-align:right;width: 6em; \"> 4789 </td>\n   <td style=\"text-align:right;width: 6em; \"> 1353 </td>\n   <td style=\"text-align:right;width: 6em; \"> 10000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {#tbl-loan-homeownership-totals .cell tbl-cap='A table summarizing the frequencies for each value of the homeownership variable -- mortgage, own, and rent.'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> homeownership </th>\n   <th style=\"text-align:right;\"> Count </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 10em; \"> rent </td>\n   <td style=\"text-align:right;width: 10em; \"> 3858 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 10em; \"> mortgage </td>\n   <td style=\"text-align:right;width: 10em; \"> 4789 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 10em; \"> own </td>\n   <td style=\"text-align:right;width: 10em; \"> 1353 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 10em; \"> Total </td>\n   <td style=\"text-align:right;width: 10em; \"> 10000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nA bar plot is a common way to display a single categorical variable.\nThe left panel of @fig-loan-homeownership-bar-plot shows a **bar plot** for the `homeownership` variable.\nIn the right panel, the counts are converted into proportions, showing the proportion of observations that are in each level.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Two bar plots: the left panel shows the counts, and the right panel shows the proportions of values of the homeownership variable.](04-explore-categorical_files/figure-html/fig-loan-homeownership-bar-plot-1.png){#fig-loan-homeownership-bar-plot width=90%}\n:::\n:::\n\n\n## Visualizing two categorical variables\n\n### Bar plots with two variables\n\nWe can display the distributions of two categorical variables on a bar plot concurrently.\nSuch plots are generally useful for visualizing the relationship between two categorical variables.\n@fig-loan-homeownership-app-type-bar-plot shows three such plots that visualize the relationship between `homeownership` and `application_type` variables.\nPlot A in @fig-loan-homeownership-app-type-bar-plot is a **stacked bar plot**.\nThis plot most clearly displays that loan applicants most commonly live in mortgaged homes.\nIt is difficult to say, based on this plot alone, how different application types vary across the levels of homeownership.\nPlot B is a **dodged bar plot**.\nThis plot most clearly displays that within each level of homeownership, individual applications are more common than joint applications.\nFinally, plot C is a **standardized bar plot** (also known as **filled bar plot**).\nThis plot most clearly displays that joint applications are most common among loans for applicants who live in mortgaged homes, compared to renters and owners.\nThis type of visualization is helpful in understanding the fraction of individual or joint loan applications for borrowers in each level of `homeownership`.\nAdditionally, since the proportions of joint and individual loans vary across the groups, we can conclude that the two variables are associated for this sample.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Three bar plots (stacked, dodged, and standardized) displaying homeownership and application type variables.](04-explore-categorical_files/figure-html/fig-loan-homeownership-app-type-bar-plot-1.png){#fig-loan-homeownership-app-type-bar-plot width=90%}\n:::\n:::\n\n\n::: {.workedexample data-latex=\"\"}\nExamine the three bar plots in @fig-loan-homeownership-app-type-bar-plot.\nWhen is the stacked, dodged, or standardized bar plot the most useful?\n\n------------------------------------------------------------------------\n\nThe stacked bar plot is most useful when it's reasonable to assign one variable as the explanatory variable (here `homeownership`) and the other variable as the response (here `application_type`) since we are effectively grouping by one variable first and then breaking it down by the others.\n\nDodged bar plots are more agnostic in their display about which variable, if any, represents the explanatory and which the response variable.\nIt is also easy to discern the number of cases in each of the six different group combinations.\nHowever, one downside is that it tends to require more horizontal space; the narrowness of Plot B compared to the other two in @fig-loan-homeownership-app-type-bar-plot makes the plot feel a bit cramped.\nAdditionally, when two groups are of very different sizes, as we see in the group `own` relative to either of the other two groups, it is difficult to discern if there is an association between the variables.\n\nThe standardized stacked bar plot is helpful if the primary variable in the stacked bar plot is relatively imbalanced, e.g., the category has only a third of the observations in the category, making the simple stacked bar plot less useful for checking for an association.\nThe major downside of the standardized version is that we lose all sense of how many cases each of the bars represents.\n:::\n\n### Mosaic plots\n\nA **mosaic plot** is a visualization technique suitable for contingency tables that resembles a standardized stacked bar plot with the benefit that we still see the relative group sizes of the primary variable as well.\n\n\n\n\n\nTo get started in creating our first mosaic plot, we'll break a square into columns for each category of the variable, with the result shown in Plot A of @fig-loan-homeownership-type-mosaic-plot.\nEach column represents a level of `homeownership`, and the column widths correspond to the proportion of loans in each of those categories.\nFor instance, there are fewer loans where the borrower is an owner than where the borrower has a mortgage.\nIn general, mosaic plots use box *areas* to represent the number of cases in each category.\n\nPlot B in @fig-loan-homeownership-type-mosaic-plot displays the relationship between homeownership and application type.\nEach column is split proportionally to the number of loans from individual and joint borrowers.\nFor example, the second column represents loans where the borrower has a mortgage, and it was divided into individual loans (upper) and joint loans (lower).\nAs another example, the bottom segment of the third column represents loans where the borrower owns their home and applied jointly, while the upper segment of this column represents borrowers who are homeowners and filed individually.\nWe can again use this plot to see that the `homeownership` and `application_type` variables are associated, since some columns are divided in different vertical locations than others, which was the same technique used for checking an association in the standardized stacked bar plot.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![The mosaic plots: one for homeownership alone and the other displaying the relationship between homeownership and application type.](04-explore-categorical_files/figure-html/fig-loan-homeownership-type-mosaic-plot-1.png){#fig-loan-homeownership-type-mosaic-plot width=90%}\n:::\n:::\n\n\nIn @fig-loan-homeownership-type-mosaic-plot, we chose to first split by the homeowner status of the borrower.\nHowever, we could have instead first split by the application type, as in @fig-loan-app-type-mosaic-plot.\nLike with the bar plots, it's common to use the explanatory variable to represent the first split in a mosaic plot, and then for the response to break up each level of the explanatory variable if these labels are reasonable to attach to the variables under consideration.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Mosaic plot where loans are grouped by homeownership after they have been divided into individual and joint application types.](04-explore-categorical_files/figure-html/fig-loan-app-type-mosaic-plot-1.png){#fig-loan-app-type-mosaic-plot width=90%}\n:::\n:::\n\n\n## Row and column proportions\n\nIn the previous sections we inspected visualizations of two categorical variables in bar plots and mosaic plots.\nHowever, we have not discussed how the values in the bar and mosaic plots that show proportions are calculated.\nIn this section we will investigate fractional breakdown of one variable in another and we can modify our contingency table to provide such a view.\n@tbl-loan-home-app-type-row-proportions shows **row proportions** for @tbl-loan-home-app-type-totals, which are computed as the counts divided by their row totals.\nThe value 3496 at the intersection of individual and rent is replaced by $3496 / 8505 = 0.411,$ i.e., 3496 divided by its row total, 8505.\nSo, what does 0.411 represent?\nIt corresponds to the proportion of individual applicants who rent.\n\n\n::: {#tbl-loan-home-app-type-row-proportions .cell tbl-cap='A contingency table with row proportions for the application type and\nhomeownership variables.'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">homeownership</div></th>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> application_type </th>\n   <th style=\"text-align:right;\"> rent </th>\n   <th style=\"text-align:right;\"> mortgage </th>\n   <th style=\"text-align:right;\"> own </th>\n   <th style=\"text-align:right;\"> Total </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 6em; \"> joint </td>\n   <td style=\"text-align:right;width: 6em; \"> 0.242 </td>\n   <td style=\"text-align:right;width: 6em; \"> 0.635 </td>\n   <td style=\"text-align:right;width: 6em; \"> 0.122 </td>\n   <td style=\"text-align:right;width: 6em; \"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 6em; \"> individual </td>\n   <td style=\"text-align:right;width: 6em; \"> 0.411 </td>\n   <td style=\"text-align:right;width: 6em; \"> 0.451 </td>\n   <td style=\"text-align:right;width: 6em; \"> 0.138 </td>\n   <td style=\"text-align:right;width: 6em; \"> 1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nA contingency table of the **column proportions** is computed in a similar way, where each is computed as the count divided by the corresponding column total.\n@tbl-loan-home-app-type-column-proportions shows such a table, and here the value 0.906 indicates that 90.6% of renters applied as individuals for the loan.\nThis rate is higher compared to loans from people with mortgages (80.2%) or who own their home (86.5%).\nBecause these rates vary between the three levels of `homeownership` (`rent`, `mortgage`, `own`), this provides evidence that `app_type` and `homeownership` variables may be associated.\n\n\n::: {#tbl-loan-home-app-type-column-proportions .cell tbl-cap='A contingency table with column proportions for the application type and homeownership variables.'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">homeownership</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> application_type </th>\n   <th style=\"text-align:right;\"> rent </th>\n   <th style=\"text-align:right;\"> mortgage </th>\n   <th style=\"text-align:right;\"> own </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 8em; \"> joint </td>\n   <td style=\"text-align:right;width: 8em; \"> 0.094 </td>\n   <td style=\"text-align:right;width: 8em; \"> 0.198 </td>\n   <td style=\"text-align:right;width: 8em; \"> 0.135 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 8em; \"> individual </td>\n   <td style=\"text-align:right;width: 8em; \"> 0.906 </td>\n   <td style=\"text-align:right;width: 8em; \"> 0.802 </td>\n   <td style=\"text-align:right;width: 8em; \"> 0.865 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 8em; \"> Total </td>\n   <td style=\"text-align:right;width: 8em; \"> 1.000 </td>\n   <td style=\"text-align:right;width: 8em; \"> 1.000 </td>\n   <td style=\"text-align:right;width: 8em; \"> 1.000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nRow and column proportions can also be thought of as **conditional proportions** as they tell us about the proportion of observations in a given level of a categorical variable conditional on the level of another categorical variable.\n\n\n\n\n\nWe could also have checked for an association between `application_type` and `homeownership` in @tbl-loan-home-app-type-row-proportions using row proportions.\nWhen comparing these row proportions, we would look down columns to see if the fraction of loans where the borrower rents, has a mortgage, or owns varied across the application types.\n\n::: {.guidedpractice data-latex=\"\"}\nWhat does 0.451 represent in @tbl-loan-home-app-type-row-proportions?\nWhat does 0.802 represent in @tbl-loan-home-app-type-column-proportions?[^04-explore-categorical-1]\n:::\n\n[^04-explore-categorical-1]: 0.451 represents the proportion of individual applicants who have a mortgage.\n    0.802 represents the fraction of applicants with mortgages who applied as individuals.\n\n::: {.guidedpractice data-latex=\"\"}\nWhat does 0.122 represent in @tbl-loan-home-app-type-row-proportions?\nWhat does 0.135 represent in @tbl-loan-home-app-type-column-proportions?[^04-explore-categorical-2]\n:::\n\n[^04-explore-categorical-2]: 0.122 represents the fraction of joint borrowers who own their home.\n    0.135 represents the home-owning borrowers who had a joint application for the loan.\n\n::: {.workedexample data-latex=\"\"}\nData scientists use statistics to build email spam filters.\nBy noting specific characteristics of an email, a data scientist may be able to classify some emails as spam or not spam with high accuracy.\nOne such characteristic is whether the email contains no numbers, small numbers, or big numbers.\nAnother characteristic is the email format, which indicates whether an email has any HTML content, such as bolded text.\nWe'll focus on email format and spam status using the dataset; these variables are summarized in a contingency table in @tbl-email-count-table.\nWhich would be more helpful to someone hoping to classify email as spam or regular email for this table: row or column proportions?\n\n------------------------------------------------------------------------\n\nA data scientist would be interested in how the proportion of spam changes within each email format.\nThis corresponds to column proportions: the proportion of spam in plain text emails and the proportion of spam in HTML emails.\n\nIf we generate the column proportions, we can see that a higher fraction of plain text emails are spam ($209/1195 = 17.5\\%$) than compared to HTML emails ($158/2726 = 5.8\\%$).\nThis information on its own is insufficient to classify an email as spam or not spam, as over 80% of plain text emails are not spam.\nYet, when we carefully combine this information with many other characteristics, we stand a reasonable chance of being able to classify some emails as spam or not spam with confidence.\nThis example points out that row and column proportions are not equivalent.\nBefore settling on one form for a table, it is important to consider each to ensure that the most useful table is constructed.\nHowever, sometimes it simply isn't clear which, if either, is more useful.\n:::\n\n::: {.data data-latex=\"\"}\nThe [email](http://openintrostat.github.io/openintro/reference/email.html) data can be found in the [**openintro**](http://openintrostat.github.io/openintro) R package.\n:::\n\n\n::: {#tbl-email-count-table .cell tbl-cap='A contingency table for spam and format.'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> spam </th>\n   <th style=\"text-align:right;\"> HTML </th>\n   <th style=\"text-align:right;\"> text </th>\n   <th style=\"text-align:right;\"> Total </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> not spam </td>\n   <td style=\"text-align:right;\"> 2568 </td>\n   <td style=\"text-align:right;\"> 986 </td>\n   <td style=\"text-align:right;\"> 3554 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> spam </td>\n   <td style=\"text-align:right;\"> 158 </td>\n   <td style=\"text-align:right;\"> 209 </td>\n   <td style=\"text-align:right;\"> 367 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Total </td>\n   <td style=\"text-align:right;\"> 2726 </td>\n   <td style=\"text-align:right;\"> 1195 </td>\n   <td style=\"text-align:right;\"> 3921 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.workedexample data-latex=\"\"}\nLook back to @tbl-loan-home-app-type-row-proportions and @tbl-loan-home-app-type-column-proportions.\nAre there any obvious scenarios where one might be more useful than the other?\n\n------------------------------------------------------------------------\n\nNone that we think are obvious!\nWhat is distinct about the email example is that the two loan variables do not have a clear explanatory-response variable relationship that we might hypothesize.\nUsually it is most useful to \"condition\" on the explanatory variable.\nFor instance, in the email example, the email format was seen as a possible explanatory variable of whether the message was spam, so we would find it more interesting to compute the relative frequencies (proportions) for each email format.\n:::\n\n## Pie charts\n\nA **pie chart** is shown in @fig-loan-homeownership-pie-chart alongside a bar plot representing the same information.\nPie charts can be useful for giving a high-level overview to show how a set of cases break down.\nHowever, it is also difficult to decipher certain details in a pie chart.\nFor example, it's not immediately obvious that there are more loans where the borrower has a mortgage than rent when looking at the pie chart, while this detail is very obvious in the bar plot.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![A pie chart and bar plot of homeownership.](04-explore-categorical_files/figure-html/fig-loan-homeownership-pie-chart-1.png){#fig-loan-homeownership-pie-chart width=90%}\n:::\n:::\n\n\nPie charts can work well when the goal is to visualize a categorical variable with very few levels, and especially if each level represents a simple fraction (e.g., one-half, one-quarter, etc.).\nHowever, they can be quite difficult to read when they are used to visualize a categorical variable with many levels.\nFor example, the pie chart and the bar plot in @fig-loan-grade-pie-chart both represent the distribution of loan grades (A through G).\nIn this case, it is far easier to compare the counts of each loan grade using the bar plot than the pie chart.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![A pie chart and bar plot of loan grades.](04-explore-categorical_files/figure-html/fig-loan-grade-pie-chart-1.png){#fig-loan-grade-pie-chart width=90%}\n:::\n:::\n\n\n## Waffle charts\n\nAnother useful technique of visualizing categorical data is a **waffle chart**.\nWaffle charts can be used to communicate the proportion of the data that falls into each level of a categorical variable.\nJust like with pie charts, they work best when the number of levels represented is low.\nHowever, unlike pie charts, they can make it easier to compare proportions that represent non-simple fractions.\n@fig-loan-waffle displays two examples of waffle charts: one for the distribution of homeownership and the other for the distribution of loan status.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Plot A: Waffle chart of homeownership, with levels rent, mortgage, and own. Plot B: Waffle chart of loan status, with levels current, fully paid, in grade period, and late.](04-explore-categorical_files/figure-html/fig-loan-waffle-1.png){#fig-loan-waffle width=90%}\n:::\n:::\n\n\n## Comparing numerical data across groups\n\nSome of the more interesting investigations can be considered by examining numerical data across groups.\nIn this section we will expand on a few methods we have already seen to make plots for numerical data from multiple groups on the same graph as well as introduce a few new methods for comparing numerical data across groups.\n\nWe will revisit the `county` dataset and compare the median household income for counties that gained population from 2010 to 2017 versus counties that had no gain.\nWhile we might like to make a causal connection between income and population growth, remember that these are observational data and so such an interpretation would be, at best, half-baked.\n\n\n::: {.cell}\n\n:::\n\n\nWe have data on 3142 counties in the United States.\nWe are missing 2017 population data from 3 of them, and of the remaining 3139 counties, in 1541 the population increased from 2010 to 2017 and in the remaining 1598 the population decreased.\n@tbl-countyIncomeSplitByPopGainTable shows a sample of 5 observations from each group.\n\n\n::: {#tbl-countyIncomeSplitByPopGainTable .cell tbl-cap='The median household income from a random sample of 5 counties with population gain between 2010 to 2017 and another random sample of 5 counties with no population gain.'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> State </th>\n   <th style=\"text-align:left;\"> County </th>\n   <th style=\"text-align:center;\"> Population change (%) </th>\n   <th style=\"text-align:center;\"> Gain / No gain </th>\n   <th style=\"text-align:center;\"> Median household income </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Arkansas </td>\n   <td style=\"text-align:left;\"> Izard County </td>\n   <td style=\"text-align:center;width: 8em; \"> 2.13 </td>\n   <td style=\"text-align:center;width: 4em; \"> gain </td>\n   <td style=\"text-align:center;width: 8em; \"> 39135 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Georgia </td>\n   <td style=\"text-align:left;\"> Jackson County </td>\n   <td style=\"text-align:center;width: 8em; \"> 10.17 </td>\n   <td style=\"text-align:center;width: 4em; \"> gain </td>\n   <td style=\"text-align:center;width: 8em; \"> 57999 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oregon </td>\n   <td style=\"text-align:left;\"> Hood River County </td>\n   <td style=\"text-align:center;width: 8em; \"> 3.41 </td>\n   <td style=\"text-align:center;width: 4em; \"> gain </td>\n   <td style=\"text-align:center;width: 8em; \"> 57269 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Texas </td>\n   <td style=\"text-align:left;\"> Montague County </td>\n   <td style=\"text-align:center;width: 8em; \"> 0.75 </td>\n   <td style=\"text-align:center;width: 4em; \"> gain </td>\n   <td style=\"text-align:center;width: 8em; \"> 46592 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Virginia </td>\n   <td style=\"text-align:left;\"> Appomattox County </td>\n   <td style=\"text-align:center;width: 8em; \"> 2.38 </td>\n   <td style=\"text-align:center;width: 4em; \"> gain </td>\n   <td style=\"text-align:center;width: 8em; \"> 54875 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Kentucky </td>\n   <td style=\"text-align:left;\"> Ballard County </td>\n   <td style=\"text-align:center;width: 8em; \"> -2.62 </td>\n   <td style=\"text-align:center;width: 4em; \"> no gain </td>\n   <td style=\"text-align:center;width: 8em; \"> 42988 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Kentucky </td>\n   <td style=\"text-align:left;\"> Fleming County </td>\n   <td style=\"text-align:center;width: 8em; \"> -0.71 </td>\n   <td style=\"text-align:center;width: 4em; \"> no gain </td>\n   <td style=\"text-align:center;width: 8em; \"> 41095 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Kentucky </td>\n   <td style=\"text-align:left;\"> Letcher County </td>\n   <td style=\"text-align:center;width: 8em; \"> -5.13 </td>\n   <td style=\"text-align:center;width: 4em; \"> no gain </td>\n   <td style=\"text-align:center;width: 8em; \"> 30293 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Maine </td>\n   <td style=\"text-align:left;\"> Penobscot County </td>\n   <td style=\"text-align:center;width: 8em; \"> -0.73 </td>\n   <td style=\"text-align:center;width: 4em; \"> no gain </td>\n   <td style=\"text-align:center;width: 8em; \"> 47886 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Virginia </td>\n   <td style=\"text-align:left;\"> Richmond County </td>\n   <td style=\"text-align:center;width: 8em; \"> -0.19 </td>\n   <td style=\"text-align:center;width: 4em; \"> no gain </td>\n   <td style=\"text-align:center;width: 8em; \"> 47341 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nColor can be used to split histograms (see @sec-histograms for an introduction to histograms) for numerical variables by levels of a categorical variable.\nAn example of this is shown in Plot A of @fig-countyIncomeSplitByPopGain.\nThe **side-by-side box plot** is another traditional tool for comparing across groups.\nAn example is shown in Plot B of @fig-countyIncomeSplitByPopGain, where there are two box plots (see @sec-boxplots for an introduction to box plots), one for each group, placed into one plotting window and drawn on the same scale.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Histograms (Plot A) and side by-side box plots (Plot B) for median household income, where counties are split by whether there was a population gain or not.](04-explore-categorical_files/figure-html/fig-countyIncomeSplitByPopGain-1.png){#fig-countyIncomeSplitByPopGain width=90%}\n:::\n:::\n\n\n::: {.guidedpractice data-latex=\"\"}\nUse the plots in @fig-countyIncomeSplitByPopGain to compare the incomes for counties across the two groups.\nWhat do you notice about the approximate center of each group?\nWhat do you notice about the variability between groups?\nIs the shape relatively consistent between groups?\nHow many *prominent* modes are there for each group?[^04-explore-categorical-3]\n:::\n\n[^04-explore-categorical-3]: Answers may vary a little.\n    The counties with population gains tend to have higher income (median of about \\$45,000) versus counties without a gain (median of about \\$40,000).\n    The variability is also slightly larger for the population gain group.\n    This is evident in the IQR, which is about 50% bigger in the *gain* group.\n    Both distributions show slight to moderate right skew and are unimodal.\n    The box plots indicate there are many observations far above the median in each group, though we should anticipate that many observations will fall beyond the whiskers when examining any dataset that contain more than a few hundred data points.\n\n::: {.guidedpractice data-latex=\"\"}\nWhat components of each plot in @fig-countyIncomeSplitByPopGain do you find most useful?[^04-explore-categorical-4]\n:::\n\n[^04-explore-categorical-4]: Answers will vary.\n    The side-by-side box plots are especially useful for comparing centers and spreads, while the hollow histograms are more useful for seeing distribution shape, skew, modes, and potential anomalies.\n\nAnother useful visualization for comparing numerical data across groups is a **ridge plot**, which combines density plots (see @sec-boxplots for an introduction to density plots) for various groups drawn on the same scale in a single plotting window.\n@fig-countyIncomeSplitByPopGainRidge displays a ridge plot for the distribution of median household income in counties, split by whether there was a population gain or not.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Ridge plot for median household income, where counties are split by whether there was a population gain or not.](04-explore-categorical_files/figure-html/fig-countyIncomeSplitByPopGainRidge-1.png){#fig-countyIncomeSplitByPopGainRidge width=90%}\n:::\n:::\n\n\n::: {.guidedpractice data-latex=\"\"}\nWhat components of the ridge plot in @fig-countyIncomeSplitByPopGainRidge do you find most useful compared to those in @fig-countyIncomeSplitByPopGain?[^04-explore-categorical-5]\n:::\n\n[^04-explore-categorical-5]: The ridge plot give us a better sense of the shape, and especially modality, of the data.\n\nOne last visualization technique we'll highlight for comparing numerical data across groups is **faceting**.\nIn this technique we split (facet) the graphical display of the data across plotting windows based on groups.\nPlot A in @fig-countyIncomeSplitByPopGainFacetHist displays the same information as Plot A in @fig-countyIncomeSplitByPopGain, however here the distributions of median household income for counties with and without population gain are faceted across two plotting windows.\nWe preserve the same scale on the x and y axes for easier comparison.\nAn advantage of this approach is that it extends to splitting the data across levels of two categorical variables, which allows for displaying relationships between three variables.\nIn Plot B in @fig-countyIncomeSplitByPopGainFacetHist we have now split the data into four groups using the `pop_change` and `metro` variables:\n\n-   top left represents counties that are *not* in a `metro`politan area with population gain,\n-   top right represents counties that are in a metropolitan area with population gain,\n-   bottom left represents counties that are *not* in a metropolitan area without population gain, and finally\n-   bottom right represents counties that are in a metropolitan area without population gain.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Distribution of median income in counties using faceted histograms: Plot A facets by whether there was a population gain or not and Plot B facets by both population gain and whether the county is in a metropolitan area.](04-explore-categorical_files/figure-html/fig-countyIncomeSplitByPopGainFacetHist-1.png){#fig-countyIncomeSplitByPopGainFacetHist width=100%}\n:::\n:::\n\n\nWe can continue building upon this visualization to add one more variable, `median_edu`, which is the median education level in the county.\nIn @fig-countyIncomeRidgeMulti, we represent median education level using color, where pink (solid line) represents counties where the median education level is high school diploma, yellow (dashed line) is some college degree, and red (dotted line) is Bachelor's.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Distribution of median income in counties using a ridge plot, faceted by whether the county had a population gain or not as well as whether the county is in a metropolitan area and colored by the median education level in the county.](04-explore-categorical_files/figure-html/fig-countyIncomeRidgeMulti-1.png){#fig-countyIncomeRidgeMulti width=100%}\n:::\n:::\n\n\n::: {.guidedpractice data-latex=\"\"}\nBased on @fig-countyIncomeRidgeMulti, what can you say about how median household income in counties vary depending on population gain/no gain, metropolitan area/not, and median degree?[^04-explore-categorical-6]\n:::\n\n[^04-explore-categorical-6]: Regardless of the location (metropolitan or not) or change in population, it seems like there is an increase in median household income from individuals with only a HS diploma, to individuals with some college, to individuals with a Bachelor's degree.\n\n\\vspace{20mm}\n\n## Chapter review {#sec-chp4-review}\n\n### Summary\n\nFluently working with categorical variables is an important skill for data analysts.\nIn this chapter we have introduced different visualizations and numerical summaries applied to categorical variables.\nThe graphical visualizations are even more descriptive when two variables are presented simultaneously.\nWe presented bar plots, mosaic plots, pie charts, and estimations of conditional proportions.\n\n### Terms\n\nWe introduced the following terms in the chapter.\nIf you're not sure what some of these terms mean, we recommend you go back in the text and review their definitions.\nWe are purposefully presenting them in alphabetical order, instead of in order of appearance, so they will be a little more challenging to locate.\nHowever, you should be able to easily spot them as **bolded text**.\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> column proportions </td>\n   <td style=\"text-align:left;\"> faceted plot </td>\n   <td style=\"text-align:left;\"> row totals </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> column totals </td>\n   <td style=\"text-align:left;\"> filled bar plot </td>\n   <td style=\"text-align:left;\"> side-by-side box plot </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> conditional proportions </td>\n   <td style=\"text-align:left;\"> mosaic plot </td>\n   <td style=\"text-align:left;\"> stacked bar plot </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> contingency table </td>\n   <td style=\"text-align:left;\"> ridge plot </td>\n   <td style=\"text-align:left;\"> standardized bar plot </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> dodged bar plot </td>\n   <td style=\"text-align:left;\"> row proportions </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\\clearpage\n\n## Exercises {#sec-chp4-exercises}\n\nAnswers to odd-numbered exercises can be found in [Appendix -@sec-exercise-solutions-04].\n\n::: {.exercises data-latex=\"\"}\n1.  **Antibiotic use in children.** The bar plot and the pie chart below show the distribution of pre-existing medical conditions of children involved in a study on the optimal duration of antibiotic use in treatment of tracheitis, which is an upper respiratory infection.[^_04-ex-explore-categorical-1]\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](04-explore-categorical_files/figure-html/unnamed-chunk-29-1.png){width=100%}\n    :::\n    :::\n\n    a.  What features are apparent in the bar plot but not in the pie chart?\n\n    b.  What features are apparent in the pie chart but not in the bar plot?\n\n    c.  Which graph would you prefer to use for displaying these categorical data?\n\n2.  **Views on immigration.** Nine-hundred and ten (910) randomly sampled registered voters from Tampa, FL were asked if they thought workers who have illegally entered the US should be (i) allowed to keep their jobs and apply for US citizenship, (ii) allowed to keep their jobs as temporary guest workers but not allowed to apply for US citizenship, or (iii) lose their jobs and have to leave the country.\n    The results of the survey by political ideology are shown below.[^_04-ex-explore-categorical-2]\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> Response </th>\n       <th style=\"text-align:right;\"> Conservative </th>\n       <th style=\"text-align:right;\"> Liberal </th>\n       <th style=\"text-align:right;\"> Moderate </th>\n       <th style=\"text-align:right;\"> Total </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;\"> Apply for citizenship </td>\n       <td style=\"text-align:right;\"> 57 </td>\n       <td style=\"text-align:right;\"> 101 </td>\n       <td style=\"text-align:right;\"> 120 </td>\n       <td style=\"text-align:right;\"> 278 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;\"> Guest worker </td>\n       <td style=\"text-align:right;\"> 121 </td>\n       <td style=\"text-align:right;\"> 28 </td>\n       <td style=\"text-align:right;\"> 113 </td>\n       <td style=\"text-align:right;\"> 262 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;\"> Leave the country </td>\n       <td style=\"text-align:right;\"> 179 </td>\n       <td style=\"text-align:right;\"> 45 </td>\n       <td style=\"text-align:right;\"> 126 </td>\n       <td style=\"text-align:right;\"> 350 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;\"> Not sure </td>\n       <td style=\"text-align:right;\"> 15 </td>\n       <td style=\"text-align:right;\"> 1 </td>\n       <td style=\"text-align:right;\"> 4 </td>\n       <td style=\"text-align:right;\"> 20 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;\"> Total </td>\n       <td style=\"text-align:right;\"> 372 </td>\n       <td style=\"text-align:right;\"> 175 </td>\n       <td style=\"text-align:right;\"> 363 </td>\n       <td style=\"text-align:right;\"> 910 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n    a.  What percent of these Tampa, FL voters identify themselves as conservatives?\n\n    b.  What percent of these Tampa, FL voters are in favor of the citizenship option?\n\n    c.  What percent of these Tampa, FL voters identify themselves as conservatives and are in favor of the citizenship option?\n\n    d.  What percent of these Tampa, FL voters who identify themselves as conservatives are also in favor of the citizenship option?\n        What percent of moderates share this view?\n        What percent of liberals share this view?\n\n    e.  Do political ideology and views on immigration appear to be associated?\n        Explain your reasoning.\n\n    f.  Conjecture other possible variables that might explain the potential relationship between these two variables.\n\n    \\clearpage\n\n3.  **Black Lives Matter.** A Washington Post-Schar School poll conducted in the United States in June 2020, among a random national sample of 1,006 adults, asked respondents whether they support or oppose protests following George Floyd's killing that have taken place in cities across the US.\n    The survey also collected information on the age of the respondents.\n    [@survey:blmWaPoScar:2020] The results are summarized in the stacked bar plot below.\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](04-explore-categorical_files/figure-html/unnamed-chunk-31-1.png){width=90%}\n    :::\n    :::\n\n    a.  Based on the stacked bar plot, do views on the protests and age appear to be associated?\n        Explain your reasoning.\n\n    b.  Conjecture other possible variables that might explain the potential association between these two variables.\n\n4.  **Raise taxes.** A random sample of registered voters nationally were asked whether they think it's better to raise taxes on the rich or raise taxes on the poor.\n    The survey also collected information on the political party affiliation of the respondents.\n    [@survey:raiseTaxes:2015]\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](04-explore-categorical_files/figure-html/unnamed-chunk-32-1.png){width=90%}\n    :::\n    :::\n\n    a.  Based on the stacked bar plot shown above, do views on raising taxes and political affiliation appear to be associated?\n        Explain your reasoning.\n\n    b.  Conjecture other possible variables that might explain the potential association between these two variables.\n\n    \\clearpage\n\n5.  **Heart transplant data display.** The Stanford University Heart Transplant Study was conducted to determine whether an experimental heart transplant program increased lifespan.\n    Each patient entering the program was officially designated a heart transplant candidate, meaning that he was gravely ill and might benefit from a new heart.\n    Patients were randomly assigned into treatment and control groups.\n    Patients in the treatment group received a transplant, and those in the control group did not.\n    The visualization below displays two different versions of the data.[^_04-ex-explore-categorical-3]\n    [@Turnbull+Brown+Hu:1974]\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](04-explore-categorical_files/figure-html/unnamed-chunk-33-1.png){width=90%}\n    :::\n    :::\n\n    a.  Provide one aspect of the two-group comparison that is easier to see from the stacked bar plot (left)?\n\n    b.  Provide one aspect of the two-group comparison that is easier to see from the standardized bar plot (right)?\n\n    c.  For the Heart Transplant Study which of those aspects would be more important to display?\n        That is, which bar plot would be better as a data visualization?\n\n6.  **Shipping holiday gifts data display.** A local news survey asked 500 randomly sampled Los Angeles residents which shipping carrier they prefer to use for shipping holiday gifts.\n    The table below shows the distribution of responses by age group as well as the expected counts for each cell (shown in italics).\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](04-explore-categorical_files/figure-html/unnamed-chunk-34-1.png){width=90%}\n    :::\n    :::\n\n    a.  Which graph (top or bottom) would you use to understand the shipping choices of people of different ages?\n\n    b.  Which graph (top or bottom) would you use to understand the age distribution across different types of shipping choices?\n\n    c.  A new shipping company would like to market to people over the age of 55.\n        Who will be their biggest competitor?\n\n    d.  FedEx would like to reach out to grow their market share to balance the age demographics of FedEx users.\n        To what age group should FedEx market?\n\n[^_04-ex-explore-categorical-1]: The [`antibiotics`](http://openintrostat.github.io/openintro/reference/antibiotics.html) data used in this exercise can be found in the [**openintro**](http://openintrostat.github.io/openintro) R package.\n\n[^_04-ex-explore-categorical-2]: The [`immigration`](http://openintrostat.github.io/openintro/reference/immigration.html) data used in this exercise can be found in the [**openintro**](http://openintrostat.github.io/openintro) R package.\n\n[^_04-ex-explore-categorical-3]: The [`heart_transplant`](http://openintrostat.github.io/openintro/reference/heart_transplant.html) data used in this exercise can be found in the [**openintro**](http://openintrostat.github.io/openintro) R package.\n\n\n:::\n",
    "supporting": [
      "04-explore-categorical_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n<link href=\"site_libs/bsTable-3.3.7/bootstrapTable.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/bsTable-3.3.7/bootstrapTable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}