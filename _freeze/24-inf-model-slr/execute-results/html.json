{
  "hash": "637574392f3babc38df6623430f8cdc6",
  "result": {
    "engine": "knitr",
    "markdown": "# Inference for linear regression with a single predictor {#sec-inf-model-slr}\n\n\n\n\n\n\n\n\n\n\\chaptermark{Inference for regression with a single predictor}\n\n::: {.chapterintro data-latex=\"\"}\nWe now bring together ideas of inferential analyses with the descriptive models seen in [Chapter -@sec-model-slr].\nIn particular, we will use the least squares regression line to test whether there is a relationship between two continuous variables.\nAdditionally, we will build confidence intervals which quantify the slope of the linear regression line.\nThe setting is now focused on predicting a numeric response variable (for linear models) or a binary response variable (for logistic models), we continue to ask questions about the variability of the model from sample to sample.\nThe sampling variability will inform the conclusions about the population that can be drawn.\n\nMany of the inferential ideas are remarkably similar to those covered in previous chapters.\nThe technical conditions for linear models are typically assessed graphically, although independence of observations continues to be of utmost importance.\n\nWe encourage the reader to think broadly about the models at hand without putting too much dependence on the exact p-values that are reported from the statistical software.\nInference on models with multiple explanatory variables can suffer from data snooping which result in false positive claims.\nWe provide some guidance and hope the reader will further their statistical learning after working through the material in this text.\n:::\n\n\n\n\n\n\n\n\n\n## Case study: Sandwich store\n\n### Observed data\n\nWe start the chapter with a hypothetical example describing the linear relationship between dollars spent advertising for a chain sandwich restaurant and monthly revenue.\nThe hypothetical example serves the purpose of illustrating how a linear model varies from sample to sample.\nBecause we have made up the example and the data (and the entire population), we can take many many samples from the population to visualize the variability.\nNote that in real life, we always have exactly one sample (that is, one dataset), and through the inference process, we imagine what might have happened had we taken a different sample.\nThe change from sample to sample leads to an understanding of how the single observed dataset is different from the population of values, which is typically the fundamental goal of inference.\n\nConsider the following hypothetical population of all of the sandwich stores of a particular chain seen in @fig-sandpop.\nIn this made-up world, the CEO actually has all the relevant data, which is why they can plot it here.\nThe CEO is omniscient and can write down the population model which describes the true population relationship between the advertising dollars and revenue.\nThere appears to be a linear relationship between advertising dollars and revenue (both in \\$1,000).\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Revenue as a linear model of advertising dollars for a population of sandwich\nstores, in thousands of dollars.\n](24-inf-model-slr_files/figure-html/fig-sandpop-1.png){#fig-sandpop fig-alt='Scatterplot with advertising amount on the x-axis and revenue on the y-axis.\nA linear model is superimposed. The points show a reasonably strong and\npositive linear trend.' width=90%}\n:::\n:::\n\n\n\n\nYou may remember from @sec-model-slr that the population model is: $$y = \\beta_0 + \\beta_1 x + \\varepsilon.$$\n\nAgain, the omniscient CEO (with the full population information) can write down the true population model as: $$\\texttt{expected revenue} = 11.23 + 4.8 \\times \\texttt{advertising}.$$\n\n### Variability of the statistic\n\nUnfortunately, in our scenario, the CEO is not willing to part with the full set of data, but they will allow potential franchise buyers to see a small sample of the data in order to help the potential buyer decide whether set up a new franchise.\nThe CEO is willing to give each potential franchise buyer a random sample of data from 20 stores.\n\nAs with any numerical characteristic which describes a subset of the population, the estimated slope of a sample will vary from sample to sample.\nConsider the linear model which describes revenue (in \\$1,000) based on advertising dollars (in \\$1,000).\n\nThe least squares regression model uses the data to find a sample linear fit: $$\\hat{y} = b_0 + b_1 x.$$\n\nTwo random samples of 20 stores shows different least squares regression lines in @fig-sand-samp-1 and @fig-sand-samp-2, depending on which observations are selected.\nBoth trends are similar to those seen in @fig-sandpop, which describes the population.\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {#fig-sand-samp .cell layout-ncol=\"2\"}\n::: {.cell-output-display}\n![First sample.](24-inf-model-slr_files/figure-html/fig-sand-samp-1.png){#fig-sand-samp-1 fig-alt='For two random samples of 20 stores, scatterplots with advertising amount on\nthe x-axis and revenue on the y-axis. Linear models are superimposed.\nThe points in each plot show reasonably strong and positive linear trends.\n' width=100%}\n:::\n\n::: {.cell-output-display}\n![Second sample.](24-inf-model-slr_files/figure-html/fig-sand-samp-2.png){#fig-sand-samp-2 fig-alt='For two random samples of 20 stores, scatterplots with advertising amount on\nthe x-axis and revenue on the y-axis. Linear models are superimposed.\nThe points in each plot show reasonably strong and positive linear trends.\n' width=100%}\n:::\n\nTwo random samples of 20 stores from the entire population. A linear\ntrend between advertising and revenue is observed in both.\n\n:::\n\n\n\n\n@fig-sand-samp12 shows the two samples and the least squares regressions from fig-sand-samp on the same plot.\nWe can see that the two lines are different.\nThat is, there is **variability** in the regression line from sample to sample.\nThe concept of the sampling variability is something you've seen before, but in this lesson, you will focus on the variability of the line often measured through the variability of a single statistic: **the slope of the line**.\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![The linear models from the two different random samples are quite similar,\nbut they are not the same line.\n](24-inf-model-slr_files/figure-html/fig-sand-samp12-1.png){#fig-sand-samp12 fig-alt='For two different random samples, superimposed onto the same plot,\nscatterplot with advertising amount on the x-axis and revenue on the y-axis.\nTwo linear models are plotted to demonstrate that the lines are very similar,\nyet they are not the same.' width=90%}\n:::\n:::\n\n\n\n\n@fig-slopes shows least squares lines fit to many more random samples of 20 from the population.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![If repeated samples of size 20 are taken from the entire population, each\nlinear model will be slightly different. The red line provides the linear fit to\nthe entire population.\n](24-inf-model-slr_files/figure-html/fig-slopes-1.png){#fig-slopes fig-alt='An x-y coordinate system with least squares regression lines from many\nrandom samples of size 20 (no points are plotted). The lines vary around the\ntrue population line. On the x-axis is advertising amount; on the y-axis\nis revenue.' width=90%}\n:::\n:::\n\n\n\n\nYou might notice in @fig-slopes that the $\\hat{y}$ values given by the lines are much more consistent in the middle of the dataset than at the ends.\nThe reason is that the data itself anchors the lines in such a way that the line must pass through the center of the data cloud.\nThe effect of the fan-shaped lines is that predicted revenue for advertising close to \\$4,000 will be much more precise than the revenue predictions made for \\$1,000 or \\$7,000 of advertising.\n\nThe distribution of slopes (for samples of size $n=20$) can be seen in @fig-sand20lm.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Variability of slope estimates from many different samples of stores,\neach of size 20.\n](24-inf-model-slr_files/figure-html/fig-sand20lm-1.png){#fig-sand20lm fig-alt='Histogram of the slope values from many random samples of size 20.\nThe slope estimates vary from about 2.1 to 8. The histogram is reasonably\nbell-shaped.' width=90%}\n:::\n:::\n\n\n\n\nRecall, the example described in this introduction is hypothetical.\nThat is, we created an entire population in order demonstrate how the slope of a line would vary from sample to sample.\nThe tools in this textbook are designed to evaluate only one single sample of data.\nWith actual studies, we do not have repeated samples, so we are not able to use repeated samples to visualize the variability in slopes.\nWe have seen variability in samples throughout this text, so it should not come as a surprise that different samples will produce different linear models.\nHowever, it is nice to visually consider the linear models produced by different slopes.\nAdditionally, as with measuring the variability of previous statistics (e.g., $\\overline{X}_1 - \\overline{X}_2$ or $\\hat{p}_1 - \\hat{p}_2$), the histogram of the sample statistics can provide information related to inferential considerations.\n\nIn the following sections, the distribution (i.e., histogram) of $b_1$ (the estimated slope coefficient) will be constructed in the same three ways that, by now, may be familiar to you.\nFirst (in @sec-randslope), the distribution of $b_1$ when $\\beta_1 = 0$ is constructed by randomizing (permuting) the response variable.\nNext (in @sec-bootbeta1), we can bootstrap the data by taking random samples of size $n$ from the original dataset.\nAnd last (in @sec-mathslope), we use mathematical tools to describe the variability using the $t$-distribution that was first encountered in @sec-one-mean-math.\n\n## Randomization test for the slope {#sec-randslope}\n\n\\index{randomization test for the slope}\n\nConsider data on 100 randomly selected births gathered originally from the US Department of Health and Human Services.\nSome of the variables are plotted in @fig-babyweight.\n\nThe scientific research interest at hand will be in determining the linear relationship between weight of baby at birth (in lbs) and number of weeks of gestation.\nThe dataset is quite rich and deserves exploring, but for this example, we will focus only on the weight of the baby.\n\n::: {.data data-latex=\"\"}\nThe [`births14`](http://openintrostat.github.io/openintro/reference/births14.html) data can be found in the [**openintro**](http://openintrostat.github.io/openintro) R package.\nWe will work with a random sample of 100 observations from these data.\n:::\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Weight of baby at birth (in lbs) as plotted by four other birth variables\n(mother's weight gain, mother's age, number of hospital visits, and weeks\ngestation).\n](24-inf-model-slr_files/figure-html/fig-babyweight-1.png){#fig-babyweight fig-alt='Four different scatterplots, all with weight of baby on the y-axis.\nOn the x-axis are weight gained by mother, mother\\'s age, number of hospital\nvisits, and weeks gestation. Weeks gestation and weight of baby show the\nstrongest linear relationship (which is positive).' width=90%}\n:::\n:::\n\n\n\n\n\\vspace{-5mm}\n\nAs you have seen previously, statistical inference typically relies on setting a null hypothesis which is hoped to be subsequently rejected.\nIn the linear model setting, we might hope to have a linear relationship between `weeks` and `weight` in settings where `weeks` gestation is known and `weight` of baby needs to be predicted.\n\nThe relevant hypotheses for the linear model setting can be written in terms of the population slope parameter.\nHere the population refers to a larger population of births in the US.\n\n-   $H_0: \\beta_1= 0$, there is no linear relationship between `weight` and `weeks`.\n-   $H_A: \\beta_1 \\ne 0$, there is some linear relationship between `weight` and `weeks`.\n\nRecall that for the randomization test, we permute one variable to eliminate any existing relationship between the variables.\nThat is, we set the null hypothesis to be true, and we measure the natural variability in the data due to sampling but **not** due to variables being correlated.\n@fig-permweightScatter-1 shows the observed data and @fig-permweightScatter-2 shows one permutation of the `weight` variable.\nThe careful observer can see that each of the observed values for `weight` (and for `weeks`) exist in both the original data plot as well as the permuted `weight` plot, but the `weight` and `weeks` gestation are no longer matched for a given birth.\nThat is, each `weight` value is randomly assigned to a new `weeks` gestation.\n\nBy repeatedly permuting the response variable, any pattern in the linear model that is observed is due only to random chance (and not an underlying relationship).\nThe randomization test compares the slopes calculated from the permuted response variable with the observed slope.\nIf the observed slope is inconsistent with the slopes from permuting, we can conclude that there is some underlying relationship (and that the slope is not merely due to random chance).\n\n\n\n\n::: {#fig-permweightScatter .cell layout-ncol=\"2\"}\n::: {.cell-output-display}\n![Original data.](24-inf-model-slr_files/figure-html/fig-permweightScatter-1.png){#fig-permweightScatter-1 fig-alt='Two scatterplots, both with length of gestation on the x-axis and weight\nof baby on the y-axis. The left panel is the original data. The right panel\nis data where the weight of the baby has been permuted across the\nobservations.\n' width=100%}\n:::\n\n::: {.cell-output-display}\n![Permuted data.](24-inf-model-slr_files/figure-html/fig-permweightScatter-2.png){#fig-permweightScatter-2 fig-alt='Two scatterplots, both with length of gestation on the x-axis and weight\nof baby on the y-axis. The left panel is the original data. The right panel\nis data where the weight of the baby has been permuted across the\nobservations.\n' width=100%}\n:::\n\nPermutation removes the linear relationship between `weight` and `weeks`.\nRepeated permutations allow for quantifying the variability in the slope\nunder the condition that there is no linear relationship (i.e., that the\nnull hypothesis is true).\n\n:::\n\n\n\n\n### Observed data\n\nWe will continue to use the births data to investigate the linear relationship between `weight` and `weeks` gestation.\nNote that the least squares model (see @sec-model-slr) describing the relationship is given in @tbl-ls-births.\nThe columns in @tbl-ls-births are further described in @sec-mathslope.\n\n\n\n\n::: {#tbl-ls-births .cell tbl-cap='The least squares estimates of the intercept and slope are given in\nthe estimate column. The observed slope is 0.335.\n' tbl-pos='H'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n   <td style=\"text-align:right;width: 5em; \"> -5.72 </td>\n   <td style=\"text-align:right;width: 5em; \"> 1.61 </td>\n   <td style=\"text-align:right;width: 5em; \"> -3.54 </td>\n   <td style=\"text-align:right;width: 5em; \"> 6e-04 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 10em; font-family: monospace;\"> weeks </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.34 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.04 </td>\n   <td style=\"text-align:right;width: 5em; \"> 8.07 </td>\n   <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n\\clearpage\n\n### Variability of the statistic\n\nAfter permuting the data, the least squares estimate of the line can be computed.\nRepeated permutations and slope calculations describe the variability in the line (i.e., in the slope) due only to the natural variability and not due to a relationship between `weight` and `weeks` gestation.\n@fig-permweekslm shows two different permutations of `weight` and the resulting linear models.\n\n\n\n\n::: {#fig-permweekslm .cell layout-ncol=\"2\"}\n::: {.cell-output-display}\n![First permutation.](24-inf-model-slr_files/figure-html/fig-permweekslm-1.png){#fig-permweekslm-1 fig-alt='Two scatterplots, both with length of gestation on the x-axis and\nweight of baby on the y-axis. Each plot includes data where the weight of\nthe baby has been permuted across the observations. The two different\npermutations produce slightly different least squares regression lines.\n' width=100%}\n:::\n\n::: {.cell-output-display}\n![Second permutation.](24-inf-model-slr_files/figure-html/fig-permweekslm-2.png){#fig-permweekslm-2 fig-alt='Two scatterplots, both with length of gestation on the x-axis and\nweight of baby on the y-axis. Each plot includes data where the weight of\nthe baby has been permuted across the observations. The two different\npermutations produce slightly different least squares regression lines.\n' width=100%}\n:::\n\nTwo permutations of `weight` with slightly different least\nsquares regression lines.\n\n:::\n\n\n\n\nAs you can see, sometimes the slope of the permuted data is positive, sometimes it is negative.\nBecause the randomization happens under the condition of no underlying relationship (because the response variable is completely mixed with the explanatory variable), we expect to see the center of the randomized slope distribution to be zero.\n\n### Observed statistic vs. null statistics\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Histogram of slopes given different permutations of the `weight` variable.\nThe vertical red line is at the observed value of the slope, 0.335.\n](24-inf-model-slr_files/figure-html/fig-nulldistBirths-1.png){#fig-nulldistBirths fig-alt='Histogram of slopes describing the linear model from permuted weight\nregressed on weeks gestation. The permuted slopes range from -0.15 to +0.15\nand are nowhere near the observed slope value of 0.335.\n' width=90%}\n:::\n:::\n\n\n\n\n\\vspace{-3mm}\n\nAs we can see from @fig-nulldistBirths, a slope estimate as extreme as the observed slope estimate (the red line) never happened in many repeated permutations of the `weight` variable.\nThat is, if indeed there were no linear relationship between `weight` and `weeks`, the natural variability of the slopes would produce estimates between approximately -0.15 and +0.15.\nWe reject the null hypothesis.\nTherefore, we believe that the slope observed on the original data is not just due to natural variability and indeed, there is a linear relationship between `weight` of baby and `weeks` gestation for births in the US.\n\n## Bootstrap confidence interval for the slope {#sec-bootbeta1}\n\n\\index{bootstrap CI for the slope}\n\nAs we have seen in previous chapters, we can use bootstrapping to estimate the sampling distribution of the statistic of interest (here, the slope) without the null assumption of no relationship (which was the condition in the randomization test).\nBecause interest is now in creating a CI, there is no null hypothesis, so there won't be any reason to permute either of the variables.\n\n\n\n\n\n\n\n\n\n### Observed data\n\nReturning to the births data, we may want to consider the relationship between `mage` (mother's age) and `weight`.\nIs `mage` a good predictor of `weight`?\nAnd if so, what is the relationship?\nThat is, what is the slope that models average `weight` of baby as a function of `mage` (mother's age)?\nThe linear model regressing `weight` on `mage` is provided in @tbl-ls-births-mage.\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Using the original data, the weight of baby as a linear model of\nmother's age. Notice that the relationship between mother's age and weight\nof baby is not as strong as the relationship we saw previously between\nweeks gestation and weight of baby.\n](24-inf-model-slr_files/figure-html/fig-magePlot-1.png){#fig-magePlot fig-alt='Scatterplot with mother\\'s age on the x-axis and baby\\'s weight on the\ny-axis. A linear model is superimposed. The points show a weak positive\nlinear trend.\n' width=90%}\n:::\n:::\n\n\n\n\n\\vspace{-5mm}\n\n\n\n\n::: {#tbl-ls-births-mage .cell tbl-cap='The least squares estimates of the intercept and slope are given in\nthe estimate column. The observed slope is 0.036.\n' tbl-pos='H'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n   <td style=\"text-align:right;width: 5em; \"> 6.23 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.71 </td>\n   <td style=\"text-align:right;width: 5em; \"> 8.79 </td>\n   <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 10em; font-family: monospace;\"> mage </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.04 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.02 </td>\n   <td style=\"text-align:right;width: 5em; \"> 1.50 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.1362 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n### Variability of the statistic\n\nBecause the focus here is *not* on a null distribution, we sample with replacement $n = 100$ observations from the original dataset.\nRecall that with bootstrapping the resample always has the same number of observations as the original dataset in order to mimic the process of taking a sample from the population.\nWhen sampling in the linear model case, consider each observation to be a single dot.\nIf the dot is resampled, both the `weight` and the `mage` measurement are observed.\nThe measurements are linked to the dot (i.e., to the birth in the sample).\n\n\\vspace{-3mm}\n\n\n\n\n::: {#fig-birth2BS .cell layout-ncol=\"2\"}\n::: {.cell-output-display}\n![Original data.](24-inf-model-slr_files/figure-html/fig-birth2BS-1.png){#fig-birth2BS-1 fig-alt='Two scatterplots, both with mother\\'s age on the x-axis and baby\\'s weight\non the y-axis. The left plot is the original data. The right plot is the\nbootstrapped data. Comparing the bootstrapped points to the original points,\nwe can see that some observations were sampled more than once, and some\nobservations were not selected for the bootstrap sample at all.\n' width=100%}\n:::\n\n::: {.cell-output-display}\n![Bootstrapped data.](24-inf-model-slr_files/figure-html/fig-birth2BS-2.png){#fig-birth2BS-2 fig-alt='Two scatterplots, both with mother\\'s age on the x-axis and baby\\'s weight\non the y-axis. The left plot is the original data. The right plot is the\nbootstrapped data. Comparing the bootstrapped points to the original points,\nwe can see that some observations were sampled more than once, and some\nobservations were not selected for the bootstrap sample at all.\n' width=100%}\n:::\n\nOriginal and one bootstrap sample of the births data. It is difficult to\ndifferentiate between the two plots, as (within a single bootstrap sample)\nthe observations which have been resampled twice are plotted as points on\ntop of one another. The red circles represent points in the original data\nwhich were not included in the bootstrap sample. The blue circles represent\na data point that was repeatedly resampled (and is therefore darker) in the\nbootstrap sample. The green circles represent a particular structure to the\ndata which is observed in both the original and bootstrap samples.\n\n:::\n\n\n\n\n@fig-birth2BS-1 shows the original data as compared with a single bootstrap sample in @fig-birth2BS-2, resulting in (slightly) different linear models.\nThe red circles represent points in the original data which were not included in the bootstrap sample.\nThe blue circles represent a point that was repeatedly resampled (and is therefore darker) in the bootstrap sample.\nThe green circles represent a particular structure to the data which is observed in both the original and bootstrap samples.\nBy repeatedly resampling, we can see dozens of bootstrapped slopes on the same plot in @fig-birthBS.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Repeated bootstrap resamples of size 100 are taken from the original data. Each\nof the bootstrapped linear models is slightly different.\n](24-inf-model-slr_files/figure-html/fig-birthBS-1.png){#fig-birthBS fig-alt='An x-y coordinate system with least squares regression lines from many\nbootstrap samples (no points are plotted). The lines vary around the observed\npopulation line. On the x-axis is mother\\'s age; on the y-axis is baby\\'s weight.\n' width=90%}\n:::\n:::\n\n\n\n\nRecall that in order to create a confidence interval for the slope, we need to find the range of values that the statistic (here the slope) takes on from different bootstrap samples.\n@fig-mageBSslopes is a histogram of the relevant bootstrapped slopes.\nWe can see that a 95% bootstrap percentile interval for the true population slope is given by (-0.01, 0.081).\nWe are 95% confident that for the model describing the population of births, predicting weight of baby from mother's age, a one unit increase in `mage` (in years) is associated with an increase in predicted average baby `weight` of between -0.01 and 0.081 pounds. Notice that the CI contains zero, so the true relationship *might* be null!\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![The original births data on baby's weight and mother's age is\nbootstrapped 1,000 times. The histogram provides a sense for the\nvariability of the slope of the linear model from sample to sample.\n](24-inf-model-slr_files/figure-html/fig-mageBSslopes-1.png){#fig-mageBSslopes fig-alt='Histogram of the slopes computed from many bootstrapped samples.\nThe bootstrap samples range from -0.05 (with the 2.5 percentile at -0.01) to\n+0.1 (with the 97.5 percentile at 0.081). The bootstrapped slopes form a\nhistogram that is reasonably symmetric and bell-shaped.\n' width=90%}\n:::\n:::\n\n\n\n\n\n::: {.workedexample data-latex=\"\"}\nUsing @fig-mageBSslopes, calculate the bootstrap estimate for the standard error of the slope.\nUsing the bootstrap standard error, find a 95% bootstrap SE confidence interval for the true population slope, and interpret the interval in context.\n\n------------------------------------------------------------------------\n\nNotice that most of the bootstrapped slopes fall between -0.01 and +0.08 (a range of 0.09).\nUsing the empirical rule (that with bell-shaped distributions, most observations are within two standard errors of the center), the standard error of the slopes is approximately 0.0225.\nThe critical value for a 95% confidence interval is $z^\\star = 1.96$ which leads to a confidence interval of $b_1 \\pm 1.96 \\cdot SE \\rightarrow 0.036 \\pm 1.96 \\cdot 0.0225 \\rightarrow (-0.0081, 0.0801).$ The bootstrap SE confidence interval is almost identical to the bootstrap percentile interval.\nIn context, we are 95% confident that for the model describing the population of births, predicting weight of baby from mother's age, a one unit increase in `mage` (in years) is associated with an increase in predicted average baby `weight` of between -0.0081 and 0.0801 pounds.\n:::\n\n## Mathematical model for testing the slope {#sec-mathslope}\n\nWhen certain technical conditions apply, it is convenient to use mathematical approximations to test and estimate the slope parameter.\nThe approximations will build on the t-distribution which was described in @sec-inference-one-mean.\nThe mathematical model is often correct and is usually easy to implement computationally.\nThe validity of the technical conditions will be considered in detail in @sec-tech-cond-linmod.\n\nIn this section, we discuss uncertainty in the estimates of the slope and y-intercept for a regression line.\nJust as we identified standard errors for point estimates in previous chapters, we start by discussing standard errors for the slope and y-intercept estimates.\n\n\\clearpage\n\n### Observed data\n\n**Midterm elections and unemployment**\n\nElections for members of the United States House of Representatives occur every two years, coinciding every four years with the U.S.\nPresidential election.\nThe set of House elections occurring during the middle of a Presidential term are called midterm elections.\nIn America's two-party system (the vast majority of House members through history have been either Republicans or Democrats), one political theory suggests the higher the unemployment rate, the worse the President's party will do in the midterm elections.\nIn 2020 there were 232 Democrats, 198 Republicans, and 1 Libertarian in the House.\n\nTo assess the validity of the claim related to unemployment and voting patterns, we can compile historical data and look for a connection.\nWe consider every midterm election from 1898 to 2018, with the exception of those elections during the Great Depression.\nThe House of Representatives is made up of 435 voting members.\n\n::: {.data data-latex=\"\"}\nThe [`midterms_house`](http://openintrostat.github.io/openintro/reference/midterms_house.html) data can be found in the [**openintro**](http://openintrostat.github.io/openintro) R package.\n:::\n\n@fig-unemploymentAndChangeInHouse shows these data and the least-squares regression line:\n\n$$\n\\begin{aligned}\n&\\texttt{percent change in House seats for President's party}  \\\\\n&\\qquad\\qquad= -7.36 - 0.89 \\times \\texttt{(unemployment rate)}\n\\end{aligned}\n$$\n\nWe consider the percent change in the number of seats of the President's party (e.g., percent change in the number of seats for Republicans in 2018) against the unemployment rate.\n\nExamining the data, there are no clear deviations from linearity or substantial outliers (see @sec-resids for a discussion on using residuals to visualize how well a linear model fits the data).\nWhile the data are collected sequentially, a separate analysis was used to check for any apparent correlation between successive observations; no such correlation was found.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![The percent change in House seats for the President's party in each election\nfrom 1898 to 2010 plotted against the unemployment rate. The two points for the\nGreat Depression have been removed, and a least squares regression line has been\nfit to the data.\n](24-inf-model-slr_files/figure-html/fig-unemploymentAndChangeInHouse-1.png){#fig-unemploymentAndChangeInHouse fig-alt='Scatterplot with percent unemployed on the x-axis and percent change in\nHouse seats for the President\\'s party on the y-axis. Each point represents a\ndifferent President\\'s midterm and is colored according to their political party\n(Democrat or Republican). The relationship is moderate and negative.\n' width=100%}\n:::\n:::\n\n\n\n\n::: {.guidedpractice data-latex=\"\"}\nThe data for the Great Depression (1934 and 1938) were removed because the unemployment rate was 21% and 18%, respectively.\nDo you agree that they should be removed for this investigation?\nWhy or why not?[^24-inf-model-slr-1]\n:::\n\n[^24-inf-model-slr-1]: The answer to this question relies on the idea that statistical data analysis is somewhat of an art.\n    That is, in many situations, there is no \"right\" answer.\n    As you do more and more analyses on your own, you will come to recognize the nuanced understanding which is needed for a particular dataset.\n    In terms of the Great Depression, we will provide two contrasting considerations.\n    Each of these points would have very high leverage on any least-squares regression line, and years with such high unemployment may not help us understand what would happen in other years where the unemployment is only modestly high.\n    On the other hand, the Depression years are exceptional cases, and we would be discarding important information if we exclude them from a final analysis.\n\nThere is a negative slope in the line shown in @fig-unemploymentAndChangeInHouse.\nHowever, this slope (and the y-intercept) are only estimates of the parameter values.\nWe might wonder, is this convincing evidence that the \"true\" linear model has a negative slope?\nThat is, do the data provide strong evidence that the political theory is accurate, where the unemployment rate is a useful predictor of the midterm election?\nWe can frame this investigation into a statistical hypothesis test:\n\n-   $H_0$: $\\beta_1 = 0$. The true linear model has slope zero.\n-   $H_A$: $\\beta_1 \\neq 0$. The true linear model has a slope different than zero. The unemployment is predictive of whether the President's party wins or loses seats in the House of Representatives.\n\nWe would reject $H_0$ in favor of $H_A$ if the data provide strong evidence that the true slope parameter is different than zero.\nTo assess the hypotheses, we identify a standard error for the estimate, compute an appropriate test statistic, and identify the p-value.\n\n### Variability of the statistic\n\nJust like other point estimates we have seen before, we can compute a standard error and test statistic for $b_1$.\nWe will generally label the test statistic using a $T$, since it follows the $t$-distribution.\n\n\\index{T score!slope}\n\nWe will rely on statistical software to compute the standard error and leave the explanation of how this standard error is determined to a second or third statistics course.\n@tbl-midtermUnempRegTable shows software output for the least squares regression line in @fig-unemploymentAndChangeInHouse.\nThe row labeled `unemp` includes all relevant information about the slope estimate (i.e., the coefficient of the unemployment variable, the related SE, the T statistic, and the corresponding p-value).\n\n\n\n\n\n\n::: {#tbl-midtermUnempRegTable .cell tbl-cap='Output from statistical software for the regression line modeling the\nmidterm election losses for the President\\'s party as a response to\nunemployment.\n' tbl-pos='H'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n   <td style=\"text-align:right;width: 5em; \"> -7.36 </td>\n   <td style=\"text-align:right;width: 5em; \"> 5.16 </td>\n   <td style=\"text-align:right;width: 5em; \"> -1.43 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 10em; font-family: monospace;\"> unemp </td>\n   <td style=\"text-align:right;width: 5em; \"> -0.89 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.83 </td>\n   <td style=\"text-align:right;width: 5em; \"> -1.07 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.30 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n::: {.workedexample data-latex=\"\"}\nWhat do the first and second columns of @tbl-midtermUnempRegTable represent?\n\n------------------------------------------------------------------------\n\nThe entries in the first column represent the least squares estimates, $b_0$ and $b_1$, and the values in the second column correspond to the standard errors of each estimate.\nUsing the estimates, we could write the equation for the least square regression line as\n\n$$ \\hat{y} = -7.36 - 0.89 x $$\n\nwhere $\\hat{y}$ in this case represents the predicted change in the number of seats for the president's party, and $x$ represents the unemployment rate.\n:::\n\nWe previously used a $t$-test statistic for hypothesis testing in the context of numerical data.\nRegression is very similar.\nIn the hypotheses we consider, the null value for the slope is 0, so we can compute the test statistic using the T score formula:\n\n$$\nT \\ = \\ \\frac{\\text{estimate} - \\text{null value}}{\\text{SE}} = \\ \\frac{-0.89 - 0}{0.835} = \\ -1.07\n$$\n\nThe T score we calculated corresponds to the third column of @tbl-midtermUnempRegTable.\n\n::: {.workedexample data-latex=\"\"}\nUse @tbl-midtermUnempRegTable to determine the p-value for the hypothesis test.\n\n------------------------------------------------------------------------\n\nThe last column of the table gives the p-value for the two-sided hypothesis test for the coefficient of the unemployment rate 0.2961 That is, the data do not provide convincing evidence that a higher unemployment rate has any correspondence with smaller or larger losses for the President's party in the House of Representatives in midterm elections. If there was no linear relationship between the two variables (i.e., if $\\beta_1 = 0)$, then we would expect to see linear models as or more extreme that the observed model roughly 30% of the time.\n:::\n\n### Observed statistic vs. null statistics\n\nAs the final step in a mathematical hypothesis test for the slope, we use the information provided to make a conclusion about whether the data could have come from a population where the true slope was zero (i.e., $\\beta_1 = 0$).\nBefore evaluating the formal hypothesis claim, sometimes it is important to check your intuition.\nBased on everything we have seen in the examples above describing the variability of a line from sample to sample, ask yourself if the linear relationship given by the data could have come from a population in which the slope was truly zero.\n\n::: {.workedexample data-latex=\"\"}\nExamine @fig-elmhurstScatterWLine, which relates the Elmhurst College aid and student family income.\nAre you convinced that the slope is discernibly different from zero?\nThat is, do you think a formal hypothesis test would reject the claim that the true slope of the line should be zero?\n\n------------------------------------------------------------------------\n\nWhile the relationship between the variables is not perfect, there is an evident decreasing trend in the data.\nSuch a distinct trend suggests that the hypothesis test will reject the null claim that the slope is zero.\n:::\n\n::: {.data data-latex=\"\"}\nThe [`elmhurst`](http://openintrostat.github.io/openintro/reference/elmhurst.html) data can be found in the [**openintro**](http://openintrostat.github.io/openintro) R package.\n:::\n\nThe tools in this section help you go beyond a visual interpretation of the linear relationship toward a formal mathematical claim about whether the slope estimate is meaningfully different from 0 to suggest that the true population slope is different from 0.\n\n\n\n\n::: {#tbl-rOutputForIncomeAidLSRLineInInferenceSection .cell tbl-cap='Summary of least squares fit for the Elmhurst College data, where we\nare predicting the gift aid by the university based on the family\nincome of students.\n' tbl-pos='H'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n   <td style=\"text-align:right;width: 5em; \"> 24319.33 </td>\n   <td style=\"text-align:right;width: 5em; \"> 1291.45 </td>\n   <td style=\"text-align:right;width: 5em; \"> 18.83 </td>\n   <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 10em; font-family: monospace;\"> family_income </td>\n   <td style=\"text-align:right;width: 5em; \"> -0.04 </td>\n   <td style=\"text-align:right;width: 5em; \"> 0.01 </td>\n   <td style=\"text-align:right;width: 5em; \"> -3.98 </td>\n   <td style=\"text-align:right;width: 5em; \"> 2e-04 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n::: {.guidedpractice data-latex=\"\"}\n@tbl-rOutputForIncomeAidLSRLineInInferenceSection shows statistical software output from fitting the least squares regression line shown in @fig-elmhurstScatterWLine.\nUse the output to formally evaluate the following hypotheses.[^24-inf-model-slr-2]\n\n-   $H_0$: The true coefficient for family income is zero.\n-   $H_A$: The true coefficient for family income is not zero.\n:::\n\n[^24-inf-model-slr-2]: We look in the second row corresponding to the family income variable.\n    We see the point estimate of the slope of the line is -0.0431, the standard error of this estimate is 0.0108, and the $t$-test statistic is $T = -3.98$.\n    The p-value corresponds exactly to the two-sided test we are interested in: 0.0002.\n    The p-value is so small that we reject the null hypothesis and conclude that family income and financial aid at Elmhurst College for freshman entering in the year 2011 are negatively correlated and the true slope parameter is indeed less than 0, just as we believed in our analysis of @fig-elmhurstScatterWLine.\n\n::: {.important data-latex=\"\"}\n**Inference for regression.**\n\nWe usually rely on statistical software to identify point estimates, standard errors, test statistics, and p-values in practice.\nHowever, be aware that software will not generally check whether the method is appropriate, meaning we must still verify conditions are met.\nSee @sec-tech-cond-linmod.\n:::\n\n\\clearpage\n\n## Mathematical model, interval for the slope\n\nSimilar to how we can conduct a hypothesis test for a model coefficient using regression output, we can also construct confidence intervals for the slope and intercept coefficients.\n\n::: {.important data-latex=\"\"}\n**Confidence intervals for coefficients.**\n\nConfidence intervals for model coefficients (e.g., the intercept or the slope) can be computed using the $t$-distribution:\n\n$$ b_i \\ \\pm\\ t_{df}^{\\star} \\times SE_{b_{i}} $$\n\nwhere $t_{df}^{\\star}$ is the appropriate $t^{\\star}$ cutoff corresponding to the confidence level with the model's degrees of freedom, $df = n - 2$.\n:::\n\n::: {.workedexample data-latex=\"\"}\nCompute the 95% confidence interval for the coefficient using the regression output from @tbl-rOutputForIncomeAidLSRLineInInferenceSection.\n\n------------------------------------------------------------------------\n\nThe point estimate is -0.0431 and the standard error is $SE = 0.0108$.\nWhen constructing a confidence interval for a model coefficient, we generally use a $t$-distribution.\nThe degrees of freedom for the distribution are noted in the regression output, $df = 48$, allowing us to identify $t_{48}^{\\star} = 2.01$ for use in the confidence interval.\n\nWe can now construct the confidence interval in the usual way:\n\n$$\n\\begin{aligned}\n\\text{point estimate} &\\pm t_{48}^{\\star} \\times SE \\\\\n-0.0431 &\\pm 2.01 \\times 0.0108 \\\\\n(-0.0648 &, -0.0214)\n\\end{aligned}\n$$\n\nWe are 95% confident that for an additional one unit (i.e., $1000 increase) in family income, the university's gift aid is predicted to decrease on average by \\$21.40 to \\$64.80.\n:::\n\nOn the topic of intervals in this book, we have focused exclusively on confidence intervals for model parameters.\nHowever, there are other types of intervals that may be of interest (and are outside the scope of this book), including prediction intervals for a response value and confidence intervals for a mean response value in the context of regression.\n\n## Checking model conditions {#sec-tech-cond-linmod}\n\n\\index{technical conditions linear regression}\n\nIn the previous sections, we used randomization and bootstrapping to perform inference when the mathematical model was not valid due to violations of the technical conditions.\nIn this section, we'll provide details for when the mathematical model is appropriate and a discussion of technical conditions needed for the randomization and bootstrapping procedures.\nRecall from @sec-resids that residual plots can be used to visualize how well a linear model fits the data.\n\n\n\n\n\n\n\n\n\n### What are the technical conditions for the mathematical model?\n\nWhen fitting a least squares line, we generally require the following:\n\n-   **Linearity.** The data should show a linear trend.\n    If there is a nonlinear trend (e.g., first panel of @fig-whatCanGoWrongWithLinearModel) an advanced regression method from another book or later course should be applied.\n\n-   **Independent observations.** Be cautious about applying regression to data that are sequential observations in time such as a stock price each day.\n    Such data may have an underlying structure that should be considered in a different type of model and analysis.\n    An example of a dataset where successive observations are not independent is shown in the fourth panel of @fig-whatCanGoWrongWithLinearModel.\n    There are also other instances where correlations within the data are important, which is further discussed in @sec-inf-model-mlr.\n\n-   **Nearly normal residuals.** Generally, the residuals should be nearly normal.\n    When this condition is found to be unreasonable, it is often because of outliers or concerns about influential points, which we'll talk about more in @sec-outliers-in-regression.\n    An example of a residual that would be potentially concerning is shown in the second panel of @fig-whatCanGoWrongWithLinearModel, where one observation is clearly much further from the regression line than the others. Outliers should be treated extremely carefully. Do not automatically remove an outlier if it truly belongs in the dataset. However, be honest about its impact on the analysis. A strategy for dealing with outliers is to present two analyses: one with the outlier and one without the outlier.\nAdditionally, a type of violation of normality happens when the positive residuals are smaller in magnitude than the negative residuals (or vice versa). That is, when the residuals are not symmetrically distributed around the line $y=0.$ \n\n-   **Constant or equal variability.** The variability of points around the least squares line remains roughly constant.\n    An example of non-constant variability is shown in the third panel of @fig-whatCanGoWrongWithLinearModel, which represents the most common pattern observed when this condition fails: the variability of $y$ is larger when $x$ is larger.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Four examples showing when the methods in this chapter are insufficient\nto apply a linear model to the data. The top set of graphs represents the\n$x$ and $y$ relationship. The bottom set of graphs is a residual plot.\nFirst panel -- linearity fails. Second panel -- there are outliers, most\nespecially one point that is very far away from the line. Third panel --\nthe variability of the errors is related to the value of $x$. Fourth panel --\na time series dataset is shown, where successive observations are highly correlated.\n](24-inf-model-slr_files/figure-html/fig-whatCanGoWrongWithLinearModel-1.png){#fig-whatCanGoWrongWithLinearModel fig-alt='A grid of 2 by 4 scatterplots with fabricated data. The top row of plots\ncontains original x-y data plots with a least squares regression line. The\nbottom row of plots is a series of residual plot with predicted value on the\nx-axis and residual on the y-axis. The first column of plots gives an example\nof points that have a quadratic relationship instead of a linear relationship.\nThe second column of plots gives an example where a single outlying point\ndoes not fit the linear model. The third column of points gives an example\nwhere the points have increasing variability as the value of x increases.\nThe last column of points gives an example where the points are correlated\nwith one another, possibly as part of a time series.\n' width=100%}\n:::\n:::\n\n\n\n\n::: {.guidedpractice data-latex=\"\"}\nShould we have concerns about applying least squares regression to the Elmhurst data in @fig-elmhurstScatterW2Lines?[^24-inf-model-slr-3]\n:::\n\n[^24-inf-model-slr-3]: The trend appears to be linear, the data fall around the line with no obvious outliers, the variance is roughly constant.\n    The data do not come from a time series or other obvious violation to independence.\n    Least squares regression can be applied to these data.\n\nThe technical conditions are often remembered using the **LINE** mnemonic.\nThe linearity, normality, and equality of variance conditions usually can be assessed through residual plots, as seen in @fig-whatCanGoWrongWithLinearModel.\nA careful consideration of the experimental design should be undertaken to confirm that the observed values are indeed independent.\n\n-   L: **linear** model\n-   I: **independent** observations\n-   N: points are **normally** distributed around the line\n-   E: **equal** variability around the line for all values of the explanatory variable\n\n### Why do we need technical conditions?\n\nAs with other inferential techniques we have covered in this text, if the technical conditions above do not hold, then it is not possible to make concluding claims about the population.\nThat is, without the technical conditions, the T score will not have the assumed t-distribution.\nThat said, it is almost always impossible to check the conditions precisely, so we look for large deviations from the conditions.\nIf there are large deviations, we will be unable to trust the calculated p-value or the endpoints of the resulting confidence interval.\n\n**The model based on linearity**\n\nThe linearity condition is among the most important if your goal is to understand a linear model between $x$ and $y$.\nFor example, the value of the slope will not be at all meaningful if the true relationship between $x$ and $y$ is quadratic, as in @fig-notGoodAtAllForALinearModel.\nNot only should we be cautious about the inference, but the model *itself* is also not an accurate portrayal of the relationship between the variables.\nHowever, an extended discussion on the different methods for modeling functional forms other than linear is outside the scope of this text.\n\n**The importance of independence**\n\nThe technical condition describing the independence of the observations is often the most crucial but also the most difficult to diagnose.\nIt is also extremely difficult to gather a dataset which is a true random sample from the population of interest.\nA true randomized experiment from a fixed set of individuals is much easier to implement, and indeed, randomized experiments are done in most medical studies these days.\n\nDependent observations can bias results in ways that produce fundamentally flawed analyses.\nThat is, if you hang out at the gym measuring height and weight, your linear model is surely not a representation of all students at your university.\nAt best it is a model describing students who use the gym, but also who are willing to talk to you, that use the gym at the times you were there measuring, etc.\n\nIn lieu of trying to answer whether your observations are a true random sample, you might instead focus on whether you believe your observations are representative of a population of interest.\nHumans are notoriously bad at implementing random procedures, so you should be wary of any process that used human intuition to balance the data with respect to, for example, the demographics of the individuals in the sample.\n\n**Some thoughts on normality**\n\nThe normality condition requires that points vary symmetrically around the line, spreading out in a bell-shaped fashion.\nYou should consider the \"bell\" of the normal distribution as sitting on top of the line (coming off the paper in a 3-D sense) so as to indicate that the points are dense close to the line and disperse gradually as they get farther from the line.\n\nThe normality condition is less important than linearity or independence for a few reasons.\nFirst, the linear model fit with least squares will still be an unbiased estimate of the true population model.\nHowever, the distribution of the estimate will be unknown.\nFortunately the Central Limit Theorem (described in @sec-one-mean-math) tells us that most of the analyses (e.g., SEs, p-values, confidence intervals) done using the mathematical model (with the $t$-distribution) will still hold (even if the data are not normally distributed around the line) as long as the sample size is large enough.\nOne analysis method that *does* require normality, regardless of sample size, is creating intervals which predict the response of individual outcomes at a given $x$ value, using the linear model.\nOne additional reason to worry slightly less about normality is that neither the randomization test nor the bootstrapping procedures require the data to be normal around the line.\n\n**Equal variability for prediction in particular**\n\nAs with normality, the equal variability condition (that points are spread out in similar ways around the line for all values of $x$) will not cause problems for the estimate of the linear model.\nThat said, the **inference** on the model (e.g., computing p-values) will be incorrect if the variability around the line is extremely heterogeneous.\nData that exhibit non-equal variance across the range of x-values will have the potential to seriously mis-estimate the variability of the slope which will have consequences for the inference results (i.e., hypothesis tests and confidence intervals).\n\nIn many cases, the inference results for both a randomization test or a bootstrap confidence interval are also robust to the equal variability condition, so they provide the analyst a set of methods to use when the data are heteroskedastic (that is, exhibit unequal variability around the regression line).\nAlthough randomization tests and bootstrapping allow us to analyze data using fewer conditions, some technical conditions are required for all methods described in this text (e.g., independent observation).\nWhen the equal variability condition is violated and a mathematical analysis (e.g., p-value from T score) is needed, there are other existing methods (outside the scope of this text) which can handle the unequal variance (e.g., weighted least squares analysis).\n\n### What if all the technical conditions are met?\n\nWhen the technical conditions are met, the least squares regression model and inference is provided by virtually all statistical software.\nIn addition to being ubiquitous, however, an additional advantage to the least squares regression model (and related inference) is that the linear model has important extensions (which are not trivial to implement with bootstrapping and randomization tests).\nIn particular, random effects models, repeated measures, and interaction are all linear model extensions which require the above technical conditions.\nWhen the technical conditions hold, the extensions to the linear model can provide important insight into the data and research question at hand.\nWe will discuss some of the extended modeling and associated inference in @sec-inf-model-mlr and @sec-inf-model-logistic.\nMany of the techniques used to deal with technical condition violations are outside the scope of this text, but they are taught in universities in the very next class after this one.\nIf you are working with linear models or are curious to learn more, we recommend that you continue learning about statistical methods applicable to a larger class of datasets.\n\n\\clearpage\n\n## Chapter review {#sec-chp24-review}\n\n### Summary\n\nRecall that early in the text we presented graphical techniques which communicated relationships across multiple variables.\nWe also used modeling to formalize the relationships.\nMany chapters were dedicated to inferential methods which allowed claims about the population to be made based on samples of data.\nNot only did we present the mathematical model for each of the inferential techniques, but when appropriate, we also presented bootstrapping and permutation methods.\n\nIn @sec-inf-model-slr we brought all of those ideas together by considering inferential claims on linear models through randomization tests, bootstrapping, and mathematical modeling.\nWe continue to emphasize the importance of experimental design in making conclusions about research claims.\nIn particular, recall that variability can come from different sources (e.g., random sampling vs. random allocation, see @fig-randsampValloc).\n\n### Terms\n\nThe terms introduced in this chapter are presented in @tbl-terms-chp-24.\nIf you're not sure what some of these terms mean, we recommend you go back in the text and review their definitions.\nYou should be able to easily spot them as **bolded text**.\n\n\n\n\n::: {#tbl-terms-chp-24 .cell tbl-cap='Terms introduced in this chapter.' tbl-pos='H'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 12em; \"> bootstrap CI for the slope </td>\n   <td style=\"text-align:left;width: 12em; \"> randomization test for the slope </td>\n   <td style=\"text-align:left;width: 12em; \"> technical conditions linear regression </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 12em; \"> inference with single precictor regression </td>\n   <td style=\"text-align:left;width: 12em; \"> t-distribution for slope </td>\n   <td style=\"text-align:left;width: 12em; \"> variability of the slope </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n\\clearpage\n\n## Exercises {#sec-chp24-exercises}\n\nAnswers to odd-numbered exercises can be found in [Appendix -@sec-exercise-solutions-24].\n\n::: {.exercises data-latex=\"\"}\n\n1.  **Body measurements, randomization test.** Researchers studying anthropometry collected body and skeletal diameter measurements, as well as age, weight, height and sex for 507 physically active individuals.\n    A linear model is built to predict height based on shoulder girth (circumference of shoulders measured over deltoid muscles), both measured in centimeters.[^_24-ex-inf-model-slr-1]\n    [@Heinz:2003] Shown below are the linear model output for predicting height from shoulder girth and the histogram of slopes from 1,000 randomized datasets (1,000 times, `hgt` was permuted and regressed against `sho_gi`).\n    The red vertical line is drawn at the observed slope value which was produced in the linear model output.\n\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> 105.832 </td>\n       <td style=\"text-align:right;width: 5em; \"> 3.27 </td>\n       <td style=\"text-align:right;width: 5em; \"> 32.3 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> sho_gi </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.604 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.03 </td>\n       <td style=\"text-align:right;width: 5em; \"> 20.0 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    \n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-30-1.png){width=90%}\n    :::\n    :::\n\n\n\n    a.  What are the null and alternative hypotheses for evaluating whether the slope of the model predicting height from shoulder girth is differen than 0.\n\n    b.  Using the histogram which describes the distribution of slopes when the null hypothesis is true, find the p-value and conclude the hypothesis test in the context of the problem (use words like shoulder girth and height).\n\n    c.  Is the conclusion based on the histogram of randomized slopes consistent with the conclusion which would have been obtained using the mathematical model?\n        Explain your reasoning.\n\n\\clearpage\n\n2.  **Baby's weight and father's age, randomization test.** US Department of Health and Human Services, Centers for Disease Control and Prevention collect information on births recorded in the country.\n    The data used here are a random sample of 1000 births from 2014.\n    Here, we study the relationship between the father's age and the weight of the baby.[^_24-ex-inf-model-slr-2]\n    [@data:births14] Shown below are the linear model output for predicting baby's weight (in pounds) from father's age (in years) and the histogram of slopes from 1000 randomized datasets (1000 times, `weight` was permuted and regressed against `fage`).\n    The red vertical line is drawn at the observed slope value which was produced in the linear model output.\n\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> 7.101 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.199 </td>\n       <td style=\"text-align:right;width: 5em; \"> 35.674 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> fage </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.005 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.006 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.757 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.4495 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    \n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-31-1.png){width=90%}\n    :::\n    :::\n\n\n\n    a.  What are the null and alternative hypotheses for evaluating whether the slope of the model for predicting baby's weight from father's age is different than 0?\n\n    b.  Using the histogram which describes the distribution of slopes when the null hypothesis is true, find the p-value and conclude the hypothesis test in the context of the problem (use words like father's age and weight of baby).\n        What does the conclusion of your test say about whether the father's age is a useful predictor of baby's weight?\n\n    c.  Is the conclusion based on the histogram of randomized slopes consistent with the conclusion which would have been obtained using the mathematical model?\n        Explain your reasoning.\n\n\\clearpage\n\n3.  **Body measurements, mathematical test.** The scatterplot and least squares summary below show the relationship between weight measured in kilograms and height measured in centimeters of 507 physically active individuals.\n    [@Heinz:2003]\n    \n    :::: {layout=\"[0.4, 0.6]\"}\n\n    :::{#plot}\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-32-1.png){width=100%}\n    :::\n    :::\n\n\n    :::\n    \n    :::{#output}\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 6em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 4em; \"> -105.01 </td>\n       <td style=\"text-align:right;width: 4em; \"> 7.54 </td>\n       <td style=\"text-align:right;width: 3em; \"> -13.9 </td>\n       <td style=\"text-align:right;width: 3em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 6em; font-family: monospace;\"> hgt </td>\n       <td style=\"text-align:right;width: 4em; \"> 1.02 </td>\n       <td style=\"text-align:right;width: 4em; \"> 0.04 </td>\n       <td style=\"text-align:right;width: 3em; \"> 23.1 </td>\n       <td style=\"text-align:right;width: 3em; \"> &lt;0.0001 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n\n    :::\n    \n    ::::\n\n    a.  Describe the relationship between height and weight.\n\n    b.  Write the equation of the regression line.\n        Interpret the slope and intercept in context.\n\n    c.  Do the data provide convincing evidence that the true slope parameter is different than 0?\n        State the null and alternative hypotheses, report the p-value (using a mathematical model), and state your conclusion.\n\n    d.  The correlation coefficient for height and weight is 0.72.\n        Calculate $R^2$ and interpret it in context.\n\n\\vfill\n\n4.  **Baby's weight and father's age, mathematical test.** Is the father's age useful in predicting the baby's weight?\n    The scatterplot and least squares summary below show the relationship between baby's weight (measured in pounds) and father's age for a random sample of babies.\n    [@data:births14]\n    \n    :::: {layout=\"[0.4, 0.6]\"}\n\n    :::{#plot}\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-34-1.png){width=100%}\n    :::\n    :::\n\n\n    :::\n    \n    :::{#output}\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 6em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 4em; \"> 7.1042 </td>\n       <td style=\"text-align:right;width: 4em; \"> 0.1936 </td>\n       <td style=\"text-align:right;width: 3em; \"> 36.698 </td>\n       <td style=\"text-align:right;width: 3em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 6em; font-family: monospace;\"> fage </td>\n       <td style=\"text-align:right;width: 4em; \"> 0.0047 </td>\n       <td style=\"text-align:right;width: 4em; \"> 0.0061 </td>\n       <td style=\"text-align:right;width: 3em; \"> 0.779 </td>\n       <td style=\"text-align:right;width: 3em; \"> 0.4359 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n\n    :::\n    ::::\n\n    a.  What is the predicted weight of a baby whose father is 30 years old?\n\n    b.  Do the data provide convincing evidence that the model for predicting baby weights from father's age has a slope different than 0?\n        State the null and alternative hypotheses, report the p-value (using a mathematical model), and state your conclusion.\n\n    c.  Based on your conclusion, is father's age a useful predictor of baby's weight?\n\n\\vfill\n\n\\clearpage\n\n5.  **Body measurements, bootstrap percentile interval.** In order to estimate the slope of the model predicting height based on shoulder girth (circumference of shoulders measured over deltoid muscles), 1,000 bootstrap samples are taken from a dataset of body measurements from 507 people.\n    A linear model predicting height based on shoulder girth is fit to each bootstrap sample, and the slope is estimated.\n    A histogram of these slopes is shown below.\n    [@Heinz:2003]\n\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-36-1.png){width=90%}\n    :::\n    :::\n\n\n\n    a.  Using the bootstrap percentile method and the histogram above, find a 98% confidence interval for the slope parameter.\n\n    b.  Interpret the confidence interval in the context of the problem.\n\n\\vfill\n\n6.  **Baby's weight and father's age, bootstrap percentile interval.** US Department of Health and Human Services, Centers for Disease Control and Prevention collect information on births recorded in the country.\n    The data used here are a random sample of 1000 births from 2014.\n    Here, we study the relationship between the father's age and the weight of the baby.\n    Below is the bootstrap distribution of the slope statistic from 1,000 different bootstrap samples of the data.\n    [@data:births14]\n\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-37-1.png){width=90%}\n    :::\n    :::\n\n\n\n    a.  Using the bootstrap percentile method and the histogram above, find a 95% confidence interval for the slope parameter.\n\n    b.  Interpret the confidence interval in the context of the problem.\n\n\\vfill\n\n\\clearpage\n\n7.  **Body measurements, standard error bootstrap interval.** A linear model is built to predict height based on shoulder girth (circumference of shoulders measured over deltoid muscles), both measured in centimeters.\n    [@Heinz:2003] Shown below are the linear model output for predicting height from shoulder girth and the bootstrap distribution of the slope statistic from 1,000 different bootstrap samples of the data.\n\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> 105.832 </td>\n       <td style=\"text-align:right;width: 5em; \"> 3.27 </td>\n       <td style=\"text-align:right;width: 5em; \"> 32.3 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> sho_gi </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.604 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.03 </td>\n       <td style=\"text-align:right;width: 5em; \"> 20.0 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n\n    \n    :::: {layout=\"[0.48, -0.02, 0.5]\"}\n\n    :::{#questions}\n    a.  Using the histogram, approximate the standard error of the slope statistic (that is, quantify the variability of the slope statistic from sample to sample).\n\n    b.  Find a 98% bootstrap SE confidence interval for the slope parameter.\n\n    c.  Interpret the confidence interval in the context of the problem.\n    :::\n    \n    :::{#plot}\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-39-1.png){width=100%}\n    :::\n    :::\n\n\n    :::\n    ::::\n\n\\vfill\n\n8.  **Baby's weight and father's age, standard error bootstrap interval.** US Department of Health and Human Services, Centers for Disease Control and Prevention collect information on births recorded in the country.\n    The data used here are a random sample of 1000 births from 2014.\n    Here, we study the relationship between the father's age and the weight of the baby.\n    [@data:births14] Shown below are the linear model output for predicting baby's weight (in pounds) from father's age (in years) and the the bootstrap distribution of the slope statistic from 1000 different bootstrap samples of the data.\n\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> 7.101 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.199 </td>\n       <td style=\"text-align:right;width: 5em; \"> 35.674 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> fage </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.005 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.006 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.757 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.4495 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n\n    \n    :::: {layout=\"[0.48, -0.02, 0.5]\"}\n\n    :::{#questions}\n    a.  Using the histogram, approximate the standard error of the slope statistic (that is, quantify the variability of the slope statistic from sample to sample).\n\n    b.  Find a 95% bootstrap SE confidence interval for the slope parameter.\n\n    c.  Interpret the confidence interval in the context of the problem.\n    :::\n    \n    :::{#plot}\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-41-1.png){width=100%}\n    :::\n    :::\n\n\n    :::\n    ::::\n\n\\vfill\n\n\\clearpage\n\n9.  **Body measurements, conditions.** The scatterplot below shows the residuals (on the y-axis) from the linear model of weight vs. height from a dataset of body measurements from 507 physically active individuals.\n    The x-axis is the height of the individuals, in cm.\n    [@Heinz:2003]\n\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-42-1.png){width=100%}\n    :::\n    :::\n\n\n\n    a.  For these data, $R^2$ is 51.84%.\n        What is the value of the correlation coefficient?\n        How can you tell if it is positive or negative?\n        (Hint: you may need to look at a previous exercise.)\n\n    b.  Examine the residual plot.\n        What do you observe?\n        Is a simple least squares fit appropriate for these data?\n        Which of the LINE conditions are met or not met?\n\n\\vfill\n\n10. **Baby's weight and father's age, conditions.** The scatterplot below shows the residuals (on the y-axis) from the linear model of baby's weight (measured in pounds) vs. father's age for a random sample of babies.\n    Father's age is on the x-axis.\n    [@data:births14]\n\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-43-1.png){width=100%}\n    :::\n    :::\n\n\n\n    a.  For these data, $R^2$ is 0.09%.\n        What is the value of the correlation coefficient?\n        How can you tell if it is positive or negative?\n        (Hint: you may need to look at a previous exercise.)\n\n    b.  Examine the residual plot.\n        What do you observe?\n        Is a simple least squares fit appropriate for these data?\n        Which of the LINE conditions are met or not met?\n\n\\vfill\n\n\\clearpage\n\n11. **Murders and poverty, randomization test.** The following regression output is for predicting annual murders per million (`annual_murders_per_mil`) from percentage living in poverty (`perc_pov`) in a random sample of 20 metropolitan areas.\n    Shown below are the linear model output for predicting annual murders per million from percentage living in poverty for metropolitan areas and the histogram of slopes from 1000 randomized datasets (1000 times, `annual_murders_per_mil` was permuted and regressed against `perc_pov`).\n    The red vertical line is drawn at the observed slope value which was produced in the linear model output.\n    \n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> -29.90 </td>\n       <td style=\"text-align:right;width: 5em; \"> 7.79 </td>\n       <td style=\"text-align:right;width: 5em; \"> -3.84 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.0012 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> perc_pov </td>\n       <td style=\"text-align:right;width: 5em; \"> 2.56 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.39 </td>\n       <td style=\"text-align:right;width: 5em; \"> 6.56 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n\n\n    :::: {layout=\"[0.48, -0.02, 0.5]\"}\n    \n    :::{#questions}\n    a.  What are the null and alternative hypotheses for evaluating whether the slope of the model for predicting annual murder rate from poverty percentage is different than 0?\n\n    b.  Using the histogram which describes the distribution of slopes when the null hypothesis is true, find the p-value and conclude the hypothesis test in the context of the problem (use words like murder rate and poverty).\n\n    c.  Is the conclusion based on the histogram of randomized slopes consistent with the conclusion which would have been obtained using the mathematical model?\n        Explain your reasoning.\n    :::\n\n    :::{#plot}\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-45-1.png){width=100%}\n    :::\n    :::\n\n\n    :::\n    ::::\n\n12. **Murders and poverty, mathematical test.** The table below shows the output of a linear model annual murders per million (`annual_murders_per_mil`) from percentage living in poverty (`perc_pov`) in a random sample of 20 metropolitan areas.\n\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> -29.90 </td>\n       <td style=\"text-align:right;width: 5em; \"> 7.79 </td>\n       <td style=\"text-align:right;width: 5em; \"> -3.84 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.0012 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> perc_pov </td>\n       <td style=\"text-align:right;width: 5em; \"> 2.56 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.39 </td>\n       <td style=\"text-align:right;width: 5em; \"> 6.56 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n\n\n    a.  What are the hypotheses for evaluating whether the slope of the model predicting annual murder rate from poverty percentage is different than 0?\n\n    b.  State the conclusion of the hypothesis test from part (a) in context.\n        What does this say about whether poverty percentage is a useful predictor of annual murder rate?\n\n    c.  Calculate a 95% confidence interval for the slope of poverty percentage, and interpret it in context.\n\n    d.  Do your results from the hypothesis test and the confidence interval agree?\n        Explain your reasoning.\n\n\\clearpage\n\n13. **Murders and poverty, bootstrap percentile interval.** Data on annual murders per million (`annual_murders_per_mil`) and percentage living in poverty (`perc_pov`) is collected from a random sample of 20 metropolitan areas.\n    Using these data we want to estimate the slope of the model predicting `annual_murders_per_mil` from `perc_pov`.\n    We take 1,000 bootstrap samples of the data and fit a linear model predicting `annual_murders_per_mil` from `perc_pov` to each bootstrap sample.\n    A histogram of these slopes is shown below.\n\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-47-1.png){width=90%}\n    :::\n    :::\n\n\n\n    a.  Using the percentile bootstrap method and the histogram above, find a 90% confidence interval for the slope parameter.\n\n    b.  Interpret the confidence interval in the context of the problem.\n\n14. **Murders and poverty, standard error bootstrap interval.** A linear model is built to predict annual murders per million (`annual_murders_per_mil`) from percentage living in poverty (`perc_pov`) in a random sample of 20 metropolitan areas.\n    Shown below are the standard linear model output for predicting annual murders per million from percentage living in poverty for metropolitan areas and the bootstrap distribution of the slope statistic from 1000 different bootstrap samples of the data.\n\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> -29.90 </td>\n       <td style=\"text-align:right;width: 5em; \"> 7.79 </td>\n       <td style=\"text-align:right;width: 5em; \"> -3.84 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.0012 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> perc_pov </td>\n       <td style=\"text-align:right;width: 5em; \"> 2.56 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.39 </td>\n       <td style=\"text-align:right;width: 5em; \"> 6.56 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    \n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-48-1.png){width=90%}\n    :::\n    :::\n\n\n\n    a.  Using the histogram, approximate the standard error of the slope statistic (that is, quantify the variability of the slope statistic from sample to sample).\n\n    b.  Find a 90% bootstrap SE confidence interval for the slope parameter.\n\n    c.  Interpret the confidence interval in the context of the problem.\n\n\\clearpage\n\n15. **Murders and poverty, conditions.** The scatterplot below shows the annual murders per million vs. percentage living in poverty in a random sample of 20 metropolitan areas.\n    The second figure plots residuals on the y-axis and percent living in poverty on the x-axis.\n\n\n\n    ::: {.cell layout-ncol=\"2\"}\n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-49-1.png){width=100%}\n    :::\n    \n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-49-2.png){width=100%}\n    :::\n    :::\n\n\n\n    a.  For these data, $R^2$ is 70.56%.\n        What is the value of the correlation coefficient?\n        How can you tell if it is positive or negative?\n\n    b.  Examine the residual plot.\n        What do you observe?\n        Is a simple least squares fit appropriate for the data?\n        Which of the LINE conditions are met or not met?\n\n\\vfill\n\n16. **I heart cats.** Researchers collected data on heart and body weights of 144 domestic adult cats.\n    The table below shows the output of a linear model predicting heart weight (measured in grams) from body weight (measured in kilograms) of these cats.[^_24-ex-inf-model-slr-3]\n\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> -0.357 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.692 </td>\n       <td style=\"text-align:right;width: 5em; \"> -0.515 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.6072 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> Bwt </td>\n       <td style=\"text-align:right;width: 5em; \"> 4.034 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.250 </td>\n       <td style=\"text-align:right;width: 5em; \"> 16.119 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n\n\n    a.  What are the hypotheses for evaluating whether body weight is positively associated with heart weight in cats?\n\n    b.  State the conclusion of the hypothesis test from part (a) in context.\n\n    c.  Calculate a 95% confidence interval for the slope of body weight, and interpret it in context.\n\n    d.  Do your results from the hypothesis test and the confidence interval agree?\n        Explain your reasoning.\n\n\\vfill\n\n\\clearpage\n\n17. **Beer and blood alcohol content.** Many people believe that weight, drinking habits, and many other factors are much more important in predicting blood alcohol content (BAC) than simply considering the number of drinks a person consumed.\n    Here we examine data from sixteen student volunteers at Ohio State University who each drank a randomly assigned number of cans of beer.\n    These students were evenly divided between men and women, and they differed in weight and drinking habits.\n    Thirty minutes later, a police officer measured their blood alcohol content (BAC) in grams of alcohol per deciliter of blood.\n    The scatterplot and regression table summarize the findings.\n    [^_24-ex-inf-model-slr-4] [@Malkevitc+Lesser:2008]\n\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-51-1.png){width=90%}\n    :::\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 5em; \"> -0.0127 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.0126 </td>\n       <td style=\"text-align:right;width: 5em; \"> -1.00 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.332 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 10em; font-family: monospace;\"> beers </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.0180 </td>\n       <td style=\"text-align:right;width: 5em; \"> 0.0024 </td>\n       <td style=\"text-align:right;width: 5em; \"> 7.48 </td>\n       <td style=\"text-align:right;width: 5em; \"> &lt;0.0001 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n\n\n    a.  Describe the relationship between the number of cans of beer and BAC.\n\n    b.  Write the equation of the regression line.\n        Interpret the slope and intercept in context.\n\n    c.  Do the data provide convincing evidence that drinking more cans of beer is associated with an increase in blood alcohol?\n        State the null and alternative hypotheses, report the p-value, and state your conclusion.\n\n    d.  The correlation coefficient for number of cans of beer and BAC is 0.89.\n        Calculate $R^2$ and interpret it in context.\n\n    e.  Suppose we visit a bar in our own town, ask people how many drinks they have had, and also measure their BAC.\n        Would the relationship between number of drinks and BAC would be as strong as the relationship found in the Ohio State study?\n        Why?\n\n\\clearpage\n\n18. **Urban homeowners, conditions.** The scatterplot below shows the percent of families who own their home vs. the percent of the population living in urban areas.\n    [@data:urbanOwner] There are 52 observations, each corresponding to a state in the US.\n    Puerto Rico and District of Columbia are also included.\n    The second figure plots residuals on the y-axis and percent of the population living in urban areas on the x-axis.\n\n\n\n    ::: {.cell layout-ncol=\"2\"}\n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-52-1.png){width=100%}\n    :::\n    \n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-52-2.png){width=100%}\n    :::\n    :::\n\n\n\n    a.  For these data, $R^2$ is 29.16%.\n        What is the value of the correlation coefficient?\n        How can you tell if it is positive or negative?\n\n    b.  Examine the residual plot.\n        What do you observe?\n        Is a simple least squares fit appropriate for the data?\n        Which of the LINE conditions are met or not met?\n\n\\vfill\n\n19. **I heart cats, LINE conditions.** Researchers collected data on heart and body weights of 144 domestic adult cats.\n    The figure below shows the output of the predicted values and residuals generated from a linear model predicting heart weight (measured in grams) from body weight (measured in kilograms) of these cats.\n\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-53-1.png){width=90%}\n    :::\n    :::\n\n\n\n    a.  Examine the residual plot.\n        Notice that for the small predicted values the residuals have a smaller magnitude than the larger residuals seen with the larger predicted values.\n        The change in magnitude of the residuals across the predicted values is an indication of violation of which LINE technical condition?\n\n    b.  If the LINE condtion described in part (a) is violated, might it lead to an incorrect conclusion about the model (i.e., the least squares regression line itself), the inference of the model (i.e., the p-value associated with the least squares regression line), neither, or both?\n        Explain your reasoning.\n\n\\vfill\n\n\\clearpage\n\n20. **Body measurements, mathematical test.** The scatterplot and least squares summary below show the relationship between weight measured in kilograms and height measured in centimeters of 507 physically active individuals.\n    [@Heinz:2003]\n\n    :::: {layout=\"[0.4, 0.6]\"}\n\n    :::{#plot}\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-54-1.png){width=100%}\n    :::\n    :::\n\n\n    :::\n    \n    :::{#output}\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;width: 6em; font-family: monospace;\"> (Intercept) </td>\n       <td style=\"text-align:right;width: 4em; \"> -105.01 </td>\n       <td style=\"text-align:right;width: 4em; \"> 7.54 </td>\n       <td style=\"text-align:right;width: 3em; \"> -13.9 </td>\n       <td style=\"text-align:right;width: 3em; \"> &lt;0.0001 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;width: 6em; font-family: monospace;\"> hgt </td>\n       <td style=\"text-align:right;width: 4em; \"> 1.02 </td>\n       <td style=\"text-align:right;width: 4em; \"> 0.04 </td>\n       <td style=\"text-align:right;width: 3em; \"> 23.1 </td>\n       <td style=\"text-align:right;width: 3em; \"> &lt;0.0001 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n\n    :::\n    ::::\n\n    a.  Describe the relationship between height and weight.\n\n    b.  Write the equation of the regression line.\n        Interpret the slope and intercept in context.\n\n    c.  Do the data provide convincing evidence that the true slope parameter is different than 0?\n        State the null and alternative hypotheses, report the p-value (using a mathematical model), and state your conclusion.\n\n    d.  The correlation coefficient for height and weight is 0.72.\n        Calculate $R^2$ and interpret it in context.\n\n\\vspace{5mm}\n\n21. **Beer and blood alcohol content, LINE conditions.** The figure below shows the output of the predicted values and residuals generated from a linear model predicting the blood alcohol content (BAC) from number of cans of beer drunk by sixteen student volunteers at Ohio State University.[^_24-ex-inf-model-slr-5]\n    [@Malkevitc+Lesser:2008]\n\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![](24-inf-model-slr_files/figure-html/unnamed-chunk-56-1.png){width=90%}\n    :::\n    :::\n\n\n\n    a.  Examine the residual plot.\n        Notice that it is difficult to identify any convincing patterns for or against violation of the LINE technical conditions.\n        What is it about the residual plot that makes it difficult to assess the LINE technical conditions?\n\n    b.  Is there anything about the residual plot which would make you hesitate about using the linear model for inference about all students?\n        Is there anything about the experimental design of the study which would make you hesitate about using the linear model for inference about all students?\n\n[^_24-ex-inf-model-slr-1]: The [`bdims`](http://openintrostat.github.io/openintro/reference/bdims.html) data used in this exercise can be found in the [**openintro**](http://openintrostat.github.io/openintro) R package.\n\n[^_24-ex-inf-model-slr-2]: The [`births14`](http://openintrostat.github.io/openintro/reference/births14.html) data used in this exercise can be found in the [**openintro**](http://openintrostat.github.io/openintro) R package.\n\n[^_24-ex-inf-model-slr-3]: The [`cats`](https://stat.ethz.ch/R-manual/R-patched/library/MASS/html/cats.html) data used in this exercise can be found in the [**MASS**](https://cran.r-project.org/web/packages/MASS/index.html) R package.\n\n[^_24-ex-inf-model-slr-4]: The [`bac`](http://openintrostat.github.io/openintro/reference/bac.html) data used in this exercise can be found in the [**openintro**](http://openintrostat.github.io/openintro) R package.\n\n[^_24-ex-inf-model-slr-5]: The [`bac`](http://openintrostat.github.io/openintro/reference/bac.html) data used in this exercise can be found in the [**openintro**](http://openintrostat.github.io/openintro) R package.\n\n\n:::\n",
    "supporting": [
      "24-inf-model-slr_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n<link href=\"site_libs/bsTable-3.3.7/bootstrapTable.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/bsTable-3.3.7/bootstrapTable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}