<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Mine Çetinkaya-Rundel and Johanna Hardin">
<title>7&nbsp; Linear regression with a single predictor – Introduction to Modern Statistics (2e)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./model-mlr.html" rel="next">
<link href="./regression-modeling.html" rel="prev">
<link href="./images/openintro.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-c115713b74ff8bcd8ed35270603a4893.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b48b13b17e828e7fee5d86eb98a32420.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-c115713b74ff8bcd8ed35270603a4893.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-41ebc7e69ef0285b0c3541b9cc726a5c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-790f3f5e7e2e01ab58e527b05f631cee.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-41ebc7e69ef0285b0c3541b9cc726a5c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="site_libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="site_libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./regression-modeling.html">Regression modeling</a></li><li class="breadcrumb-item"><a href="./model-slr.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Linear regression with a single predictor</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Modern Statistics (2e)</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/openintrostat/ims/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome to IMS2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./authors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Authors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./introduction-to-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-hello.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Hello data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Study design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Applications: Data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./exploratory-data-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory data analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./explore-categorical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Exploring categorical data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./explore-numerical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Exploring numerical data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./explore-applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Applications: Explore</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./regression-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-slr.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Linear regression with a single predictor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-mlr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Linear regression with multiple predictors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Logistic regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Applications: Model</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./foundations-of-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Foundations of inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations-randomization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Hypothesis testing with randomization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations-bootstrapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Confidence intervals with bootstrapping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations-mathematical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Inference with mathematical models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations-errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Decision Errors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foundations-applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Applications: Foundations</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./statistical-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-one-prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Inference for a single proportion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-two-props.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Inference for comparing two proportions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Inference for two-way tables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-one-mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Inference for a single mean</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-two-means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Inference for comparing two independent means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-paired-means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Inference for comparing paired means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-many-means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Inference for comparing many means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Applications: Infer</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./inferential-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inferential modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inf-model-slr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Inference for linear regression with a single predictor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inf-model-mlr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Inference for linear regression with multiple predictors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inf-model-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Inference for logistic regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inf-model-applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Applications: Model and infer</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise-solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Exercise solutions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#sec-fit-line-res-cor" id="toc-sec-fit-line-res-cor" class="nav-link active" data-scroll-target="#sec-fit-line-res-cor"><span class="header-section-number">7.1</span> Fitting a line, residuals, and correlation</a>
  <ul class="collapse">
<li><a href="#fitting-a-line-to-data" id="toc-fitting-a-line-to-data" class="nav-link" data-scroll-target="#fitting-a-line-to-data"><span class="header-section-number">7.1.1</span> Fitting a line to data</a></li>
  <li><a href="#using-linear-regression-to-predict-possum-head-lengths" id="toc-using-linear-regression-to-predict-possum-head-lengths" class="nav-link" data-scroll-target="#using-linear-regression-to-predict-possum-head-lengths"><span class="header-section-number">7.1.2</span> Using linear regression to predict possum head lengths</a></li>
  <li><a href="#sec-resids" id="toc-sec-resids" class="nav-link" data-scroll-target="#sec-resids"><span class="header-section-number">7.1.3</span> Residuals</a></li>
  <li><a href="#describing-linear-relationships-with-correlation" id="toc-describing-linear-relationships-with-correlation" class="nav-link" data-scroll-target="#describing-linear-relationships-with-correlation"><span class="header-section-number">7.1.4</span> Describing linear relationships with correlation</a></li>
  </ul>
</li>
  <li>
<a href="#sec-least-squares-regression" id="toc-sec-least-squares-regression" class="nav-link" data-scroll-target="#sec-least-squares-regression"><span class="header-section-number">7.2</span> Least squares regression</a>
  <ul class="collapse">
<li><a href="#gift-aid-for-first-year-at-elmhurst-college" id="toc-gift-aid-for-first-year-at-elmhurst-college" class="nav-link" data-scroll-target="#gift-aid-for-first-year-at-elmhurst-college"><span class="header-section-number">7.2.1</span> Gift aid for first-year at Elmhurst College</a></li>
  <li><a href="#an-objective-measure-for-finding-the-best-line" id="toc-an-objective-measure-for-finding-the-best-line" class="nav-link" data-scroll-target="#an-objective-measure-for-finding-the-best-line"><span class="header-section-number">7.2.2</span> An objective measure for finding the best line</a></li>
  <li><a href="#finding-and-interpreting-the-least-squares-line" id="toc-finding-and-interpreting-the-least-squares-line" class="nav-link" data-scroll-target="#finding-and-interpreting-the-least-squares-line"><span class="header-section-number">7.2.3</span> Finding and interpreting the least squares line</a></li>
  <li><a href="#extrapolation-is-treacherous" id="toc-extrapolation-is-treacherous" class="nav-link" data-scroll-target="#extrapolation-is-treacherous"><span class="header-section-number">7.2.4</span> Extrapolation is treacherous</a></li>
  <li><a href="#sec-r-squared" id="toc-sec-r-squared" class="nav-link" data-scroll-target="#sec-r-squared"><span class="header-section-number">7.2.5</span> Describing the strength of a fit</a></li>
  <li><a href="#sec-categorical-predictor-two-levels" id="toc-sec-categorical-predictor-two-levels" class="nav-link" data-scroll-target="#sec-categorical-predictor-two-levels"><span class="header-section-number">7.2.6</span> Categorical predictors with two levels</a></li>
  </ul>
</li>
  <li><a href="#sec-outliers-in-regression" id="toc-sec-outliers-in-regression" class="nav-link" data-scroll-target="#sec-outliers-in-regression"><span class="header-section-number">7.3</span> Outliers in linear regression</a></li>
  <li>
<a href="#sec-chp7-review" id="toc-sec-chp7-review" class="nav-link" data-scroll-target="#sec-chp7-review"><span class="header-section-number">7.4</span> Chapter review</a>
  <ul class="collapse">
<li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">7.4.1</span> Summary</a></li>
  <li><a href="#terms" id="toc-terms" class="nav-link" data-scroll-target="#terms"><span class="header-section-number">7.4.2</span> Terms</a></li>
  </ul>
</li>
  <li><a href="#sec-chp7-exercises" id="toc-sec-chp7-exercises" class="nav-link" data-scroll-target="#sec-chp7-exercises"><span class="header-section-number">7.5</span> Exercises</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/openintrostat/ims/edit/main/model-slr.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/openintrostat/ims/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./regression-modeling.html">Regression modeling</a></li><li class="breadcrumb-item"><a href="./model-slr.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Linear regression with a single predictor</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-model-slr" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Linear regression with a single predictor</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="chapterintro">
<p>Linear regression is a very powerful statistical technique. Many people have some familiarity with regression models just from reading the news, where straight lines are overlaid on scatterplots. Linear models can be used for prediction or to describe the relationship between two numerical variables, assuming there is a linear relationship between them.</p>
</div>
<section id="sec-fit-line-res-cor" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="sec-fit-line-res-cor">
<span class="header-section-number">7.1</span> Fitting a line, residuals, and correlation</h2>
<p>When considering linear regression, it’s helpful to think deeply about the line fitting process. In this section, we define the form of a linear model, explore criteria for what makes a good fit, and introduce a new statistic called <em>correlation</em>.</p>
<section id="fitting-a-line-to-data" class="level3" data-number="7.1.1"><h3 data-number="7.1.1" class="anchored" data-anchor-id="fitting-a-line-to-data">
<span class="header-section-number">7.1.1</span> Fitting a line to data</h3>
<p><a href="#fig-perfLinearModel" class="quarto-xref">Figure&nbsp;<span>7.1</span></a> shows two variables whose relationship can be modeled perfectly with a straight line. The equation for the line is <span class="math inline">\(y = 5 + 64.96 x.\)</span> Consider what a perfect linear relationship means: we know the exact value of <span class="math inline">\(y\)</span> just by knowing the value of <span class="math inline">\(x.\)</span> A perfect linear relationship is unrealistic in almost any natural process. For example, if we took family income <span class="math inline">\((x),\)</span> this value would provide some useful information about how much financial support a college may offer a prospective student <span class="math inline">\((y.)\)</span> However, the prediction would be far from perfect, since other factors play a role in financial support beyond a family’s finances.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-perfLinearModel" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A scatterplot showing a perfect linear relationship between number of  stocks to purchase on the x-axis and total cost of the share purchase  on the y-axis. ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-perfLinearModel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-perfLinearModel-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;7.1: Requests from twelve separate buyers were simultaneously placed with a trading company to purchase Target Corporation stock (ticker TGT, December 28th, 2018), and the total cost of the shares were reported. Because the cost is computed using a linear formula, the linear fit is perfect."><img src="model-slr_files/figure-html/fig-perfLinearModel-1.png" class="img-fluid figure-img" style="width:90.0%" alt="A scatterplot showing a perfect linear relationship between number of  stocks to purchase on the x-axis and total cost of the share purchase  on the y-axis. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-perfLinearModel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.1: Requests from twelve separate buyers were simultaneously placed with a trading company to purchase Target Corporation stock (ticker TGT, December 28th, 2018), and the total cost of the shares were reported. Because the cost is computed using a linear formula, the linear fit is perfect.
</figcaption></figure>
</div>
</div>
</div>
<p>Linear regression is the statistical method for fitting a line to data where the relationship between two variables, <span class="math inline">\(x\)</span> and <span class="math inline">\(y,\)</span> can be modeled by a straight line with some error:</p>
<p><span class="math display">\[
y = b_0 + b_1 \ x + e
\]</span></p>
<p>The values <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> represent the model’s intercept and slope, respectively, and the error is represented by <span class="math inline">\(e.\)</span> These values are calculated based on the data, i.e., they are sample statistics. If the observed data is a random sample from a target population that we are interested in making inferences about, these values are considered to be point estimates for the population parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1.\)</span> We will discuss how to make inferences about parameters of a linear model based on sample statistics in <a href="inf-model-slr.html" class="quarto-xref"><span>Chapter 24</span></a>.</p>
<div class="pronunciation">
<p>The Greek letter <span class="math inline">\(\beta\)</span> is pronounced <em>beta</em>, listen to the pronunciation <a href="https://youtu.be/PStgY5AcEIw?t=7">here</a>.</p>
</div>
<p>When we use <span class="math inline">\(x\)</span> to predict <span class="math inline">\(y,\)</span> we usually call <span class="math inline">\(x\)</span> the <strong>predictor</strong> variable and we call <span class="math inline">\(y\)</span> the <strong>outcome</strong>. We also often drop the <span class="math inline">\(e\)</span> term when writing down the model since our main focus is often on the prediction of the average outcome.</p>
<p>It is rare for all of the data to fall perfectly on a straight line. Instead, it’s more common for data to appear as a <em>cloud of points</em>, such as those examples shown in <a href="#fig-imperfLinearModel" class="quarto-xref">Figure&nbsp;<span>7.2</span></a>. In each case, the data fall around a straight line, even if none of the observations fall exactly on the line. The first plot shows a relatively strong downward linear trend, where the remaining variability in the data around the line is minor relative to the strength of the relationship between <span class="math inline">\(x\)</span> and <span class="math inline">\(y.\)</span> The second plot shows an upward trend that, while evident, is not as strong as the first. The last plot shows a very weak downward trend in the data, so slight we can hardly notice it. In each of these examples, we will have some uncertainty regarding our estimates of the model parameters, <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1.\)</span> For instance, we might wonder, should we move the line up or down a little, or should we tilt it more or less? As we move forward in this chapter, we will learn about criteria for line-fitting, and we will also learn about the uncertainty associated with estimates of model parameters.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-imperfLinearModel" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Three scatterplots with fabricated data. The first panel shows a  strong negative linear relationship. The second panel shows a moderate  positive linear relationship. The last panel shows no relationship  between the x and y variables. ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-imperfLinearModel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-imperfLinearModel-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;7.2: Three datasets where a linear model may be useful even though the data do not all fall exactly on the line."><img src="model-slr_files/figure-html/fig-imperfLinearModel-1.png" class="img-fluid figure-img" style="width:100.0%" alt="Three scatterplots with fabricated data. The first panel shows a  strong negative linear relationship. The second panel shows a moderate  positive linear relationship. The last panel shows no relationship  between the x and y variables. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-imperfLinearModel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.2: Three datasets where a linear model may be useful even though the data do not all fall exactly on the line.
</figcaption></figure>
</div>
</div>
</div>
<p>There are also cases where fitting a straight line to the data, even if there is a clear relationship between the variables, is not helpful. One such case is shown in <a href="#fig-notGoodAtAllForALinearModel" class="quarto-xref">Figure&nbsp;<span>7.3</span></a> where there is a very clear relationship between the variables even though the trend is not linear. We discuss nonlinear trends in this chapter and the next, but details of fitting nonlinear models are saved for a later course.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-notGoodAtAllForALinearModel" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A scatterplot showing a perfect quadratic relationship between angle of  incline on the x-axis and distance traveled on the y-axis. The line of  best fit is superimposed as a perfectly horizontal line. That is to say, the variables are clearly related, but they do not have a linear  relationship. ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-notGoodAtAllForALinearModel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-notGoodAtAllForALinearModel-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;7.3: The best fitting line for these data is flat, which is not a useful way to describe the non-linear relationship. These data are from a physics experiment."><img src="model-slr_files/figure-html/fig-notGoodAtAllForALinearModel-1.png" class="img-fluid figure-img" style="width:90.0%" alt="A scatterplot showing a perfect quadratic relationship between angle of  incline on the x-axis and distance traveled on the y-axis. The line of  best fit is superimposed as a perfectly horizontal line. That is to say, the variables are clearly related, but they do not have a linear  relationship. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-notGoodAtAllForALinearModel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.3: The best fitting line for these data is flat, which is not a useful way to describe the non-linear relationship. These data are from a physics experiment.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="using-linear-regression-to-predict-possum-head-lengths" class="level3" data-number="7.1.2"><h3 data-number="7.1.2" class="anchored" data-anchor-id="using-linear-regression-to-predict-possum-head-lengths">
<span class="header-section-number">7.1.2</span> Using linear regression to predict possum head lengths</h3>
<p>Brushtail possums are marsupials that live in Australia, and a photo of one is shown in <a href="#fig-brushtail-possum" class="quarto-xref">Figure&nbsp;<span>7.4</span></a>. Researchers captured 104 of these animals and took body measurements before releasing the animals back into the wild. We consider two of these measurements: the total length of each possum, from head to tail, and the length of each possum’s head.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-brushtail-possum" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Photograph of a common brushtail possum of Australia.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-brushtail-possum-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/brushtail-possum/brushtail-possum.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;7.4: The common brushtail possum of Australia. Photo by Greg Schecter, flic.kr/p/9BAFbR, CC BY 2.0 license."><img src="images/brushtail-possum/brushtail-possum.jpg" class="img-fluid figure-img" style="width:50.0%" alt="Photograph of a common brushtail possum of Australia."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-brushtail-possum-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.4: The common brushtail possum of Australia. Photo by Greg Schecter, <a href="https://flic.kr/p/9BAFbR">flic.kr/p/9BAFbR</a>, CC BY 2.0 license.
</figcaption></figure>
</div>
</div>
</div>
<div class="data">
<p>The <a href="http://openintrostat.github.io/openintro/reference/possum.html"><code>possum</code></a> data can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.</p>
</div>
<p><a href="#fig-scattHeadLTotalL" class="quarto-xref">Figure&nbsp;<span>7.5</span></a> shows a scatterplot for the head length (mm) and total length (cm) of the possums. Each point represents a single possum from the data. The head and total length variables are associated: possums with an above average total length also tend to have above average head lengths. While the relationship is not perfectly linear, it could be helpful to partially explain the connection between these variables with a straight line.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-scattHeadLTotalL" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A scatterplot with total length on the x-axis and head length on the  y-axis. The variables show a moderately strong positive linear  relationship. A single observation is circled in red with coordinates  of approximately 84cm of total length and 87mm of head length. ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-scattHeadLTotalL-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-scattHeadLTotalL-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;7.5: A scatterplot showing head length against total length for 104 brushtail possums. A point representing a possum with head length 86.7 mm and total length 84 cm is highlighted."><img src="model-slr_files/figure-html/fig-scattHeadLTotalL-1.png" class="img-fluid figure-img" style="width:90.0%" alt="A scatterplot with total length on the x-axis and head length on the  y-axis. The variables show a moderately strong positive linear  relationship. A single observation is circled in red with coordinates  of approximately 84cm of total length and 87mm of head length. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scattHeadLTotalL-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.5: A scatterplot showing head length against total length for 104 brushtail possums. A point representing a possum with head length 86.7 mm and total length 84 cm is highlighted.
</figcaption></figure>
</div>
</div>
</div>
<p>We want to describe the relationship between head and total length of possum’s with a line. In this example, we will use the total length as the predictor variable, <span class="math inline">\(x,\)</span> to predict a possum’s head length, <span class="math inline">\(y.\)</span> We could fit the linear relationship by eye, as in <a href="#fig-scattHeadLTotalLLine" class="quarto-xref">Figure&nbsp;<span>7.6</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-scattHeadLTotalLLine" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A scatterplot with total length on the x-axis and head length on the  y-axis. The variables show a moderately strong positive linear relationship. A least squares line is superimposed. ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-scattHeadLTotalLLine-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-scattHeadLTotalLLine-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;7.6: A reasonable linear model was fit to represent the relationship between head length and total length."><img src="model-slr_files/figure-html/fig-scattHeadLTotalLLine-1.png" class="img-fluid figure-img" style="width:90.0%" alt="A scatterplot with total length on the x-axis and head length on the  y-axis. The variables show a moderately strong positive linear relationship. A least squares line is superimposed. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scattHeadLTotalLLine-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.6: A reasonable linear model was fit to represent the relationship between head length and total length.
</figcaption></figure>
</div>
</div>
</div>
<p>The equation for this line is</p>
<p><span class="math display">\[
\hat{y} = 41 + 0.59x
\]</span></p>
<p>A “hat” on <span class="math inline">\(y\)</span> is used to signify that this is an estimate. We can use this line to discuss properties of possums. For instance, the equation predicts a possum with a total length of 80 cm will have a head length of</p>
<p><span class="math display">\[
\hat{y} = 41 + 0.59 \times 80 = 88.2
\]</span></p>
<p>The estimate may be viewed as an average: the equation predicts that possums with a total length of 80 cm will have an average head length of 88.2 mm. Absent further information about an 80 cm possum, the prediction for head length that uses the average is a reasonable estimate.</p>
<p>There may be other variables that could help us predict the head length of a possum besides its length. Perhaps the relationship would be a little different for male possums than female possums, or perhaps it would differ for possums from one region of Australia versus another region. <a href="#fig-scattHeadLTotalL-sex-age-1" class="quarto-xref">Figure&nbsp;<span>7.7 (a)</span></a> shows the relationship between total length and head length of brushtail possums, taking into consideration their sex. Male possums (represented by blue triangles) seem to be larger in terms of total length and head length than female possums (represented by red circles). <a href="#fig-scattHeadLTotalL-sex-age-2" class="quarto-xref">Figure&nbsp;<span>7.7 (b)</span></a> shows the same relationship, taking into consideration their age. It’s harder to tell if age changes the relationship between total length and head length for these possums.</p>
<div id="fig-scattHeadLTotalL-sex-age" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-scattHeadLTotalL-sex-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-scattHeadLTotalL-sex-age" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-scattHeadLTotalL-sex-age-1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Two scatterplots, both with total length on the x-axis and head  length on the y-axis. The top plot colors the points by sex where the female possums seem slightly longer with slightly smaller head lengths. The bottom plot is colored by age with no obvious trends between age and lengths. ">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-scattHeadLTotalL-sex-age-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-scattHeadLTotalL-sex-age-1.png" class="lightbox" data-gallery="fig-scattHeadLTotalL-sex-age" title="Figure&nbsp;7.7&nbsp;(a): By sex"><img src="model-slr_files/figure-html/fig-scattHeadLTotalL-sex-age-1.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-scattHeadLTotalL-sex-age" alt="Two scatterplots, both with total length on the x-axis and head  length on the y-axis. The top plot colors the points by sex where the female possums seem slightly longer with slightly smaller head lengths. The bottom plot is colored by age with no obvious trends between age and lengths. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-scattHeadLTotalL-sex-age-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) By sex
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-scattHeadLTotalL-sex-age" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-scattHeadLTotalL-sex-age-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Two scatterplots, both with total length on the x-axis and head  length on the y-axis. The top plot colors the points by sex where the female possums seem slightly longer with slightly smaller head lengths. The bottom plot is colored by age with no obvious trends between age and lengths. ">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-scattHeadLTotalL-sex-age-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-scattHeadLTotalL-sex-age-2.png" class="lightbox" data-gallery="fig-scattHeadLTotalL-sex-age" title="Figure&nbsp;7.7&nbsp;(b): By age"><img src="model-slr_files/figure-html/fig-scattHeadLTotalL-sex-age-2.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-scattHeadLTotalL-sex-age" alt="Two scatterplots, both with total length on the x-axis and head  length on the y-axis. The top plot colors the points by sex where the female possums seem slightly longer with slightly smaller head lengths. The bottom plot is colored by age with no obvious trends between age and lengths. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-scattHeadLTotalL-sex-age-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) By age
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scattHeadLTotalL-sex-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.7: Relationship between total length and head length of brushtail possums, taking into consideration their sex or age.
</figcaption></figure>
</div>
<p>In <a href="model-mlr.html" class="quarto-xref"><span>Chapter 8</span></a>, we’ll learn about how we can include more than one predictor in our model. Before we get there, we first need to better understand how to best build a linear model with one predictor.</p>
</section><section id="sec-resids" class="level3" data-number="7.1.3"><h3 data-number="7.1.3" class="anchored" data-anchor-id="sec-resids">
<span class="header-section-number">7.1.3</span> Residuals</h3>
<p><strong>Residuals</strong> are the leftover variation in the data after accounting for the model fit:</p>
<p><span class="math display">\[
\text{Data} = \text{Fit} + \text{Residual}
\]</span></p>
<p>Each observation will have a residual, and three of the residuals for the linear model we fit for the possum data are shown in <a href="#fig-scattHeadLTotalLLine-highlighted" class="quarto-xref">Figure&nbsp;<span>7.8</span></a>. If an observation is above the regression line, then its residual, the vertical distance from the observation to the line, is positive. Observations below the line have negative residuals. One goal in picking the right linear model is for residuals to be as small as possible.</p>
<p><a href="#fig-scattHeadLTotalLLine-highlighted" class="quarto-xref">Figure&nbsp;<span>7.8</span></a> is almost a replica of <a href="#fig-scattHeadLTotalLLine" class="quarto-xref">Figure&nbsp;<span>7.6</span></a>, with three points from the data highlighted. The observation marked by a red circle has a small, negative residual of about -1; the observation marked by a gray diamond has a large positive residual of about +7; and the observation marked by a pink triangle has a moderate negative residual of about -4. The size of a residual is usually discussed in terms of its absolute value. For example, the residual for the observation marked by a pink triangle is larger than that of the observation marked by a red circle because <span class="math inline">\(|-4|\)</span> is larger than <span class="math inline">\(|-1|.\)</span></p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-scattHeadLTotalLLine-highlighted" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A scatterplot with total length on the x-axis and head length on the  y-axis. A least squares line is superimposed onto the scatterplot. Three individual observations are circled to indicate their vertical  distance from the least square line.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-scattHeadLTotalLLine-highlighted-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-scattHeadLTotalLLine-highlighted-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;7.8: A reasonable linear model was fit to represent the relationship between head length and total length, with three points highlighted."><img src="model-slr_files/figure-html/fig-scattHeadLTotalLLine-highlighted-1.png" class="img-fluid figure-img" style="width:90.0%" alt="A scatterplot with total length on the x-axis and head length on the  y-axis. A least squares line is superimposed onto the scatterplot. Three individual observations are circled to indicate their vertical  distance from the least square line."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scattHeadLTotalLLine-highlighted-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.8: A reasonable linear model was fit to represent the relationship between head length and total length, with three points highlighted.
</figcaption></figure>
</div>
</div>
</div>
<div class="important">
<p><strong>Residual: Difference between observed and expected.</strong></p>
<p>The residual of the <span class="math inline">\(i^{th}\)</span> observation <span class="math inline">\((x_i, y_i)\)</span> is the difference of the observed outcome <span class="math inline">\((y_i)\)</span> and the outcome we would predict based on the model fit <span class="math inline">\((\hat{y}_i):\)</span></p>
<p><span class="math display">\[
e_i = y_i - \hat{y}_i
\]</span></p>
<p>We typically identify <span class="math inline">\(\hat{y}_i\)</span> by plugging <span class="math inline">\(x_i\)</span> into the model.</p>
</div>
<div class="workedexample">
<p>The linear fit shown in <a href="#fig-scattHeadLTotalLLine-highlighted" class="quarto-xref">Figure&nbsp;<span>7.8</span></a> is given as <span class="math inline">\(\hat{y} = 41 + 0.59x.\)</span> Based on this line, compute the residual of the observation <span class="math inline">\((76.0, 85.1).\)</span> This observation is marked by a red circle in <a href="#fig-scattHeadLTotalLLine-highlighted" class="quarto-xref">Figure&nbsp;<span>7.8</span></a>. Check it against the earlier visual estimate, -1.</p>
<hr>
<p>We first compute the predicted value of the observation marked by a red circle based on the model: <span class="math inline">\(\hat{y} = 41+0.59x = 41+0.59\times 76.0 = 85.84\)</span>. Next we compute the difference of the actual head length and the predicted head length: <span class="math inline">\(e = y - \hat{y} = 85.1 -  85.84 = -0.74\)</span>. The model’s error is <span class="math inline">\(e = -0.74\)</span> mm, which is very close to the visual estimate of -1 mm. The negative residual indicates that the linear model overpredicted head length for this possum.</p>
</div>
<div class="guidedpractice">
<p>If a model underestimates an observation, will the residual be positive or negative? What about if it overestimates the observation?<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</div>
<div class="guidedpractice">
<p>Compute the residuals for the observation marked by a blue diamond, <span class="math inline">\((85.0, 98.6),\)</span> and the observation marked by a pink triangle, <span class="math inline">\((95.5, 94.0),\)</span> in the figure using the linear relationship <span class="math inline">\(\hat{y} = 41 + 0.59x.\)</span><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
</div>
<p>Residuals are helpful in evaluating how well a linear model fits a dataset. We often display them in a scatterplot such as the one shown in <a href="#fig-scattHeadLTotalLResidualPlot" class="quarto-xref">Figure&nbsp;<span>7.9</span></a> for the regression line in <a href="#fig-scattHeadLTotalLLine-highlighted" class="quarto-xref">Figure&nbsp;<span>7.8</span></a>. The residuals are plotted with their predicted outcome variable value as the horizontal coordinate, and the vertical coordinate as the residual. For instance, the point <span class="math inline">\((85.0, 98.6)\)</span> (marked by the blue diamond) had a predicted value of 91.4 mm and had a residual of 7.45 mm, so in the residual plot it is placed at <span class="math inline">\((91.4, 7.45).\)</span> Creating a residual plot is sort of like tipping the scatterplot over so the regression line is horizontal, as indicated by the dashed line.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-scattHeadLTotalLResidualPlot" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A residual plot based on @fig-scattHeadLTotalLLine-highlighted  displaying predicted values on the x-axis and residual values on the y-axis.  The same three points that were circled in  @fig-scattHeadLTotalLLine-highlighted are still circled, demonstrating the  vertical distance from the least squares line is the residual.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-scattHeadLTotalLResidualPlot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-scattHeadLTotalLResidualPlot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;7.9: Residual plot for the model predicting head length from total length for brushtail possums."><img src="model-slr_files/figure-html/fig-scattHeadLTotalLResidualPlot-1.png" class="img-fluid figure-img" style="width:90.0%" alt="A residual plot based on @fig-scattHeadLTotalLLine-highlighted  displaying predicted values on the x-axis and residual values on the y-axis.  The same three points that were circled in  @fig-scattHeadLTotalLLine-highlighted are still circled, demonstrating the  vertical distance from the least squares line is the residual."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scattHeadLTotalLResidualPlot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.9: Residual plot for the model predicting head length from total length for brushtail possums.
</figcaption></figure>
</div>
</div>
</div>
<div class="workedexample">
<p>One purpose of residual plots is to identify characteristics or patterns still apparent in data after fitting a model. The figure below shows three scatterplots with linear models in the first row and residual plots in the second row. Can you identify any patterns in the residuals?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="model-slr_files/figure-html/sampleLinesAndResPlots-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="model-slr_files/figure-html/sampleLinesAndResPlots-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%" alt="A grid of 2 by 3 scatterplots with fabricated data. The top row of  plots contains original x-y data plots with a least squares regression line.  The bottom row of plots is a series of residual plot with predicted value on  the x-axis and residual on the y-axis. The first column of plots gives an  example of points that are well described by a linear model. The second  column of plots gives an example where the correct model seems to be quadratic  insead of linear. The third column of points gives an example where there is  no visual relationship between x and y. "></a></p>
</figure>
</div>
</div>
</div>
<hr>
<p>Dataset 1: the residuals show no obvious patterns. The residuals are scattered randomly around 0, represented by the dashed line.</p>
<p>Dataset 2: The second dataset shows a pattern in the residuals. There is some curvature in the scatterplot, which is more obvious in the residual plot. We should not use a straight line to model these data. Instead, a more advanced technique should be used to model the curved relationship, such as the variable transformations discussed in <a href="explore-numerical.html#sec-transforming-data" class="quarto-xref"><span>Section 5.7</span></a>.</p>
<p>Dataset 3: The last plot shows very little upwards trend, and the residuals also show no obvious patterns. It is reasonable to try to fit a linear model to the data. However, it is unclear whether there is evidence that the slope parameter is different from zero. The point estimate of the slope parameter is not zero, but we might wonder if this could just be due to chance. We will address this scenario in <a href="inf-model-slr.html" class="quarto-xref"><span>Chapter 24</span></a>.</p>
</div>
</section><section id="describing-linear-relationships-with-correlation" class="level3" data-number="7.1.4"><h3 data-number="7.1.4" class="anchored" data-anchor-id="describing-linear-relationships-with-correlation">
<span class="header-section-number">7.1.4</span> Describing linear relationships with correlation</h3>
<p>We’ve seen plots with strong linear relationships and others with very weak linear relationships. It would be useful if we could quantify the strength of these linear relationships with a statistic.</p>
<div class="important">
<p><strong>Correlation: strength of a linear relationship.</strong></p>
<p><strong>Correlation</strong> which always takes values between -1 and 1, describes the strength and direction of the linear relationship between two variables. We denote the correlation by <span class="math inline">\(r.\)</span></p>
<p>The correlation value has no units and will not be affected by a linear change in the units (e.g., going from inches to centimeters).</p>
</div>
<p>We can compute the correlation using a formula, just as we did with the sample mean and standard deviation. The formula for correlation, however, is rather complex<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, and like with other statistics, we generally perform the calculations on a computer or calculator.</p>
<p><span class="math display">\[
r = \frac{1}{n-1} \sum_{i=1}^{n} \frac{x_i-\bar{x}}{s_x}\frac{y_i-\bar{y}}{s_y}
\]</span></p>
<p>where <span class="math inline">\(\bar{x},\)</span> <span class="math inline">\(\bar{y},\)</span> <span class="math inline">\(s_x,\)</span> and <span class="math inline">\(s_y\)</span> are the sample means and standard deviations for each variable.</p>
<p><a href="#fig-posNegCorPlots" class="quarto-xref">Figure&nbsp;<span>7.10</span></a> shows eight plots and their corresponding correlations. Only when the relationship is perfectly linear is the correlation either -1 or +1. If the relationship is strong and positive, the correlation will be near +1. If it is strong and negative, it will be near -1. If there is no apparent linear relationship between the variables, then the correlation will be near zero.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-posNegCorPlots" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Eight scatterplots on fabricated data. The first seven plots show  linear trends with correlations ranging from -1 to +1. The eighth plot shows  a quadratic relationship whih produces a correlation of -0.28. ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-posNegCorPlots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-posNegCorPlots-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;7.10: Sample scatterplots and their correlations. The first row shows variables with a positive relationship, represented by the trend up and to the right. The second row shows variables with a negative trend, where a large value in one variable is associated with a lower value in the other."><img src="model-slr_files/figure-html/fig-posNegCorPlots-1.png" class="img-fluid figure-img" style="width:100.0%" alt="Eight scatterplots on fabricated data. The first seven plots show  linear trends with correlations ranging from -1 to +1. The eighth plot shows  a quadratic relationship whih produces a correlation of -0.28. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-posNegCorPlots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.10: Sample scatterplots and their correlations. The first row shows variables with a positive relationship, represented by the trend up and to the right. The second row shows variables with a negative trend, where a large value in one variable is associated with a lower value in the other.
</figcaption></figure>
</div>
</div>
</div>
<p>The correlation is intended to quantify the strength of a linear trend. Nonlinear trends, even when strong, sometimes produce correlations that do not reflect the strength of the relationship; see three such examples in <a href="#fig-corForNonLinearPlots" class="quarto-xref">Figure&nbsp;<span>7.11</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-corForNonLinearPlots" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Three scatterplots on fabricated data which demonstrate strong patterns between the x and y variables. The first plot shows a  quadratic trend with a correlation of -0.23. The second plot shows a cyclic trend (like a sin wave) with a correlation of 0.31. The third plot shows a distinct relationship that is not obviously functional and has a  correlation of 0.5. ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-corForNonLinearPlots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-corForNonLinearPlots-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;7.11: Sample scatterplots and their correlations. In each case, there is a strong relationship between the variables. However, because the relationship is not linear, the correlation is relatively weak."><img src="model-slr_files/figure-html/fig-corForNonLinearPlots-1.png" class="img-fluid figure-img" style="width:100.0%" alt="Three scatterplots on fabricated data which demonstrate strong patterns between the x and y variables. The first plot shows a  quadratic trend with a correlation of -0.23. The second plot shows a cyclic trend (like a sin wave) with a correlation of 0.31. The third plot shows a distinct relationship that is not obviously functional and has a  correlation of 0.5. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-corForNonLinearPlots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.11: Sample scatterplots and their correlations. In each case, there is a strong relationship between the variables. However, because the relationship is not linear, the correlation is relatively weak.
</figcaption></figure>
</div>
</div>
</div>
<div class="guidedpractice">
<p>No straight line is a good fit for any of the datasets represented in <a href="#fig-corForNonLinearPlots" class="quarto-xref">Figure&nbsp;<span>7.11</span></a>. Try drawing nonlinear curves on each plot. Once you create a curve for each, describe what is important in your fit.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
</div>
<div class="workedexample">
<p>The plot below displays the relationships between various crop yields in countries. In the plots, each point represents a different country. The x and y variables represent the proportion of total yield in the last 50 years which is due to that crop type. If a country did not produce a particular crop, it has been removed from the plot (so different plots may have different numbers of dots, each corresponding to one country).</p>
<p>Order the six scatterplots from strongest negative to strongest positive linear relationship.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="model-slr_files/figure-html/crop-yields-af-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="model-slr_files/figure-html/crop-yields-af-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%" alt="From a real dataset, we display scatterplots of the relationship  between percent of crop which is each of the following -- bananas, potatoes,  cassava, soybeans, maize, cocoa, barley, peas, and wheat for each country. For  example, potatoes and bananas are negatively correlated and bananas and cocoa  do not seem correlated at all. "></a></p>
</figure>
</div>
</div>
</div>
<hr>
<p>The order of most negative correlation to most positive correlation is:</p>
<p><span class="math display">\[
A \rightarrow D \rightarrow B \rightarrow C \rightarrow E \rightarrow F
\]</span></p>
<ul>
<li>Plot A - bananas vs.&nbsp;potatoes: -0.45</li>
<li>Plot B - cassava vs.&nbsp;soybeans: 0.19</li>
<li>Plot C - cassava vs.&nbsp;maize: 0.41</li>
<li>Plot D - cocoa vs.&nbsp;bananas: 0.01</li>
<li>Plot E - peas vs.&nbsp;barley: 0.71</li>
<li>Plot F - wheat vs.&nbsp;barley: 0.86</li>
</ul>
</div>
<p>One important aspect of the correlation is that it’s <em>unitless</em>. That is, unlike a measurement of the slope of a line (see the next section) which provides an increase in the y-coordinate for a one unit increase in the x-coordinate (in units of the x and y variable), there are no units associated with the correlation of x and y. <a href="#fig-bdims-units" class="quarto-xref">Figure&nbsp;<span>7.12</span></a> shows the relationship between weights and heights of 507 physically active individuals. In <a href="#fig-bdims-units-1" class="quarto-xref">Figure&nbsp;<span>7.12 (a)</span></a>, weight is measured in kilograms (kg) and height in centimeters (cm). In <a href="#fig-bdims-units-2" class="quarto-xref">Figure&nbsp;<span>7.12 (b)</span></a>, weight has been converted to pounds (lbs) and height to inches (in). The correlation coefficient (<span class="math inline">\(r = 0.72\)</span>) is also noted on both plots. We can see that the shape of the relationship has not changed, and neither has the correlation coefficient. The only visual change to the plot is the axis <em>labeling</em> of the points.</p>
<div class="cell">
<div id="fig-bdims-units" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-bdims-units-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-bdims-units-1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Two scatterplots, both displaying the relationship between weights and  heights of 507 physically healthy adults. In the first plot height is measured in cm and weight is measured in kg. In the second plot height  is measured in inches and weight is measured in pounds. The images  look identical, except for the axes tick marks. ">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-bdims-units-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-bdims-units-1.png" class="lightbox" data-gallery="fig-bdims-units" title="Figure&nbsp;7.12&nbsp;(a): The units are kilograms and centimeters."><img src="model-slr_files/figure-html/fig-bdims-units-1.png" class="img-fluid figure-img" style="width:90.0%" data-ref-parent="fig-bdims-units" alt="Two scatterplots, both displaying the relationship between weights and  heights of 507 physically healthy adults. In the first plot height is measured in cm and weight is measured in kg. In the second plot height  is measured in inches and weight is measured in pounds. The images  look identical, except for the axes tick marks. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-bdims-units-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) The units are kilograms and centimeters.
</figcaption></figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-bdims-units-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Two scatterplots, both displaying the relationship between weights and  heights of 507 physically healthy adults. In the first plot height is measured in cm and weight is measured in kg. In the second plot height  is measured in inches and weight is measured in pounds. The images  look identical, except for the axes tick marks. ">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-bdims-units-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-bdims-units-2.png" class="lightbox" data-gallery="fig-bdims-units" title="Figure&nbsp;7.12&nbsp;(b): The units are pounds and inches."><img src="model-slr_files/figure-html/fig-bdims-units-2.png" class="img-fluid figure-img" style="width:90.0%" data-ref-parent="fig-bdims-units" alt="Two scatterplots, both displaying the relationship between weights and  heights of 507 physically healthy adults. In the first plot height is measured in cm and weight is measured in kg. In the second plot height  is measured in inches and weight is measured in pounds. The images  look identical, except for the axes tick marks. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-bdims-units-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) The units are pounds and inches.
</figcaption></figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bdims-units-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.12: Two scatterplots, both displaying the relationship between weights and heights of 507 physically healthy adults and the correlation coefficient, <span class="math inline">\(r = 0.72\)</span>.
</figcaption></figure>
</div>
</div>
</section></section><section id="sec-least-squares-regression" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="sec-least-squares-regression">
<span class="header-section-number">7.2</span> Least squares regression</h2>
<p>Fitting linear models by eye is open to criticism since it is based on an individual’s preference. In this section, we use <em>least squares regression</em> as a more rigorous approach to fitting a line to a scatterplot.</p>
<section id="gift-aid-for-first-year-at-elmhurst-college" class="level3" data-number="7.2.1"><h3 data-number="7.2.1" class="anchored" data-anchor-id="gift-aid-for-first-year-at-elmhurst-college">
<span class="header-section-number">7.2.1</span> Gift aid for first-year at Elmhurst College</h3>
<p>This section considers a dataset on family income and gift aid data from a random sample of fifty students in the first-year class of Elmhurst College in Illinois. Gift aid is financial aid that does not need to be paid back, as opposed to a loan. A scatterplot of these data is shown in <a href="#fig-elmhurstScatterWLine" class="quarto-xref">Figure&nbsp;<span>7.13</span></a> along with a linear fit. The line follows a negative trend in the data; students who have higher family incomes tended to have lower gift aid from the university.</p>
<div class="guidedpractice">
<p>Is the correlation positive or negative in <a href="#fig-elmhurstScatterWLine" class="quarto-xref">Figure&nbsp;<span>7.13</span></a>?<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-elmhurstScatterWLine" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Scatterplot with family income on the x-axis and gift aid on the y-axis. The relationship is moderate negative and linear. ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-elmhurstScatterWLine-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-elmhurstScatterWLine-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Figure&nbsp;7.13: Gift aid and family income for a random sample of 50 first-year students from Elmhurst College."><img src="model-slr_files/figure-html/fig-elmhurstScatterWLine-1.png" class="img-fluid figure-img" style="width:90.0%" alt="Scatterplot with family income on the x-axis and gift aid on the y-axis. The relationship is moderate negative and linear. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-elmhurstScatterWLine-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.13: Gift aid and family income for a random sample of 50 first-year students from Elmhurst College.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="an-objective-measure-for-finding-the-best-line" class="level3" data-number="7.2.2"><h3 data-number="7.2.2" class="anchored" data-anchor-id="an-objective-measure-for-finding-the-best-line">
<span class="header-section-number">7.2.2</span> An objective measure for finding the best line</h3>
<p>We begin by thinking about what we mean by the “best” line. Mathematically, we want a line that has small residuals. But beyond the mathematical reasons, hopefully it also makes sense intuitively that whatever line we fit, the residuals should be small (i.e., the points should be close to the line). The first option that may come to mind is to minimize the sum of the residual magnitudes:</p>
<p><span class="math display">\[
|e_1| + |e_2| + \dots + |e_n|
\]</span></p>
<p>which we could accomplish with a computer program. The resulting dashed line shown in <a href="#fig-elmhurstScatterW2Lines" class="quarto-xref">Figure&nbsp;<span>7.14</span></a> demonstrates this fit can be quite reasonable.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-elmhurstScatterW2Lines" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Scatterplot with family income on the x-axis and gift aid on the y-axis. The relationship is moderate negative and linear. Two lines are superimposed on the scatterplot. One line is fit to the data by minimizing the sum of squared residuals, i.e., the least squares line. The other line is fit to the data by minimizing the sum of the abolute value of the residuals. ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-elmhurstScatterW2Lines-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-elmhurstScatterW2Lines-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Figure&nbsp;7.14: Gift aid and family income for a random sample of 50 first-year Elmhurst College students. The dashed line is the line that minimizes the sum of the absolute value of residuals, the solid line is the line that minimizes the sum of squared residuals, i.e., the least squares line."><img src="model-slr_files/figure-html/fig-elmhurstScatterW2Lines-1.png" class="img-fluid figure-img" style="width:90.0%" alt="Scatterplot with family income on the x-axis and gift aid on the y-axis. The relationship is moderate negative and linear. Two lines are superimposed on the scatterplot. One line is fit to the data by minimizing the sum of squared residuals, i.e., the least squares line. The other line is fit to the data by minimizing the sum of the abolute value of the residuals. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-elmhurstScatterW2Lines-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.14: Gift aid and family income for a random sample of 50 first-year Elmhurst College students. The dashed line is the line that minimizes the sum of the absolute value of residuals, the solid line is the line that minimizes the sum of squared residuals, i.e., the least squares line.
</figcaption></figure>
</div>
</div>
</div>
<p>However, a more common practice is to choose the line that minimizes the sum of the squared residuals:</p>
<p><span class="math display">\[
e_{1}^2 + e_{2}^2 + \dots + e_{n}^2
\]</span></p>
<p>The line that minimizes this least squares criterion is represented as the solid line in <a href="#fig-elmhurstScatterW2Lines" class="quarto-xref">Figure&nbsp;<span>7.14</span></a> and is commonly called the <strong>least squares line</strong>. The following are three possible reasons to choose the least squares option instead of trying to minimize the sum of residual magnitudes without any squaring:</p>
<ol type="1">
<li>It is the most commonly used method.</li>
<li>Computing the least squares line is widely supported in statistical software.</li>
<li>In many applications, a residual twice as large as another residual is more than twice as bad. For example, being off by 4 is usually more than twice as bad as being off by 2. Squaring the residuals accounts for this discrepancy.</li>
<li>The analyses which link the model to inference about a population are most straightforward when the line is fit through least squares.</li>
</ol>
<p>The first two reasons are largely for tradition and convenience; the third and fourth reasons explain why the least squares criterion is typically most helpful when working with real data.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
</section><section id="finding-and-interpreting-the-least-squares-line" class="level3" data-number="7.2.3"><h3 data-number="7.2.3" class="anchored" data-anchor-id="finding-and-interpreting-the-least-squares-line">
<span class="header-section-number">7.2.3</span> Finding and interpreting the least squares line</h3>
<p>For the Elmhurst data, we could write the equation of the least squares regression line as</p>
<p><span class="math display">\[
\widehat{\texttt{aid}} = \beta_0 + \beta_{1}\times \texttt{family\_income}
\]</span></p>
<p>Here the equation is set up to predict gift aid based on a student’s family income, which would be useful to students considering Elmhurst. These two values, <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1,\)</span> are the parameters of the regression line.</p>
<p>The parameters are estimated using the observed data. In practice, this estimation is done using a computer in the same way that other estimates, like a sample mean, can be estimated using a computer or calculator.</p>
<p>The dataset where these data are stored is called <code>elmhurst</code>. The first 5 rows of this dataset are given in <a href="#tbl-elmhurst-data" class="quarto-xref">Table&nbsp;<span>7.1</span></a>.</p>
<div class="cell" data-tbl-pos="H">
<div id="tbl-elmhurst-data" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-pos="H">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-elmhurst-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.1: First five rows of the <code>elmhurst</code> dataset.
</figcaption><div aria-describedby="tbl-elmhurst-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-condensed do-not-create-environment cell caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">family_income</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gift_aid</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">price_paid</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right; width: 8em;">92.92</td>
<td style="text-align: right; width: 8em;">21.7</td>
<td style="text-align: right; width: 8em;">14.28</td>
</tr>
<tr class="even">
<td style="text-align: right; width: 8em;">0.25</td>
<td style="text-align: right; width: 8em;">27.5</td>
<td style="text-align: right; width: 8em;">8.53</td>
</tr>
<tr class="odd">
<td style="text-align: right; width: 8em;">53.09</td>
<td style="text-align: right; width: 8em;">27.8</td>
<td style="text-align: right; width: 8em;">14.25</td>
</tr>
<tr class="even">
<td style="text-align: right; width: 8em;">50.20</td>
<td style="text-align: right; width: 8em;">27.2</td>
<td style="text-align: right; width: 8em;">8.78</td>
</tr>
<tr class="odd">
<td style="text-align: right; width: 8em;">137.61</td>
<td style="text-align: right; width: 8em;">18.0</td>
<td style="text-align: right; width: 8em;">24.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>We can see that family income is recorded in a variable called <code>family_income</code> and gift aid from university is recorded in a variable called <code>gift_aid</code>. For now, we won’t worry about the <code>price_paid</code> variable. We should also note that these data are from the 2011-2012 academic year, and all monetary amounts are given in $1,000s, i.e., the family income of the first student in the data shown in <a href="#tbl-elmhurst-data" class="quarto-xref">Table&nbsp;<span>7.1</span></a> is $92,920 and they received a gift aid of $21,700. (The data source states that all numbers have been rounded to the nearest whole dollar.)</p>
<p>Statistical software is usually used to compute the least squares line and the typical output generated as a result of fitting regression models looks like the one shown in <a href="#tbl-rOutputForIncomeAidLSRLine" class="quarto-xref">Table&nbsp;<span>7.2</span></a>. For now we will focus on the first column of the output, which lists <span class="math inline">\({b}_0\)</span> and <span class="math inline">\({b}_1.\)</span> In <a href="inf-model-slr.html" class="quarto-xref"><span>Chapter 24</span></a> we will dive deeper into the remaining columns which give us information on how accurate and precise these values of intercept and slope that are calculated from a sample of 50 students are in estimating the population parameters of intercept and slope for <em>all</em> students.</p>
<div class="cell" data-tbl-pos="H">
<div id="tbl-rOutputForIncomeAidLSRLine" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-pos="H">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-rOutputForIncomeAidLSRLine-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.2: Summary of least squares fit for the Elmhurst data.
</figcaption><div aria-describedby="tbl-rOutputForIncomeAidLSRLine-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-condensed do-not-create-environment cell caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 15em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">24.32</td>
<td style="text-align: right; width: 5em;">1.29</td>
<td style="text-align: right; width: 5em;">18.83</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 15em; font-family: monospace;">family_income</td>
<td style="text-align: right; width: 5em;">-0.04</td>
<td style="text-align: right; width: 5em;">0.01</td>
<td style="text-align: right; width: 5em;">-3.98</td>
<td style="text-align: right; width: 5em;">2e-04</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The model output tells us that the intercept is approximately 24.319 and the slope on <code>family_income</code> is approximately -0.043.</p>
<p>But what do these values mean? Interpreting parameters in a regression model is often one of the most important steps in the analysis.</p>
<div class="workedexample">
<p>The intercept and slope estimates for the Elmhurst data are <span class="math inline">\(b_0\)</span> = 24.319 and <span class="math inline">\(b_1\)</span> = -0.043. What do these numbers really mean?</p>
<hr>
<p>Interpreting the slope parameter is helpful in almost any application. For each additional $1,000 of family income, we would expect a student to receive a net difference of 1,000 <span class="math inline">\(\times\)</span> (-0.0431) = -$43.10 in aid on average, i.e., $43.10 <em>less</em>. Note that a higher family income corresponds to less aid because the coefficient of family income is negative in the model. We must be cautious in this interpretation: while there is a real association, we cannot interpret a causal connection between the variables because these data are observational. That is, increasing a particular student’s family income may not cause the student’s aid to drop. (Although it would be reasonable to contact the college and ask if the relationship is causal, i.e., if Elmhurst College’s aid decisions are partially based on students’ family income.)</p>
<p>The estimated intercept <span class="math inline">\(b_0\)</span> = 24.319 describes the average aid if a student’s family had no income, $24,319. The meaning of the intercept is relevant to this application since the family income for some students at Elmhurst is $0. In other applications, the intercept may have little or no practical value if there are no observations where <span class="math inline">\(x\)</span> is near zero.</p>
</div>
<div class="important">
<p><strong>Interpreting parameters estimated by least squares.</strong></p>
<p>The slope describes the estimated difference in the predicted average outcome of <span class="math inline">\(y\)</span> if the predictor variable <span class="math inline">\(x\)</span> happened to be one unit larger. The intercept describes the average outcome of <span class="math inline">\(y\)</span> if <span class="math inline">\(x = 0\)</span> <em>and</em> the linear model is valid all the way to <span class="math inline">\(x = 0\)</span> (values of <span class="math inline">\(x = 0\)</span> are not observed or relevant in many applications).</p>
</div>
<p>If you would like to learn more about using R to fit linear models, see <a href="model-applications.html#sec-model-tutorials" class="quarto-xref"><span>Section 10.2</span></a> for the interactive R tutorials. An alternative way of calculating the values of intercept and slope of a least squares line is manual calculations using formulas. While manual calculations are not commonly used by practicing statisticians and data scientists, it is useful to work through the first time you’re learning about the least squares line and modeling in general. Calculating the values by hand leverages two properties of the least squares line:</p>
<ol type="1">
<li>The slope of the least squares line can be estimated by</li>
</ol>
<p><span class="math display">\[
b_1 = \frac{s_y}{s_x} r
\]</span></p>
<p>where <span class="math inline">\(r\)</span> is the correlation between the two variables, and <span class="math inline">\(s_x\)</span> and <span class="math inline">\(s_y\)</span> are the sample standard deviations of the predictor and outcome, respectively.</p>
<ol start="2" type="1">
<li>If <span class="math inline">\(\bar{x}\)</span> is the sample mean of the predictor variable and <span class="math inline">\(\bar{y}\)</span> is the sample mean of the outcome variable, then the point <span class="math inline">\((\bar{x}, \bar{y})\)</span> falls on the least squares line.</li>
</ol>
<p><a href="#tbl-summaryStatsElmhurstRegr" class="quarto-xref">Table&nbsp;<span>7.3</span></a> shows the sample means for the family income and gift aid as $101,780 and $19,940, respectively. We could plot the point <span class="math inline">\((102, 19.9)\)</span> on <a href="#fig-elmhurstScatterWLine" class="quarto-xref">Figure&nbsp;<span>7.13</span></a> to verify it falls on the least squares line (the solid line).</p>
<div class="cell" data-tbl-pos="H">
<div id="tbl-summaryStatsElmhurstRegr" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-pos="H">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-summaryStatsElmhurstRegr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.3: Summary statistics for family income and gift aid.
</figcaption><div aria-describedby="tbl-summaryStatsElmhurstRegr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-condensed do-not-create-environment cell caption-top table-sm small">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Family income, x
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Gift aid, y
</div></th>
<th data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide; border-bottom: hidden;"></th>
</tr>
<tr class="even">
<th style="text-align: center;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">sd</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">sd</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">r</th>
</tr>
</thead>
<tbody><tr class="odd">
<td style="text-align: center; width: 6em;">102</td>
<td style="text-align: center; width: 6em;">63.2</td>
<td style="text-align: center; width: 6em;">19.9</td>
<td style="text-align: center; width: 6em;">5.46</td>
<td style="text-align: center; width: 6em;">-0.499</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Next, we find the point estimates <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> of the parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1.\)</span></p>
<div class="workedexample">
<p>Using the summary statistics in <a href="#tbl-summaryStatsElmhurstRegr" class="quarto-xref">Table&nbsp;<span>7.3</span></a>, compute the slope for the regression line of gift aid against family income.</p>
<hr>
<p>Compute the slope using the summary statistics from <a href="#tbl-summaryStatsElmhurstRegr" class="quarto-xref">Table&nbsp;<span>7.3</span></a>:</p>
<p><span class="math display">\[
b_1 = \frac{s_y}{s_x} r = \frac{5.46}{63.2}(-0.499) = -0.0431
\]</span></p>
</div>
<p>You might recall the form of a line from math class, which we can use to find the model fit, including the estimate of <span class="math inline">\(b_0.\)</span> Given the slope of a line and a point on the line, <span class="math inline">\((x_0, y_0),\)</span> the equation for the line can be written as</p>
<p><span class="math display">\[
y - y_0 = slope\times (x - x_0)
\]</span></p>
<div class="important">
<p><strong>Identifying the least squares line from summary statistics.</strong></p>
<p>To identify the least squares line from summary statistics:</p>
<ul>
<li>Estimate the slope parameter, <span class="math inline">\(b_1 = (s_y / s_x) r.\)</span>
</li>
<li>Note that the point <span class="math inline">\((\bar{x}, \bar{y})\)</span> is on the least squares line, use <span class="math inline">\(x_0 = \bar{x}\)</span> and <span class="math inline">\(y_0 = \bar{y}\)</span> with the point-slope equation: <span class="math inline">\(y - \bar{y} = b_1 (x - \bar{x}).\)</span>
</li>
<li>Simplify the equation, we get <span class="math inline">\(y = \bar{y} - b_1 \bar{x} + b_1 x,\)</span> which reveals that <span class="math inline">\(b_0 = \bar{y} - b_1 \bar{x}.\)</span>
</li>
</ul>
</div>
<div class="workedexample">
<p>Using the point (102, 19.9) from the sample means and the slope estimate <span class="math inline">\(b_1 = -0.0431,\)</span> find the least-squares line for predicting aid based on family income.</p>
<hr>
<p>Apply the point-slope equation using <span class="math inline">\((102, 19.9)\)</span> and the slope <span class="math inline">\(b_1 = -0.0431\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
y - y_0  &amp;= b_1 (x - x_0) \\
y - 19.9 &amp;= -0.0431 (x - 102)
\end{aligned}
\]</span></p>
<p>Expanding the right side and then adding 19.9 to each side, the equation simplifies:</p>
<p><span class="math display">\[
\widehat{\texttt{aid}} = 24.3 - 0.0431 \times \texttt{family\_income}
\]</span></p>
<p>Here we have replaced <span class="math inline">\(y\)</span> with <span class="math inline">\(\widehat{\texttt{aid}}\)</span> and <span class="math inline">\(x\)</span> with <span class="math inline">\(\texttt{family\_income}\)</span> to put the equation in context. The final least squares equation should always include a “hat” on the variable being predicted, whether it is a generic <span class="math inline">\(``y"\)</span> or a named variable like <span class="math inline">\(``aid"\)</span>.</p>
</div>
<div class="workedexample">
<p>Suppose a high school senior is considering Elmhurst College. Can they simply use the linear equation that we have estimated to calculate her financial aid from the university?</p>
<hr>
<p>She may use it as an estimate, though some qualifiers on this approach are important. First, all data come from one first-year class, and the way aid is determined by the university may change from year to year. Second, the equation will provide an imperfect estimate. While the linear equation is good at modeling the trend in the data, no individual student’s aid will be perfectly predicted (as can be seen from the individual data points around the line).</p>
</div>
</section><section id="extrapolation-is-treacherous" class="level3" data-number="7.2.4"><h3 data-number="7.2.4" class="anchored" data-anchor-id="extrapolation-is-treacherous">
<span class="header-section-number">7.2.4</span> Extrapolation is treacherous</h3>
<p>Linear models can be used to approximate the relationship between two variables. However, like any model, they have real limitations. Linear regression is simply a modeling framework. The truth is almost always much more complex than a simple line. For example, we do not know how the data outside of our limited window will behave.</p>
<div class="workedexample">
<p>Use the model <span class="math inline">\(\widehat{\texttt{aid}} = 24.3 - 0.0431 \times \texttt{family\_income}\)</span> to estimate the aid of another first-year student whose family had income of $1 million.</p>
<hr>
<p>We want to calculate the aid for a family with $1 million income. Note that in our model this will be represented as 1,000 since the data are in $1,000s.</p>
<p><span class="math display">\[
24.3 - 0.0431 \times 1000 = -18.8
\]</span></p>
<p>The model predicts this student will have -$18,800 in aid (!). However, Elmhurst College does not offer <em>negative aid</em> where they select some students to pay extra on top of tuition to attend.</p>
</div>
<p>Applying a model estimate to values outside of the realm of the original data is called <strong>extrapolation</strong>. Generally, a linear model is only an approximation of the real relationship between two variables. If we extrapolate, we are making an unreliable bet that the approximate linear relationship will be valid in places where it has not been analyzed.</p>
</section><section id="sec-r-squared" class="level3" data-number="7.2.5"><h3 data-number="7.2.5" class="anchored" data-anchor-id="sec-r-squared">
<span class="header-section-number">7.2.5</span> Describing the strength of a fit</h3>
<p>We evaluated the strength of the linear relationship between two variables earlier using the correlation, <span class="math inline">\(r.\)</span> However, it is more common to explain the strength of a linear fit using <span class="math inline">\(R^2,\)</span> called <strong>R-squared</strong>. If provided with a linear model, we might like to describe how closely the data cluster around the linear fit.</p>
<p>The <span class="math inline">\(R^2\)</span> of a linear model describes the amount of variation in the outcome variable that is explained by the least squares line. For example, consider the Elmhurst data, shown in <a href="#fig-elmhurstScatterWLine" class="quarto-xref">Figure&nbsp;<span>7.13</span></a>). The variance of the outcome variable, aid received, is about <span class="math inline">\(s_{aid}^2 \approx 29.8\)</span> million (calculated from the data, some of which is shown in <a href="#tbl-elmhurst-data" class="quarto-xref">Table&nbsp;<span>7.1</span></a>). However, if we apply our least squares line, then this model reduces our uncertainty in predicting aid using a student’s family income. The variability in the residuals describes how much variation remains after using the model: <span class="math inline">\(s_{_{RES}}^2 \approx 22.4\)</span> million. In short, there was a reduction of</p>
<p><span class="math display">\[
\frac{s_{aid}^2 - s_{_{RES}}^2}{s_{aid}^2}
  = \frac{29800 - 22400}{29800}
  = \frac{7500}{29800}
  \approx 0.25,
\]</span></p>
<p>or about 25%, of the outcome variable’s variation by using information about family income for predicting aid using a linear model. It turns out that <span class="math inline">\(R^2\)</span> corresponds exactly to the squared value of the correlation:</p>
<p><span class="math display">\[
r = -0.499 \rightarrow R^2 = 0.25
\]</span></p>
<div class="guidedpractice">
<p>If a linear model has a very strong negative relationship with a correlation of -0.97, how much of the variation in the outcome is explained by the predictor?<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
</div>
<p><span class="math inline">\(R^2\)</span> is also called the <strong>coefficient of determination</strong>.</p>
<div class="important">
<p><strong>Coefficient of determination: proportion of variability in the outcome variable explained by the model.</strong></p>
<p>Since <span class="math inline">\(r\)</span> is always between -1 and 1, <span class="math inline">\(R^2\)</span> will always be between 0 and 1. This statistic is called the <strong>coefficient of determination</strong>, and it measures the proportion of variation in the outcome variable, <span class="math inline">\(y,\)</span> that can be explained by the linear model with predictor <span class="math inline">\(x.\)</span></p>
</div>
<p>More generally, <span class="math inline">\(R^2\)</span> can be calculated as a ratio of a measure of variability around the line divided by a measure of total variability.</p>
<div class="important">
<p><strong>Sums of squares to measure variability in</strong> <span class="math inline">\(y.\)</span></p>
<p>We can measure the variability in the <span class="math inline">\(y\)</span> values by how far they tend to fall from their mean, <span class="math inline">\(\bar{y}.\)</span> We define this value as the <strong>total sum of squares</strong>, calculated using the formula below, where <span class="math inline">\(y_i\)</span> represents each <span class="math inline">\(y\)</span> value in the sample, and <span class="math inline">\(\bar{y}\)</span> represents the mean of the <span class="math inline">\(y\)</span> values in the sample.</p>
<p><span class="math display">\[
SST = (y_1 - \bar{y})^2 + (y_2 - \bar{y})^2 + \cdots + (y_n - \bar{y})^2.
\]</span></p>
<p>Left-over variability in the <span class="math inline">\(y\)</span> values if we know <span class="math inline">\(x\)</span> can be measured by the <strong>sum of squared errors</strong>, or sum of squared residuals, calculated using the formula below, where <span class="math inline">\(\hat{y}_i\)</span> represents the predicted value of <span class="math inline">\(y_i\)</span> based on the least squares regression.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>,</p>
<p><span class="math display">\[
\begin{aligned}
SSE &amp;= (y_1 - \hat{y}_1)^2 + (y_2 - \hat{y}_2)^2 + \cdots + (y_n - \hat{y}_n)^2\\
&amp;= e_{1}^2 + e_{2}^2 + \dots + e_{n}^2
\end{aligned}
\]</span></p>
<p>The coefficient of determination can then be calculated as</p>
<p><span class="math display">\[
R^2 = \frac{SST - SSE}{SST} = 1 - \frac{SSE}{SST}
\]</span></p>
</div>
<div class="workedexample">
<p>Among 50 students in the <code>elmhurst</code> dataset, the total variability in gift aid is <span class="math inline">\(SST = 1461\)</span>.<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> The sum of squared residuals is <span class="math inline">\(SSE = 1098.\)</span> Find <span class="math inline">\(R^2.\)</span></p>
<hr>
<p>Since we know <span class="math inline">\(SSE\)</span> and <span class="math inline">\(SST,\)</span> we can calculate <span class="math inline">\(R^2\)</span> as</p>
<p><span class="math display">\[
R^2 = 1 - \frac{SSE}{SST} = 1 - \frac{1098}{1461} = 0.25,
\]</span></p>
<p>the same value we found when we squared the correlation: <span class="math inline">\(R^2 = (-0.499)^2 = 0.25.\)</span></p>
</div>
</section><section id="sec-categorical-predictor-two-levels" class="level3" data-number="7.2.6"><h3 data-number="7.2.6" class="anchored" data-anchor-id="sec-categorical-predictor-two-levels">
<span class="header-section-number">7.2.6</span> Categorical predictors with two levels</h3>
<p>Categorical variables are also useful in predicting outcomes. Here we consider a categorical predictor with two levels (recall that a <em>level</em> is the same as a <em>category</em>). We’ll consider Ebay auctions for a video game, <em>Mario Kart</em> for the Nintendo Wii, where both the total price of the auction and the condition of the game were recorded. Here we want to predict total price based on game condition, which takes values <code>used</code> and <code>new</code>.</p>
<div class="data">
<p>The <a href="http://openintrostat.github.io/openintro/reference/mariokart.html"><code>mariokart</code></a> data can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.</p>
</div>
<p>A plot of the auction data is shown in <a href="#fig-marioKartNewUsed" class="quarto-xref">Figure&nbsp;<span>7.15</span></a>. Note that the original dataset contains some Mario Kart games being sold at prices above $100 but for this analysis we have limited our focus to the 141 Mario Kart games that were sold below $100.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-marioKartNewUsed" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Scatterplot of Mario Kart data with condion (used or new) on the  x-axis and total price on the y-axis. Despite the x-axis being categorical, a  least squares line is fit to the data with the value of used set to 0 and the  value of new set to 1.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-marioKartNewUsed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-marioKartNewUsed-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Figure&nbsp;7.15: Total auction prices for the video game Mario Kart, divided into used (x = 0) and new (x = 1) condition games. The least squares regression line is also shown."><img src="model-slr_files/figure-html/fig-marioKartNewUsed-1.png" class="img-fluid figure-img" style="width:90.0%" alt="Scatterplot of Mario Kart data with condion (used or new) on the  x-axis and total price on the y-axis. Despite the x-axis being categorical, a  least squares line is fit to the data with the value of used set to 0 and the  value of new set to 1."></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-marioKartNewUsed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.15: Total auction prices for the video game Mario Kart, divided into used (<span class="math inline">\(x = 0\)</span>) and new (<span class="math inline">\(x = 1\)</span>) condition games. The least squares regression line is also shown.
</figcaption></figure>
</div>
</div>
</div>
<p>To incorporate the game condition variable into a regression equation, we must convert the categories into a numerical form. We will do so using an <strong>indicator variable</strong> called <code>condnew</code>, which takes value 1 when the game is new and 0 when the game is used. Using this indicator variable, the linear model may be written as</p>
<p><span class="math display">\[
\widehat{\texttt{price}} = b_0 + b_1 \times \texttt{condnew}
\]</span></p>
<p>The parameter estimates are given in <a href="#tbl-marioKartNewUsedRegrSummary" class="quarto-xref">Table&nbsp;<span>7.4</span></a>.</p>
<div class="cell" data-tbl-pos="H">
<div id="tbl-marioKartNewUsedRegrSummary" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-pos="H">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-marioKartNewUsedRegrSummary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.4: Least squares regression summary for the final auction price against the condition of the game.
</figcaption><div aria-describedby="tbl-marioKartNewUsedRegrSummary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-condensed do-not-create-environment cell caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 15em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">42.9</td>
<td style="text-align: right; width: 5em;">0.81</td>
<td style="text-align: right; width: 5em;">52.67</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 15em; font-family: monospace;">condnew</td>
<td style="text-align: right; width: 5em;">10.9</td>
<td style="text-align: right; width: 5em;">1.26</td>
<td style="text-align: right; width: 5em;">8.66</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Using values from <a href="#tbl-marioKartNewUsedRegrSummary" class="quarto-xref">Table&nbsp;<span>7.4</span></a>, the model equation can be summarized as</p>
<p><span class="math display">\[
\widehat{\texttt{price}} = 42.87 + 10.9 \times \texttt{condnew}
\]</span></p>
<div class="workedexample">
<p>Interpret the two parameters estimated in the model for the price of Mario Kart in eBay auctions.</p>
<hr>
<p>The intercept is the estimated price when <code>condnew</code> has a value 0, i.e., when the game is in used condition. That is, the average selling price of a used version of the game is $42.9. The slope indicates that, on average, new games sell for about $10.9 more than used games.</p>
</div>
<div class="important">
<p><strong>Interpreting model estimates for categorical predictors.</strong></p>
<p>The estimated intercept is the value of the outcome variable for the first category (i.e., the category corresponding to an indicator value of 0). The estimated slope is the average change in the outcome variable between the two categories.</p>
</div>
<p>Note that, fundamentally, the intercept and slope interpretations do not change when modeling categorical variables with two levels. However, when the predictor variable is binary, the coefficient estimates (<span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>) are directly interpretable with respect to the dataset at hand.</p>
<p>We’ll elaborate further on modeling categorical predictors in <a href="model-mlr.html" class="quarto-xref"><span>Chapter 8</span></a>, where we examine the influence of many predictor variables simultaneously using multiple regression.</p>
</section></section><section id="sec-outliers-in-regression" class="level2" data-number="7.3"><h2 data-number="7.3" class="anchored" data-anchor-id="sec-outliers-in-regression">
<span class="header-section-number">7.3</span> Outliers in linear regression</h2>
<p>In this section, we discuss when outliers are important and influential. Outliers in a regression model with one predictor and one outcome are observations that fall far from the cloud of points. These points are especially important because they can have a strong influence on the least squares line. Note that there are times when observations are outlying in the <span class="math inline">\(x\)</span> direction, the <span class="math inline">\(y\)</span> direction, or both. However, being outlying in a univariate sense (either <span class="math inline">\(x\)</span> or <span class="math inline">\(y\)</span> or both) is not outlying from the bivariate model. If the points are in-line with the bivariate model, they will not influence the least squares regression line (even if the observations are outlying in the <span class="math inline">\(x\)</span> or <span class="math inline">\(y\)</span> or both directions!).</p>
<div class="workedexample">
<p>There are three plots shown in <a href="#fig-outlier-plots-1" class="quarto-xref">Figure&nbsp;<span>7.16 (a)</span></a> along with the corresponding least squares line and residual plots. For each scatterplot and residual plot pair, identify the outliers and note how they influence the least squares line. Recall that an outlier is any point that does not appear to belong with the vast majority of the other points.</p>
<hr>
<p>A: There is one outlier far from the other points (in the <span class="math inline">\(y\)</span> direction and it is an outlier of the bivariate model), though it only appears to slightly influence the line.</p>
<p>B: There is one outlier on the right (in the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> direction although it is not an outlier of the bivariate model), though it is quite close to the least squares line, which suggests it wasn’t very influential.</p>
<p>C: There is one point far away from the cloud (in the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> direction and an outlier of the bivariate model), and this outlier appears to pull the least squares line up on the right; examine how the line around the primary cloud does not appear to fit very well.</p>
</div>
<div class="workedexample">
<p>There are three plots shown in <a href="#fig-outlier-plots-2" class="quarto-xref">Figure&nbsp;<span>7.16 (b)</span></a> along with the least squares line and residual plots. As you did in previous exercise, for each scatterplot and residual plot pair, identify the outliers and note how they influence the least squares line. Recall that an outlier is any point that does not appear to belong with the vast majority of the other points. A point can be outlying in the <span class="math inline">\(x\)</span> direction, in the <span class="math inline">\(y\)</span> direction, or in relation to the bivariate model.</p>
<hr>
<p>D: There is a primary cloud and then a small secondary cloud of four outliers (with respect to both <span class="math inline">\(x\)</span> and the bivariate model). The secondary cloud appears to be influencing the line somewhat strongly, making the least square line fit poorly almost everywhere. There might be an interesting explanation for the dual clouds, which is something that could be investigated.</p>
<p>E: There is no obvious trend in the main cloud of points and the outlier on the right (with respect to both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>) appears to largely (and problematically) control the slope of the least squares line. The point creates a bivariate model when seemingly there is none.</p>
<p>F: There is one outlier far from the cloud (with respect to both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>). However, it falls quite close to the least squares line and does not appear to be very influential (it is not outlying with respect to the bivariate model).</p>
</div>
<div class="cell">
<div id="fig-outlier-plots" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-outlier-plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-outlier-plots-1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A grid of 2 by 3 scatterplots with fabricated data, all of which  contain at least one outlying observation. The top row of plots contains original x-y data plots with a least squares regression line. The bottom row  of plots is a series of residual plot with predicted value on the x-axis and  residual on the y-axis. The first column of plots gives an example of  an outlier in the bivariate model which does not impact the least squares regression line. The second column gives an example of a point which is outlying in both the x and y directions but it is not a model outlier. The third column gives an example of a point that pulls the regression line toward it, impacting the least squares line. The fourth column of  plots gives an example of a small cloud of points that drags the  regression line toward it. The fifth column gives an example of a point  which is outlying enough in both the x and y direction that it changes  a model which has no linearity into what seems like a strong positive relationship. The sixth column gives an example of a point that is far  in both the x and y directions but is in-line with the regression model  and has very little impact on the least squares regression line. ">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-outlier-plots-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-outlier-plots-1.png" class="lightbox" data-gallery="fig-outlier-plots" title="Figure&nbsp;7.16&nbsp;(a): Plots A, B, and C"><img src="model-slr_files/figure-html/fig-outlier-plots-1.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-outlier-plots" alt="A grid of 2 by 3 scatterplots with fabricated data, all of which  contain at least one outlying observation. The top row of plots contains original x-y data plots with a least squares regression line. The bottom row  of plots is a series of residual plot with predicted value on the x-axis and  residual on the y-axis. The first column of plots gives an example of  an outlier in the bivariate model which does not impact the least squares regression line. The second column gives an example of a point which is outlying in both the x and y directions but it is not a model outlier. The third column gives an example of a point that pulls the regression line toward it, impacting the least squares line. The fourth column of  plots gives an example of a small cloud of points that drags the  regression line toward it. The fifth column gives an example of a point  which is outlying enough in both the x and y direction that it changes  a model which has no linearity into what seems like a strong positive relationship. The sixth column gives an example of a point that is far  in both the x and y directions but is in-line with the regression model  and has very little impact on the least squares regression line. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-outlier-plots-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Plots A, B, and C
</figcaption></figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-outlier-plots-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A grid of 2 by 3 scatterplots with fabricated data, all of which  contain at least one outlying observation. The top row of plots contains original x-y data plots with a least squares regression line. The bottom row  of plots is a series of residual plot with predicted value on the x-axis and  residual on the y-axis. The first column of plots gives an example of  an outlier in the bivariate model which does not impact the least squares regression line. The second column gives an example of a point which is outlying in both the x and y directions but it is not a model outlier. The third column gives an example of a point that pulls the regression line toward it, impacting the least squares line. The fourth column of  plots gives an example of a small cloud of points that drags the  regression line toward it. The fifth column gives an example of a point  which is outlying enough in both the x and y direction that it changes  a model which has no linearity into what seems like a strong positive relationship. The sixth column gives an example of a point that is far  in both the x and y directions but is in-line with the regression model  and has very little impact on the least squares regression line. ">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-outlier-plots-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="model-slr_files/figure-html/fig-outlier-plots-2.png" class="lightbox" data-gallery="fig-outlier-plots" title="Figure&nbsp;7.16&nbsp;(b): Plots D, E, and F"><img src="model-slr_files/figure-html/fig-outlier-plots-2.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-outlier-plots" alt="A grid of 2 by 3 scatterplots with fabricated data, all of which  contain at least one outlying observation. The top row of plots contains original x-y data plots with a least squares regression line. The bottom row  of plots is a series of residual plot with predicted value on the x-axis and  residual on the y-axis. The first column of plots gives an example of  an outlier in the bivariate model which does not impact the least squares regression line. The second column gives an example of a point which is outlying in both the x and y directions but it is not a model outlier. The third column gives an example of a point that pulls the regression line toward it, impacting the least squares line. The fourth column of  plots gives an example of a small cloud of points that drags the  regression line toward it. The fifth column gives an example of a point  which is outlying enough in both the x and y direction that it changes  a model which has no linearity into what seems like a strong positive relationship. The sixth column gives an example of a point that is far  in both the x and y directions but is in-line with the regression model  and has very little impact on the least squares regression line. "></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-outlier-plots-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Plots D, E, and F
</figcaption></figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-outlier-plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.16: Plots of six datasets, each with a least squares line and corresponding residual plot. Each dataset has at least one outlier.
</figcaption></figure>
</div>
</div>
<p>Examine the residual plots in <a href="#fig-outlier-plots-1" class="quarto-xref">Figure&nbsp;<span>7.16 (a)</span></a> and <a href="#fig-outlier-plots-2" class="quarto-xref">Figure&nbsp;<span>7.16 (b)</span></a>. In Plots C, D, and E, you will probably find that there are a few observations which are both away from the remaining points along the x-axis and not in the trajectory of the trend in the rest of the data. In these cases, the outliers influenced the slope of the least squares lines. In Plot E, the bulk of the data show no clear trend, but if we fit a line to these data, we impose a trend where there isn’t really one.</p>
<p>A good practice for dealing with outlying observations is to produce two analyses: one with and one without the outlying observations. Presenting both analyses to a client and discussing the role of the outlying observations should lead you to a more holistic understanding of the appropriate model for the data.</p>
<div class="important">
<p><strong>Leverage.</strong></p>
<p>Points that fall horizontally away from the center of the cloud tend to pull harder on the line, so we call them points with <strong>high leverage</strong> or <strong>leverage points</strong>.</p>
</div>
<p>Points that fall horizontally far from the line are points of high leverage; these points can strongly influence the slope of the least squares line. If one of these high leverage points does appear to actually invoke its influence on the slope of the line – as in Plots C, D, and E of <a href="#fig-outlier-plots-1" class="quarto-xref">Figure&nbsp;<span>7.16 (a)</span></a> and <a href="#fig-outlier-plots-2" class="quarto-xref">Figure&nbsp;<span>7.16 (b)</span></a> – then we call it an <strong>influential point</strong>. Usually we can say a point is influential if, had we fitted the line without it, the influential point would have been unusually far from the least squares line.</p>
<div class="important">
<p><strong>Types of outliers.</strong></p>
<p>A point (or a group of points) that stands out from the rest of the data is called an outlier. Outliers that fall horizontally away from the center of the cloud of points are called leverage points. Outliers that influence on the slope of the line are called influential points.</p>
</div>
<p>It is tempting to remove outliers. Don’t do this without a very good reason. Models that ignore exceptional (and interesting) cases often perform poorly. For instance, if a financial firm ignored the largest market swings – the “outliers” – they would soon go bankrupt by making poorly thought-out investments.</p>
</section><section id="sec-chp7-review" class="level2" data-number="7.4"><h2 data-number="7.4" class="anchored" data-anchor-id="sec-chp7-review">
<span class="header-section-number">7.4</span> Chapter review</h2>
<section id="summary" class="level3" data-number="7.4.1"><h3 data-number="7.4.1" class="anchored" data-anchor-id="summary">
<span class="header-section-number">7.4.1</span> Summary</h3>
<p>Throughout this chapter, the nuances of the linear model have been described. You have learned how to create a linear model with explanatory variables that are numerical (e.g., total possum length) and those that are categorical (e.g., whether a video game was new). The residuals in a linear model are an important metric used to understand how well a model fits; high leverage points, influential points, and other types of outliers can impact the fit of a model. Correlation is a measure of the strength and direction of the linear relationship of two variables, without specifying which variable is the explanatory and which is the outcome. Future chapters will focus on generalizing the linear model from the sample of data to claims about the population of interest.</p>
</section><section id="terms" class="level3" data-number="7.4.2"><h3 data-number="7.4.2" class="anchored" data-anchor-id="terms">
<span class="header-section-number">7.4.2</span> Terms</h3>
<p>The terms introduced in this chapter are presented in <a href="#tbl-terms-chp-07" class="quarto-xref">Table&nbsp;<span>7.5</span></a>. If you’re not sure what some of these terms mean, we recommend you go back in the text and review their definitions. You should be able to easily spot them as <strong>bolded text</strong>.</p>
<div class="cell" data-tbl-pos="H">
<div id="tbl-terms-chp-07" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-pos="H">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-terms-chp-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.5: Terms introduced in this chapter.
</figcaption><div aria-describedby="tbl-terms-chp-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-condensed do-not-create-environment cell caption-top table-sm small"><tbody>
<tr class="odd">
<td style="text-align: left; width: 12em;">coefficient of determination</td>
<td style="text-align: left; width: 12em;">least squares line</td>
<td style="text-align: left; width: 12em;">regression sum of squares</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 12em;">correlation</td>
<td style="text-align: left; width: 12em;">leverage point</td>
<td style="text-align: left; width: 12em;">residuals</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 12em;">extrapolation</td>
<td style="text-align: left; width: 12em;">outcome</td>
<td style="text-align: left; width: 12em;">sum of squared error</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 12em;">high leverage</td>
<td style="text-align: left; width: 12em;">outlier</td>
<td style="text-align: left; width: 12em;">total sum of squares</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 12em;">indicator variable</td>
<td style="text-align: left; width: 12em;">predictor</td>
<td style="text-align: left; width: 12em;"></td>
</tr>
<tr class="even">
<td style="text-align: left; width: 12em;">influential point</td>
<td style="text-align: left; width: 12em;">R-squared</td>
<td style="text-align: left; width: 12em;"></td>
</tr>
</tbody></table>
</div>
</div>
</figure>
</div>
</div>
</section></section><section id="sec-chp7-exercises" class="level2" data-number="7.5"><h2 data-number="7.5" class="anchored" data-anchor-id="sec-chp7-exercises">
<span class="header-section-number">7.5</span> Exercises</h2>
<p>Answers to odd-numbered exercises can be found in <a href="exercise-solutions.html#sec-exercise-solutions-07" class="quarto-xref">Appendix&nbsp;<span>A.7</span></a>.</p>
<div class="exercises">
<ol type="1">
<li>
<p><strong>Visualizing residuals.</strong> The scatterplots shown below each have a superimposed regression line. If we were to construct a residual plot (residuals versus <span class="math inline">\(x\)</span>) for each, describe in words what those plots would look like.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="model-slr_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
</li>
</ol>
<ol start="2" type="1">
<li>
<p><strong>Trends in residuals.</strong> Shown below are two plots of residuals remaining after fitting a linear model to two different sets of data. For each plot, describe important features and determine if a linear model would be appropriate for these data. Explain your reasoning.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-15-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="model-slr_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
</li>
</ol>
<ol start="3" type="1">
<li>
<p><strong>Identify relationships, I.</strong> For each of the six plots, identify the strength of the relationship (e.g., weak, moderate, or strong) in the data and whether fitting a linear model would be reasonable.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-16-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img src="model-slr_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
</li>
</ol>
<ol start="4" type="1">
<li>
<p><strong>Identify relationships, II.</strong> For each of the six plots, identify the strength of the relationship (e.g., weak, moderate, or strong) in the data and whether fitting a linear model would be reasonable.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-17-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="model-slr_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
</li>
</ol>
<ol start="5" type="1">
<li>
<p><strong>Midterms and final.</strong> The two scatterplots below show the relationship between the overall course average and two midterm exams (Exam 1 and Exam 2) recorded for 233 students during several years for a statistics course at a university.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-18-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="model-slr_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>Based on these graphs, which of the two exams has the strongest correlation with the course grade? Explain.</p></li>
<li><p>Can you think of a reason why the correlation between the exam you chose in part (a) and the course grade is higher?</p></li>
</ol>
</li>
</ol>
<ol start="6" type="1">
<li>
<p><strong>Meat consumption and life expectancy.</strong> In data collected for <span class="citation" data-cites="You:2022">You et al. (<a href="references.html#ref-You:2022" role="doc-biblioref">2022</a>)</span>, total meat intake is associated with life expectancy (at birth) in 175 countries. Meat intake is measured in kg per capita per year (averaged over 2011 to 2013). Additionally, the authors collected data on carbohydrate crops (e.g., cereals, root, sugar, etc.) in kg per capita per year (averaged over 2011 and 2013). The scatterplot on the left shows the life expectancy at birth plotted against the per capita meat consumption. The scatterplot on the right shows the amount of carbohydrate consumption plotted against the per capita meat consumption.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-19-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27"><img src="model-slr_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>Describe the relationship between meat consumption and life expectancy.</p></li>
<li><p>Describe the relationship between meat consumption and carbohydrate consumption.</p></li>
<li><p>Which plot shows a stronger correlation? Explain your reasoning.</p></li>
<li><p>Data on consumption were originally collected in kilograms. How would the plots above and the correlation values change if the consumption variables were converted to pounds?</p></li>
</ol>
</li>
</ol>
<ol start="7" type="1">
<li>
<p><strong>Match the correlation, I.</strong> Match each correlation to the corresponding scatterplot.<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28"><img src="model-slr_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p><span class="math inline">\(r = -0.7\)</span></p></li>
<li><p><span class="math inline">\(r = 0.45\)</span></p></li>
<li><p><span class="math inline">\(r = 0.06\)</span></p></li>
<li><p><span class="math inline">\(r = 0.92\)</span></p></li>
</ol>
</li>
</ol>
<ol start="8" type="1">
<li>
<p><strong>Match the correlation, II.</strong> Match each correlation to the corresponding scatterplot.<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-21-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img src="model-slr_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p><span class="math inline">\(r = 0.49\)</span></p></li>
<li><p><span class="math inline">\(r = -0.48\)</span></p></li>
<li><p><span class="math inline">\(r = -0.03\)</span></p></li>
<li><p><span class="math inline">\(r = -0.85\)</span></p></li>
</ol>
</li>
</ol>
<ol start="9" type="1">
<li>
<p><strong>Body measurements, correlation.</strong> Researchers studying anthropometry collected body and skeletal diameter measurements, as well as age, weight, height and sex for 507 physically active individuals. The scatterplot below shows the relationship between height and shoulder girth (circumference of shoulders measured over deltoid muscles), both measured in centimeters.<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a> <span class="citation" data-cites="Heinz:2003">(<a href="references.html#ref-Heinz:2003" role="doc-biblioref">Heinz et al. 2003</a>)</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-22-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img src="model-slr_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>Describe the relationship between shoulder girth and height.</p></li>
<li><p>How would the relationship change if shoulder girth was measured in inches while the units of height remained in centimeters?</p></li>
</ol>
</li>
</ol>
<ol start="10" type="1">
<li>
<strong>Compare correlations.</strong> Eduardo and Rosie are both collecting data on number of rainy days in a year and the total rainfall for the year. Eduardo records rainfall in inches and Rosie in centimeters. How will their correlation coefficients compare?</li>
</ol>
<ol start="11" type="1">
<li>
<p><strong>The Coast Starlight, correlation.</strong> The Coast Starlight Amtrak train runs from Seattle to Los Angeles. The scatterplot below displays the distance between each stop (in miles) and the amount of time it takes to travel from one stop to another (in minutes).<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-23-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="model-slr_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>Describe the relationship between distance and travel time.</p></li>
<li><p>How would the relationship change if travel time was instead measured in hours, and distance was instead measured in kilometers?</p></li>
<li><p>Correlation between travel time (in miles) and distance (in minutes) is <span class="math inline">\(r = 0.636\)</span>. What is the correlation between travel time (in kilometers) and distance (in hours)?</p></li>
</ol>
</li>
</ol>
<ol start="12" type="1">
<li>
<p><strong>Crawling babies, correlation.</strong> A study conducted at the University of Denver investigated whether babies take longer to learn to crawl in cold months, when they are often bundled in clothes that restrict their movement, than in warmer months. Infants born during the study year were split into twelve groups, one for each birth month. We consider the average crawling age of babies in each group against the average temperature when the babies are six months old (that’s when babies often begin trying to crawl). Temperature is measured in degrees Fahrenheit (F) and age is measured in weeks.<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a> <span class="citation" data-cites="Benson:1993">(<a href="references.html#ref-Benson:1993" role="doc-biblioref">Benson 1993</a>)</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-24-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img src="model-slr_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>Describe the relationship between temperature and crawling age.</p></li>
<li><p>How would the relationship change if temperature was measured in degrees Celsius (C) and age was measured in months?</p></li>
<li><p>The correlation between temperature in F and age in weeks was <span class="math inline">\(r=-0.70\)</span>. If we converted the temperature to C and age to months, what would the correlation be?</p></li>
</ol>
</li>
</ol>
<ol start="13" type="1">
<li>
<p><strong>Meat and carbohydrate consumption.</strong> What would be the correlation between the per capita meat consumption and per capita carbohydrate consumption if, for each country, people always consumed</p>
<ol type="1">
<li><p>3 kg more of meat than of carbohydrates each year?</p></li>
<li><p>2 kg less of meat than of carbohydrates each year?</p></li>
<li><p>half as much meat as carbohydrates each year?</p></li>
</ol>
</li>
</ol>
<ol start="14" type="1">
<li>
<p><strong>Graduate degrees and salaries.</strong> What would be the correlation between the annual salaries of people with and without a graduate degree at a company if, for a certain type of position, someone with a graduate degree always made</p>
<ol type="a">
<li><p>$5,000 more than those without a graduate degree?</p></li>
<li><p>25% more than those without a graduate degree?</p></li>
<li><p>15% less than those without a graduate degree?</p></li>
</ol>
</li>
</ol>
<ol start="15" type="1">
<li>
<strong>Units of regression.</strong> Consider a regression predicting the number of calories (cal) from width (cm) for a sample of square shaped chocolate brownies. What are the units of the correlation coefficient, the intercept, and the slope?</li>
</ol>
<ol start="16" type="1">
<li>
<strong>Which is higher?</strong> Determine if (I) or (II) is higher or if they are equal: “<em>For a regression line, the uncertainty associated with the slope estimate,</em> <span class="math inline">\(b_1\)</span><em>, is higher when (I) there is a lot of scatter around the regression line or (II) there is very little scatter around the regression line.</em>” Explain your reasoning.</li>
</ol>
<ol start="17" type="1">
<li>
<strong>Over-under, I.</strong> Suppose we fit a regression line to predict the shelf life of an apple based on its weight. For a particular apple, we predict the shelf life to be 4.6 days. The apple’s residual is -0.6 days. Did we over or under estimate the shelf-life of the apple? Explain your reasoning.</li>
</ol>
<ol start="18" type="1">
<li>
<strong>Over-under, II.</strong> Suppose we fit a regression line to predict the number of incidents of skin cancer per 1,000 people from the number of sunny days in a year. For a particular year, we predict the incidence of skin cancer to be 1.5 per 1,000 people, and the residual for this year is 0.5. Did we over or under estimate the incidence of skin cancer? Explain your reasoning.</li>
</ol>
<ol start="19" type="1">
<li>
<p><strong>Starbucks, calories, and protein.</strong> The scatterplot below shows the relationship between the number of calories and amount of protein (in grams) Starbucks food menu items contain. Since Starbucks only lists the number of calories on the display items, we might be interested in predicting the amount of protein a menu item has based on its calorie content.<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-25-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img src="model-slr_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>Describe the relationship between number of calories and amount of protein (in grams) that Starbucks food menu items contain.</p></li>
<li><p>In this scenario, what are the predictor and outcome variables?</p></li>
<li><p>Why might we want to fit a regression line to these data?</p></li>
<li><p>What does the residuals vs.&nbsp;predicted plot tell us about the variability in prediction errors based on this model for items with lower vs.&nbsp;higher predicted protein?</p></li>
</ol>
</li>
</ol>
<ol start="20" type="1">
<li>
<p><strong>Starbucks, calories, and carbs.</strong> The scatterplot below shows the relationship between the number of calories and amount of carbohydrates (in grams) Starbucks food menu items contain. Since Starbucks only lists the number of calories on the display items, we might be interested in predicting the amount of carbs a menu item has based on its calorie content.<a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-26-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34"><img src="model-slr_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>Describe the relationship between number of calories and amount of carbohydrates (in grams) that Starbucks food menu items contain.</p></li>
<li><p>In this scenario, what are the predictor and outcome variables?</p></li>
<li><p>Why might we want to fit a regression line to these data?</p></li>
<li><p>What does the residuals vs.&nbsp;predicted plot tell us about the variability in prediction errors based on this model for items with lower vs.&nbsp;higher predicted carbs?</p></li>
</ol>
</li>
</ol>
<ol start="21" type="1">
<li>
<p><strong>The Coast Starlight, regression.</strong> The Coast Starlight Amtrak train runs from Seattle to Los Angeles. The scatterplot below displays the distance between each stop (in miles) and the amount of time it takes to travel from one stop to another (in minutes). The mean travel time from one stop to the next on the Coast Starlight is 129 mins, with a standard deviation of 113 minutes. The mean distance traveled from one stop to the next is 108 miles with a standard deviation of 99 miles. The correlation between travel time and distance is 0.636.<a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-27-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35"><img src="model-slr_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>Write the equation of the regression line for predicting travel time.</p></li>
<li><p>Interpret the slope and the intercept in this context.</p></li>
<li><p>Calculate <span class="math inline">\(R^2\)</span> of the regression line for predicting travel time from distance traveled for the Coast Starlight, and interpret <span class="math inline">\(R^2\)</span> in the context of the application.</p></li>
<li><p>The distance between Santa Barbara and Los Angeles is 103 miles. Use the model to estimate the time it takes for the Starlight to travel between these two cities.</p></li>
<li><p>It takes the Coast Starlight about 168 mins to travel from Santa Barbara to Los Angeles. Calculate the residual and explain the meaning of this residual value.</p></li>
<li><p>Suppose Amtrak is considering adding a stop to the Coast Starlight 500 miles away from Los Angeles. Would it be appropriate to use this linear model to predict the travel time from Los Angeles to this point?</p></li>
</ol>
</li>
</ol>
<ol start="22" type="1">
<li>
<p><strong>Body measurements, regression.</strong> Researchers studying anthropometry collected body and skeletal diameter measurements, as well as age, weight, height and sex for 507 physically active individuals. The scatterplot below shows the relationship between height and shoulder girth (circumference of shoulders measured over deltoid muscles), both measured in centimeters. The mean shoulder girth is 107.20 cm with a standard deviation of 10.37 cm. The mean height is 171.14 cm with a standard deviation of 9.41 cm. The correlation between height and shoulder girth is 0.67.<a href="#fn19" class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a> <span class="citation" data-cites="Heinz:2003">(<a href="references.html#ref-Heinz:2003" role="doc-biblioref">Heinz et al. 2003</a>)</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-28-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36"><img src="model-slr_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>Write the equation of the regression line for predicting height.</p></li>
<li><p>Interpret the slope and the intercept in this context.</p></li>
<li><p>Calculate <span class="math inline">\(R^2\)</span> of the regression line for predicting height from shoulder girth, and interpret it in the context of the application.</p></li>
<li><p>A randomly selected student from your class has a shoulder girth of 100 cm. Predict the height of this student using the model.</p></li>
<li><p>The student from part (d) is 160 cm tall. Calculate the residual, and explain what this residual means.</p></li>
<li><p>A one year old has a shoulder girth of 56 cm. Would it be appropriate to use this linear model to predict the height of this child?</p></li>
</ol>
</li>
</ol>
<ol start="23" type="1">
<li>
<p><strong>Poverty and unemployment.</strong> The following scatterplot shows the relationship between percent of population below the poverty level (<code>poverty</code>) from unemployment rate among those ages 20-64 (<code>unemployment_rate</code>) in counties in the US, as provided by data from the 2019 American Community Survey. The regression output for the model for predicting <code>poverty</code> from <code>unemployment_rate</code> is also provided.<a href="#fn20" class="footnote-ref" id="fnref20" role="doc-noteref"><sup>20</sup></a></p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">4.60</td>
<td style="text-align: right; width: 5em;">0.349</td>
<td style="text-align: right; width: 5em;">13.2</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">unemployment_rate</td>
<td style="text-align: right; width: 5em;">2.05</td>
<td style="text-align: right; width: 5em;">0.062</td>
<td style="text-align: right; width: 5em;">33.1</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-panel" data-layout="[-0.05, 0.45, 0.5]">
<div class="quarto-layout-row">
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 5.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
<div id="questions" class="quarto-layout-cell" style="flex-basis: 45.0%;justify-content: flex-start;">
<ol type="a">
<li><p>Write out the linear model.</p></li>
<li><p>Interpret the intercept.</p></li>
<li><p>Interpret the slope.</p></li>
<li><p>The <span class="math inline">\(R^2\)</span> of this model is 46%.<br>
Interpret this value.</p></li>
<li><p>Calculate the correlation coefficient.</p></li>
</ol>
</div>
<div id="plot" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-30-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37"><img src="model-slr_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</li>
</ol>
<ol start="24" type="1">
<li>
<p><strong>Cat weights.</strong> The following regression output is for predicting the heart weight (<code>Hwt</code>, in g) of cats from their body weight (<code>Bwt</code>, in kg). The coefficients are estimated using a dataset of 144 domestic cats.<a href="#fn21" class="footnote-ref" id="fnref21" role="doc-noteref"><sup>21</sup></a></p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 10em; font-family: monospace;">(Intercept)</td>
<td style="text-align: right; width: 5em;">-0.357</td>
<td style="text-align: right; width: 5em;">0.692</td>
<td style="text-align: right; width: 5em;">-0.515</td>
<td style="text-align: right; width: 5em;">0.6072</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 10em; font-family: monospace;">Bwt</td>
<td style="text-align: right; width: 5em;">4.034</td>
<td style="text-align: right; width: 5em;">0.250</td>
<td style="text-align: right; width: 5em;">16.119</td>
<td style="text-align: right; width: 5em;">&lt;0.0001</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-panel" data-layout="[-0.05, 0.45, 0.5]">
<div class="quarto-layout-row">
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 5.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
<div id="questions" class="quarto-layout-cell" style="flex-basis: 45.0%;justify-content: flex-start;">
<ol type="a">
<li><p>Write out the linear model.</p></li>
<li><p>Interpret the intercept.</p></li>
<li><p>Interpret the slope.</p></li>
<li><p>The <span class="math inline">\(R^2\)</span> of this model is 65%.<br>
Interpret <span class="math inline">\(R^2\)</span>.</p></li>
<li><p>Calculate the correlation coefficient.</p></li>
</ol>
</div>
<div id="plot" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-32-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-38"><img src="model-slr_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</li>
<li>
<p><strong>Outliers, I.</strong> Identify the outliers in the scatterplots shown below, and determine what type of outliers they are. Explain your reasoning.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-33-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39"><img src="model-slr_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
</li>
<li>
<p><strong>Outliers, II.</strong> Identify the outliers in the scatterplots shown below and determine what type of outliers they are. Explain your reasoning.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-34-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-40"><img src="model-slr_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
</li>
<li>
<p><strong>Urban homeowners, outliers.</strong> The scatterplot below shows the percent of families who own their home vs.&nbsp;the percent of the population living in urban areas. There are 52 observations, each corresponding to a state in the US. Puerto Rico and District of Columbia are also included.<a href="#fn22" class="footnote-ref" id="fnref22" role="doc-noteref"><sup>22</sup></a></p>
<div class="quarto-layout-panel" data-layout="[-0.05, 0.45, -0.02, 0.47]">
<div class="quarto-layout-row">
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 5.1%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
<div id="questions" class="quarto-layout-cell" style="flex-basis: 45.5%;justify-content: flex-start;">
<ol type="a">
<li><p>Describe the relationship between the percent of families who own their home and the percent of the population living in urban areas.</p></li>
<li><p>The outlier at the bottom right corner is District of Columbia, where 100% of the population is considered urban. What type of an outlier is this observation?</p></li>
</ol>
</div>
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 2.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
<div id="plot" class="quarto-layout-cell" style="flex-basis: 47.5%;justify-content: flex-start;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-35-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-41"><img src="model-slr_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</li>
</ol>
<ol start="28" type="1">
<li>
<p><strong>Crawling babies, outliers.</strong> A study conducted at the University of Denver investigated whether babies take longer to learn to crawl in cold months, when they are often bundled in clothes that restrict their movement, than in warmer months. The plot below shows the relationship between average crawling age of babies born in each month and the average temperature in the month when the babies are six months old. The plot reveals a potential outlying month when the average temperature is about 53F and average crawling age is about 28.5 weeks. Does this point have high leverage? Is it an influential point?<a href="#fn23" class="footnote-ref" id="fnref23" role="doc-noteref"><sup>23</sup></a> <span class="citation" data-cites="Benson:1993">(<a href="references.html#ref-Benson:1993" role="doc-biblioref">Benson 1993</a>)</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-36-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-42"><img src="model-slr_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
</li>
</ol>
<ol start="29" type="1">
<li>
<p><strong>True / False.</strong> Determine if the following statements are true or false. If false, explain why.</p>
<ol type="a">
<li><p>A correlation coefficient of -0.90 indicates a stronger linear relationship than a correlation of 0.5.</p></li>
<li><p>Correlation is a measure of the association between any two variables.</p></li>
</ol>
</li>
</ol>
<ol start="30" type="1">
<li>
<p><strong>Cherry trees.</strong> The scatterplots below show the relationship between height, diameter, and volume of timber in 31 felled black cherry trees. The diameter of the tree is measured 4.5 feet above the ground.<a href="#fn24" class="footnote-ref" id="fnref24" role="doc-noteref"><sup>24</sup></a></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-37-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-43"><img src="model-slr_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>Describe the relationship between volume and height of these trees.</p></li>
<li><p>Describe the relationship between volume and diameter of these trees.</p></li>
<li><p>Suppose you have height and diameter measurements for another black cherry tree. Which of these variables would be preferable to use to predict the volume of timber in this tree using a simple linear regression model? Explain your reasoning.</p></li>
</ol>
</li>
</ol>
<ol start="31" type="1">
<li>
<p><strong>Match the correlation, III.</strong> Match each correlation to the corresponding scatterplot.<a href="#fn25" class="footnote-ref" id="fnref25" role="doc-noteref"><sup>25</sup></a></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-38-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-44"><img src="model-slr_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>r = 0.69</p></li>
<li><p>r = 0.09</p></li>
<li><p>r = -0.91</p></li>
<li><p>r = 0.97</p></li>
</ol>
</li>
</ol>
<ol start="32" type="1">
<li>
<p><strong>Helmets and lunches.</strong> The scatterplot shows the relationship between socioeconomic status measured as the percentage of children in a neighborhood receiving reduced-fee lunches at school (<code>lunch</code>) and the percentage of bike riders in the neighborhood wearing helmets (<code>helmet</code>). The average percentage of children receiving reduced-fee lunches is 30.833% with a standard deviation of 26.724% and the average percentage of bike riders wearing helmets is 30.883% with a standard deviation of 16.948%.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="model-slr_files/figure-html/unnamed-chunk-39-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-45"><img src="model-slr_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li><p>If the <span class="math inline">\(R^2\)</span> for the least-squares regression line for these data is 72%, what is the correlation between <code>lunch</code> and <code>helmet</code>?</p></li>
<li><p>Calculate the slope and intercept for the least-squares regression line for these data.</p></li>
<li><p>Interpret the intercept of the least-squares regression line in the context of the application.</p></li>
<li><p>Interpret the slope of the least-squares regression line in the context of the application.</p></li>
<li><p>What would the value of the residual be for a neighborhood where 40% of the children receive reduced-fee lunches and 40% of the bike riders wear helmets? Interpret the meaning of this residual in the context of the application.</p></li>
</ol>
</li>
</ol>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Benson:1993" class="csl-entry" role="listitem">
Benson, J. B. 1993. <span>“Season of Birth and Onset of Locomotion: Theoretical and Methodological Implications.”</span> <em>Infant Behavior and Development</em> 16 (1): 69–81. <a href="https://doi.org/10.1016/0163-6383(93)80029-8">https://doi.org/10.1016/0163-6383(93)80029-8</a>.
</div>
<div id="ref-Heinz:2003" class="csl-entry" role="listitem">
Heinz, G., L. J. Peterson, R. W. Johnson, and C. J. Kerk. 2003. <span>“Exploring Relationships in Body Dimensions.”</span> <em>Journal of Statistics Education</em> 11 (2). <a href="http://www.openintro.org/redirect.php?go=textbook-body_dim_2003">http://www.openintro.org/redirect.php?go=textbook-body_dim_2003</a>.
</div>
<div id="ref-You:2022" class="csl-entry" role="listitem">
You, W., R. Henneberg, A. Saniotis, Y. Ge, and M. Henneberg. 2022. <span>“Total Meat Intake Is Associated with Life Expectancy: A Cross-Sectional Data Analysis of 175 Contemporary Populations.”</span> <em>International Journal of General Medicine</em> 15: 1833–51.
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>If a model underestimates an observation, then the model estimate is below the actual. The residual, which is the actual observation value minus the model estimate, must then be positive. The opposite is true when the model overestimates the observation: the residual is negative.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Gray diamond: <span class="math inline">\(\hat{y} = 41+0.59x = 41+0.59\times 85.0 = 91.15 \rightarrow e = y - \hat{y} = 98.6-91.15=7.45.\)</span> This is close to the earlier estimate of 7. pink triangle: <span class="math inline">\(\hat{y} = 41+0.59x = 97.3 \rightarrow e = -3.3.\)</span> This is also close to the estimate of -4.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Formally, we can compute the correlation for observations <span class="math inline">\((x_1, y_1),\)</span> <span class="math inline">\((x_2, y_2),\)</span> …, <span class="math inline">\((x_n, y_n)\)</span> using the formula<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>We’ll leave it to you to draw the lines. In general, the lines you draw should be close to most points and reflect overall trends in the data.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Larger family incomes are associated with lower amounts of aid, so the correlation will be negative. Using a computer, the correlation can be computed: -0.499.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>There are applications where the sum of residual magnitudes may be more useful, and there are plenty of other criteria we might consider. However, this book only applies the least squares criterion.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>About <span class="math inline">\(R^2 = (-0.97)^2 = 0.94\)</span> or 94% of the variation in the outcome variable is explained by the linear model.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>The difference <span class="math inline">\(SST - SSE\)</span> is called the <strong>regression sum of squares</strong>, <span class="math inline">\(SSR,\)</span> and can also be calculated as <span class="math inline">\(SSR = (\hat{y}_1 - \bar{y})^2 + (\hat{y}_2 - \bar{y})^2 + \cdots + (\hat{y}_n - \bar{y})^2.\)</span> <span class="math inline">\(SSR\)</span> represents the variation in <span class="math inline">\(y\)</span> that was accounted for in our model.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p><span class="math inline">\(SST\)</span> can be calculated by finding the sample variance of the outcome variable, <span class="math inline">\(s^2\)</span> and multiplying by <span class="math inline">\(n-1.\)</span><a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>The <a href="http://openintrostat.github.io/openintro/reference/exam_grades.html"><code>exam_grades</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>The <a href="http://openintrostat.github.io/openintro/reference/corr_match.html"><code>corr_match</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>The <a href="http://openintrostat.github.io/openintro/reference/corr_match.html"><code>corr_match</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>The <a href="http://openintrostat.github.io/openintro/reference/bdims.html"><code>bdims</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>The <a href="http://openintrostat.github.io/openintro/reference/coast_starlight.html"><code>coast_starlight</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p>The <a href="http://openintrostat.github.io/openintro/reference/babies_crawl.html"><code>babies_crawl</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.<a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16"><p>The <a href="http://openintrostat.github.io/openintro/reference/starbucks.html"><code>starbucks</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.<a href="#fnref16" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn17"><p>The <a href="http://openintrostat.github.io/openintro/reference/starbucks.html"><code>starbucks</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.<a href="#fnref17" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn18"><p>The <a href="http://openintrostat.github.io/openintro/reference/coast_starlight.html"><code>coast_starlight</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.<a href="#fnref18" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn19"><p>The <a href="http://openintrostat.github.io/openintro/reference/bdims.html"><code>bdims</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.<a href="#fnref19" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn20"><p>The <a href="http://openintrostat.github.io/usdata/reference/%20county_2019.html"><code>county_2019</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/usdata"><strong>usdata</strong></a> R package.<a href="#fnref20" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn21"><p>The <a href="https://cran.r-project.org/web/packages/MASS/MASS.pdf"><code>cats</code></a> data used in this exercise can be found in the <a href="https://cran.r-project.org/web/packages/MASS/index.html"><strong>MASS</strong></a> R package.<a href="#fnref21" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn22"><p>The <a href="http://openintrostat.github.io/openintro/reference/urban_owner.html"><code>urban_owner</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/usdata"><strong>usdata</strong></a> R package.<a href="#fnref22" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn23"><p>The <a href="http://openintrostat.github.io/openintro/reference/babies_crawl.html"><code>babies_crawl</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.<a href="#fnref23" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn24"><p>The <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/trees.html"><code>trees</code></a> data used in this exercise can be found in the <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/00Index.html"><strong>datasets</strong></a> R package.<a href="#fnref24" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn25"><p>The <a href="http://openintrostat.github.io/openintro/reference/corr_match.html"><code>corr_match</code></a> data used in this exercise can be found in the <a href="http://openintrostat.github.io/openintro"><strong>openintro</strong></a> R package.<a href="#fnref25" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./regression-modeling.html" class="pagination-link" aria-label="Regression modeling">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Regression modeling</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./model-mlr.html" class="pagination-link" aria-label="Linear regression with multiple predictors">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Linear regression with multiple predictors</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>This is IMS2e!</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/openintrostat/ims/edit/main/model-slr.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/openintrostat/ims/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>